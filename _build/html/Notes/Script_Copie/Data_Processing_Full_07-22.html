
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DATA Processing &#8212; PhD</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom_style.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/.ipynb_checkpoints/custom_style-checkpoint.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/assets/Calendar/public/css/calendar.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/assets/GC/GC6-08-2022_files/stylesheet.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/assets/Sample_list/Sample_list_files/stylesheet.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/assets/Picture_display.js"></script>
    <script src="../../_static/assets/.ipynb_checkpoints/Picture_display-checkpoint.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "https://github.com/Deugz/nb-phd");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "üí¨ comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://deugz.github.io/nb-phd/_build/html/Notes/Script_Copie/Data_Processing_Full_07-22.html" />
    <link rel="shortcut icon" href="../../_static/OU_Logo.svg"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-EQV9FEH9JF"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-EQV9FEH9JF');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/OU_logo.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">PhD</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../content.html">
   Why an online Thesis?
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Thesis_JB/Chapter1/Chapter1.html">
   ‚úè
   <strong>
    Chapter 1.A
   </strong>
   Ô∏è
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Science_Notes/Science.html">
   Science
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Science_Notes/Water.html">
     Water Ice
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Science_Notes/Space.html">
     in Space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Science_Notes/Amorphous.html">
     is Amorphous
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Science_Notes/Mixed.html">
     and Mixed
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Science_Notes/Questions.html">
     Questions ?
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Methods
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Thesis_JB/Chapter2/Chapter2.html">
   ‚úè
   <strong>
    Chapter 2.A
   </strong>
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Method_Notes/Method.html">
   Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Method_Notes/PAC.html">
     PAC
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Method_Notes/Spectroscopy.html">
     IR Spectroscopy
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Data_Notes/Data_Main.html">
   Overview
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/XP-1_1/XP-1_1.html">
     XP 1-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/XP-1_2/XP-1_2.html">
     XP 1-2
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Data_Notes/Pipeline.html">
   Pipeline
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../Data_Notes/DR/DR_Overview.html">
     Reduction
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../Data_Notes/DR/Sample_thickness.html">
       Sample thickness
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Data_Notes/DR/DR1.html">
       DR1
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Data_Notes/DR/DR2.html">
       DR2
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Data_Notes/DR/DR3.html">
       DR3
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../Data_Notes/Processing/Data_Processing_Main.html">
     Processing
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../Data_Notes/Processing/Step1.html">
       Substraction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Data_Notes/Processing/Step2.html">
       Gaussian fitting
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Data_Notes/Analysis/Data_Analysis.html">
   Analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/Analysis/Control_Experiments/Control_experiments.html">
     Control experiments
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/Analysis/Ethane_Samples/Ethane_analysis.html">
     Ethane analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/Analysis/2OK_ASW.html">
     ASW 20K Deposition
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Results
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Thesis_JB/Chapter3/Chapter3.html">
   ‚úè
   <strong>
    Chapter 3
   </strong>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Thesis_JB/Chapter4/Chapter4.html">
   ‚úè
   <strong>
    Chapter 4
   </strong>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Thesis_JB/Chapter5/Chapter5.html">
   ‚úè
   <strong>
    Chapter 5
   </strong>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Discussion
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Thesis_JB/Discussion.html">
   ‚úè
   <strong>
    Discussion
   </strong>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Conclusion
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Thesis_JB/Chapter8/Chapter8.html">
   ‚úè
   <strong>
    Conclusion
   </strong>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Bibliography
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Thesis_JB/Biblio/Thesis_Bibliography/bibliography.html">
   Bibliography
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Dissemination
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Dissemination/Conference.html">
   Conferences
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="simple">
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Dissemination/Outreach.html">
   Outreach
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Dissemination/Outreach/Outreach1.html">
     OUtreach
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  My Corner
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../My_Space/Productivity_Dashboard.html">
   Productivity
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../My_Space/Organisation.html">
   Notes
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../My_Space/Daily_Log.html">
     Daily Log
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../My_Space/Monthly_Dashbord.html">
     Monthly Dashboard
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../My_Space/Archives/Archive_Main.html">
     Archives
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Thesis_JB/Biblio/Litterature_Review.html">
   Litterature review
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendix
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../My_Space/How_do_I.html">
   How do I use this Book
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../My_Space/Style_guide.html">
   Style Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../My_Space/Help.html">
   Help
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/Notes/Script_Copie/Data_Processing_Full_07-22.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/Deugz/nb-phd"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/Deugz/nb-phd/issues/new?title=Issue%20on%20page%20%2FNotes/Script_Copie/Data_Processing_Full_07-22.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/Deugz/nb-phd/edit/main/_build/html/Notes/Script_Copie/Data_Processing_Full_07-22.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/Deugz/nb-phd/main?urlpath=tree/_build/html/Notes/Script_Copie/Data_Processing_Full_07-22.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   DATA Processing
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#workflow">
     Workflow
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#libraries">
       Libraries
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#input-parameters">
   0 Input parameters
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sample-type">
     Sample  type
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sample-annex">
     Sample annex
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-background-yellow-color-green-text-dp1-sample-checking-span">
   <span style="background :yellow">
    <span class="math notranslate nohighlight">
     \(\color{green}{\text{DP1 : Sample Checking}}\)
    </span>
   </span>
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-import">
   1.1 DATA Import
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#xp-ramp">
     1.1.1 XP-Ramp
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dr1-dr2-dr3">
     1.1.2 DR1, DR2, DR3
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dr1-date">
       DR1 (Date)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dr1-date-annex">
       DR1 (Date Annex)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dr2-date">
       DR2 (Date)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dr2-date-annex">
       DR2 (Date Annex)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dr3-date">
       DR3 (Date)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dr3-date-annex">
       DR3 (Date Annex)
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-annex">
     1.3 Data_annex
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#import">
       1.2.1 Import
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-cleaning">
   1.2 DATA Cleaning
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#annealing-scan-supression-and-averaging-of-the-isotherms">
     1.2.1 Annealing scan supression and averaging of the isotherms ?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#error-analysis">
     1.2.2 Error Analysis
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-compare">
   1.2 DATA Compare
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#maxa">
     1.2.1 MaxA
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#prepare-two-dictionnaries">
       Prepare two dictionnaries
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dict-1">
         Dict 1
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dict-2">
         Dict 2
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot">
       Plot
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#peak-frequency-shift">
         Peak frequency shift
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#integration-from-normalized-data">
         Integration from normalized data
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-chopping">
   1.3 Data chopping
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#temperature-list-splitting">
     1.3.1 Temperature list splitting
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sanity-check">
       Sanity Check
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#list-of-sample-names-per-range">
     1.1.3 List of sample names per range
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#range-1">
       Range 1
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#range-2">
       Range 2
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#range-3">
       Range 3
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#range-4">
       Range 4
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting">
   1.4 Plotting
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#t-ranges">
     1.4.1 T ranges
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gridspec">
     Gridspec
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#other-plot">
     Other plot
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#different-dr-outputs">
       Different DR Outputs
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scan-averaging-and-error-analysis">
   1.6 Scan Averaging and error analysis ?
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   1.7 Data processing
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#linear-regression-of-desorption">
     1.7.1 Linear regression of desorption
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#polynomial-fitting-of-isotherm-at-130k">
     1.7.2 polynomial fitting of isotherm at 130K
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-background-yellow-color-green-text-dp2-substraction-scan-span">
   <span style="background :yellow">
    <span class="math notranslate nohighlight">
     \(\color{green}{\text{DP2 : Substraction scan}}\)
    </span>
   </span>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-sanity-check">
     2.1 Data Sanity Check
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#function-definition">
     2.2  Function definition
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     2.3 Plotting
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#all-range">
       All Range
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Range 1
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       Range 2
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       Range 3
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       Range 4
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#preliminary-analysis">
     Preliminary analysis
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#export-data-sub-as-csv">
     Export Data Sub as csv
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#concatenation">
       Concatenation
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#export-as-csv">
     Export as csv
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-background-yellow-color-green-text-dp3-gaussian-fitting-span">
   <span style="background :yellow">
    <span class="math notranslate nohighlight">
     \(\color{green}{\text{DP3 : Gaussian Fitting}}\)
    </span>
   </span>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-data">
     What Data ?
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#substraction-scan">
       Substraction scan
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#oh-stretch">
       OH Stretch
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gaussian-fit-1">
     Gaussian fit 1
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>DATA Processing</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   DATA Processing
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#workflow">
     Workflow
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#libraries">
       Libraries
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#input-parameters">
   0 Input parameters
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sample-type">
     Sample  type
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sample-annex">
     Sample annex
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-background-yellow-color-green-text-dp1-sample-checking-span">
   <span style="background :yellow">
    <span class="math notranslate nohighlight">
     \(\color{green}{\text{DP1 : Sample Checking}}\)
    </span>
   </span>
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-import">
   1.1 DATA Import
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#xp-ramp">
     1.1.1 XP-Ramp
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dr1-dr2-dr3">
     1.1.2 DR1, DR2, DR3
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dr1-date">
       DR1 (Date)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dr1-date-annex">
       DR1 (Date Annex)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dr2-date">
       DR2 (Date)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dr2-date-annex">
       DR2 (Date Annex)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dr3-date">
       DR3 (Date)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dr3-date-annex">
       DR3 (Date Annex)
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-annex">
     1.3 Data_annex
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#import">
       1.2.1 Import
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-cleaning">
   1.2 DATA Cleaning
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#annealing-scan-supression-and-averaging-of-the-isotherms">
     1.2.1 Annealing scan supression and averaging of the isotherms ?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#error-analysis">
     1.2.2 Error Analysis
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-compare">
   1.2 DATA Compare
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#maxa">
     1.2.1 MaxA
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#prepare-two-dictionnaries">
       Prepare two dictionnaries
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dict-1">
         Dict 1
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dict-2">
         Dict 2
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot">
       Plot
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#peak-frequency-shift">
         Peak frequency shift
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#integration-from-normalized-data">
         Integration from normalized data
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-chopping">
   1.3 Data chopping
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#temperature-list-splitting">
     1.3.1 Temperature list splitting
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sanity-check">
       Sanity Check
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#list-of-sample-names-per-range">
     1.1.3 List of sample names per range
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#range-1">
       Range 1
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#range-2">
       Range 2
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#range-3">
       Range 3
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#range-4">
       Range 4
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting">
   1.4 Plotting
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#t-ranges">
     1.4.1 T ranges
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gridspec">
     Gridspec
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#other-plot">
     Other plot
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#different-dr-outputs">
       Different DR Outputs
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scan-averaging-and-error-analysis">
   1.6 Scan Averaging and error analysis ?
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   1.7 Data processing
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#linear-regression-of-desorption">
     1.7.1 Linear regression of desorption
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#polynomial-fitting-of-isotherm-at-130k">
     1.7.2 polynomial fitting of isotherm at 130K
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-background-yellow-color-green-text-dp2-substraction-scan-span">
   <span style="background :yellow">
    <span class="math notranslate nohighlight">
     \(\color{green}{\text{DP2 : Substraction scan}}\)
    </span>
   </span>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-sanity-check">
     2.1 Data Sanity Check
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#function-definition">
     2.2  Function definition
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     2.3 Plotting
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#all-range">
       All Range
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Range 1
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       Range 2
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       Range 3
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       Range 4
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#preliminary-analysis">
     Preliminary analysis
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#export-data-sub-as-csv">
     Export Data Sub as csv
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#concatenation">
       Concatenation
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#export-as-csv">
     Export as csv
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-background-yellow-color-green-text-dp3-gaussian-fitting-span">
   <span style="background :yellow">
    <span class="math notranslate nohighlight">
     \(\color{green}{\text{DP3 : Gaussian Fitting}}\)
    </span>
   </span>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-data">
     What Data ?
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#substraction-scan">
       Substraction scan
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#oh-stretch">
       OH Stretch
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gaussian-fit-1">
     Gaussian fit 1
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="data-processing">
<h1>DATA Processing<a class="headerlink" href="#data-processing" title="Permalink to this headline">¬∂</a></h1>
<p>The purpose of this Notebook is to perform the data processing steps for each sample:</p>
<ul class="simple">
<li><p>DP1 : Substraction</p></li>
<li><p>DP2 : Gaussian fitting</p></li>
</ul>
<p>One aim is to make this Notebook working within an html page and interactive using ipython widget</p>
<div class="section" id="workflow">
<h2>Workflow<a class="headerlink" href="#workflow" title="Permalink to this headline">¬∂</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
</pre></div>
</div>
</div>
</div>
<p>To create (drag and drop image when produced)</p>
<div class="section" id="libraries">
<h3>Libraries<a class="headerlink" href="#libraries" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> 
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">cycler</span> <span class="kn">import</span> <span class="n">cycler</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>
<span class="kn">import</span> <span class="nn">pylab</span>

<span class="kn">from</span> <span class="nn">lmfit.models</span> <span class="kn">import</span> <span class="n">ExponentialModel</span><span class="p">,</span> <span class="n">GaussianModel</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using matplotlib backend: Qt5Agg
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="input-parameters">
<h1>0 Input parameters<a class="headerlink" href="#input-parameters" title="Permalink to this headline">¬∂</a></h1>
<p>Not use (but here just in case)</p>
<p>Take time to describe method used with respect to previous Notebook (Improvement - Emphase on python teaching)</p>
<div class="section" id="sample-type">
<h2>Sample  type<a class="headerlink" href="#sample-type" title="Permalink to this headline">¬∂</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 0.1 Date</span>

<span class="n">date</span> <span class="o">=</span> <span class="s2">&quot;2020_09_16&quot;</span>

<span class="c1"># 0.2 XP</span>
    <span class="c1"># Can take value XP_1-1, XP_1-2 </span>

<span class="n">XP</span> <span class="o">=</span> <span class="s2">&quot;XP_1-1&quot;</span>

<span class="c1"># 0.3 Sample type</span>
    <span class="c1"># Can take value ASW, C2H6, C2H6_ASW</span>

<span class="n">spl</span> <span class="o">=</span> <span class="s2">&quot;ASW&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="sample-annex">
<h2>Sample annex<a class="headerlink" href="#sample-annex" title="Permalink to this headline">¬∂</a></h2>
<p>For quick sample comparison (max 3 sample named 2-3-4)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">date2</span> <span class="o">=</span> <span class="s2">&quot;2020_09_28&quot;</span>
<span class="n">date3</span> <span class="o">=</span> <span class="s2">&quot;2020_09_17&quot;</span>
<span class="n">date4</span> <span class="o">=</span> <span class="s2">&quot;2020_09_21&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="span-style-background-yellow-color-green-text-dp1-sample-checking-span">
<h1><span style='background :yellow' > <span class="math notranslate nohighlight">\(\color{green}{\text{DP1 : Sample Checking}}\)</span> </span><a class="headerlink" href="#span-style-background-yellow-color-green-text-dp1-sample-checking-span" title="Permalink to this headline">¬∂</a></h1>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="data-import">
<h1>1.1 DATA Import<a class="headerlink" href="#data-import" title="Permalink to this headline">¬∂</a></h1>
<p>The Data processing routine is performed per sample.</p>
<p>A date is set as input</p>
<p>from the previous data analysis, summarized in the following document below, we have identified 4 temeperature ranges where the sample undergo different physical processes.</p>
<p><span class="xref myst">XP1_Plan</span></p>
<p>So the purpose here is to chop the data with respect to those ranges before to perform the Substraction</p>
<p>Experimental ranges (in T):</p>
<ul class="simple">
<li><p>Range 1: 20 - 100K</p></li>
<li><p>Range 2: 100 to 130K</p></li>
<li><p>Range 3: 130K - 140K</p></li>
<li><p>Range 4: Beyond 140K</p></li>
</ul>
<p>I want to extract the temperature ramp info from XP Ramp:</p>
<div class="section" id="xp-ramp">
<h2>1.1.1 XP-Ramp<a class="headerlink" href="#xp-ramp" title="Permalink to this headline">¬∂</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">XP_Ramp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;D:\DATA-Processing\PAC\XP_list_test.csv&#39;</span><span class="p">)</span>
<span class="n">XP_Ramp_df_I</span> <span class="o">=</span> <span class="n">XP_Ramp_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#XP_Ramp_df_I.head(5)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="dr1-dr2-dr3">
<h2>1.1.2 DR1, DR2, DR3<a class="headerlink" href="#dr1-dr2-dr3" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="dr1-date">
<h3>DR1 (Date)<a class="headerlink" href="#dr1-date" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DR1_Allscan_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s2">/Samples/</span><span class="si">{}</span><span class="s2">/Data/DR/DR1_</span><span class="si">{}</span><span class="s2">_All-scans.csv&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">date</span><span class="p">))</span>
<span class="n">DR1_Allscan_df</span> <span class="o">=</span> <span class="n">DR1_Allscan_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#DR1_Allscan_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="dr1-date-annex">
<h3>DR1 (Date Annex)<a class="headerlink" href="#dr1-date-annex" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DR1_Allscan_df_2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s2">/Samples/</span><span class="si">{}</span><span class="s2">/Data/DR/DR1_</span><span class="si">{}</span><span class="s2">_All-scans.csv&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span><span class="n">date2</span><span class="p">,</span><span class="n">date2</span><span class="p">))</span>
<span class="n">DR1_Allscan_df_3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s2">/Samples/</span><span class="si">{}</span><span class="s2">/Data/DR/DR1_</span><span class="si">{}</span><span class="s2">_All-scans.csv&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span><span class="n">date3</span><span class="p">,</span><span class="n">date3</span><span class="p">))</span>
<span class="n">DR1_Allscan_df_4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s2">/Samples/</span><span class="si">{}</span><span class="s2">/Data/DR/DR1_</span><span class="si">{}</span><span class="s2">_All-scans.csv&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span><span class="n">date4</span><span class="p">,</span><span class="n">date4</span><span class="p">))</span>


<span class="n">DR1_Allscan_df_2</span> <span class="o">=</span> <span class="n">DR1_Allscan_df_2</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
<span class="n">DR1_Allscan_df_3</span> <span class="o">=</span> <span class="n">DR1_Allscan_df_3</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
<span class="n">DR1_Allscan_df_4</span> <span class="o">=</span> <span class="n">DR1_Allscan_df_4</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#DR1_Allscan_df_2</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="dr2-date">
<h3>DR2 (Date)<a class="headerlink" href="#dr2-date" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DR2_Allscan_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s1">/Samples/</span><span class="si">{}</span><span class="s1">/Data/DR/DR2_</span><span class="si">{}</span><span class="s1">_All-scans.csv&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">date</span><span class="p">))</span>
<span class="n">DR2_Allscan_df</span> <span class="o">=</span> <span class="n">DR2_Allscan_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#DR2_Allscan_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="dr2-date-annex">
<h3>DR2 (Date Annex)<a class="headerlink" href="#dr2-date-annex" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DR2_Allscan_df_2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s1">/Samples/</span><span class="si">{}</span><span class="s1">/Data/DR/DR2_</span><span class="si">{}</span><span class="s1">_All-scans.csv&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span> <span class="n">date2</span><span class="p">,</span> <span class="n">date2</span><span class="p">))</span>
<span class="n">DR2_Allscan_df_3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s1">/Samples/</span><span class="si">{}</span><span class="s1">/Data/DR/DR2_</span><span class="si">{}</span><span class="s1">_All-scans.csv&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span> <span class="n">date3</span><span class="p">,</span> <span class="n">date3</span><span class="p">))</span>
<span class="n">DR2_Allscan_df_4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s1">/Samples/</span><span class="si">{}</span><span class="s1">/Data/DR/DR2_</span><span class="si">{}</span><span class="s1">_All-scans.csv&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span> <span class="n">date4</span><span class="p">,</span> <span class="n">date4</span><span class="p">))</span>

<span class="n">DR2_Allscan_df_2</span> <span class="o">=</span> <span class="n">DR2_Allscan_df_2</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
<span class="n">DR2_Allscan_df_3</span> <span class="o">=</span> <span class="n">DR2_Allscan_df_3</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
<span class="n">DR2_Allscan_df_4</span> <span class="o">=</span> <span class="n">DR2_Allscan_df_4</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#DR2_Allscan_df_2</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="dr3-date">
<h3>DR3 (Date)<a class="headerlink" href="#dr3-date" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DR3_Allscan_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s2">/Samples/</span><span class="si">{}</span><span class="s2">/Data/DR/DR3_</span><span class="si">{}</span><span class="s2">_A.csv&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">date</span><span class="p">))</span>
<span class="n">DR3_Allscan_df</span> <span class="o">=</span> <span class="n">DR3_Allscan_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#DR3_Allscan_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="dr3-date-annex">
<h3>DR3 (Date Annex)<a class="headerlink" href="#dr3-date-annex" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DR3_Allscan_df_2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s2">/Samples/</span><span class="si">{}</span><span class="s2">/Data/DR/DR3_</span><span class="si">{}</span><span class="s2">_A.csv&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span><span class="n">date2</span><span class="p">,</span><span class="n">date2</span><span class="p">))</span>
<span class="n">DR3_Allscan_df_3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s2">/Samples/</span><span class="si">{}</span><span class="s2">/Data/DR/DR3_</span><span class="si">{}</span><span class="s2">_A.csv&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span><span class="n">date3</span><span class="p">,</span><span class="n">date3</span><span class="p">))</span>
<span class="n">DR3_Allscan_df_4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s2">/Samples/</span><span class="si">{}</span><span class="s2">/Data/DR/DR3_</span><span class="si">{}</span><span class="s2">_A.csv&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span><span class="n">date4</span><span class="p">,</span><span class="n">date4</span><span class="p">))</span>

<span class="n">DR3_Allscan_df_2</span> <span class="o">=</span> <span class="n">DR3_Allscan_df_2</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
<span class="n">DR3_Allscan_df_3</span> <span class="o">=</span> <span class="n">DR3_Allscan_df_3</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
<span class="n">DR3_Allscan_df_4</span> <span class="o">=</span> <span class="n">DR3_Allscan_df_4</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="data-annex">
<h2>1.3 Data_annex<a class="headerlink" href="#data-annex" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="import">
<h3>1.2.1 Import<a class="headerlink" href="#import" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Date</span>

<span class="n">data_anex_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s2">/Samples/</span><span class="si">{}</span><span class="s2">/Data/DR/</span><span class="si">{}</span><span class="s2">_data_annex.csv&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">date</span><span class="p">))</span>

<span class="c1">#Date Annex</span>

<span class="n">data_anex_df_2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s2">/Samples/</span><span class="si">{}</span><span class="s2">/Data/DR/</span><span class="si">{}</span><span class="s2">_data_annex.csv&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span><span class="n">date2</span><span class="p">,</span><span class="n">date2</span><span class="p">))</span>
<span class="n">data_anex_df_3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s2">/Samples/</span><span class="si">{}</span><span class="s2">/Data/DR/</span><span class="si">{}</span><span class="s2">_data_annex.csv&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span><span class="n">date3</span><span class="p">,</span><span class="n">date3</span><span class="p">))</span>
<span class="n">data_anex_df_4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s2">/Samples/</span><span class="si">{}</span><span class="s2">/Data/DR/</span><span class="si">{}</span><span class="s2">_data_annex.csv&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span><span class="n">date4</span><span class="p">,</span><span class="n">date4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_anex_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>min1</th>
      <th>index1</th>
      <th>min2</th>
      <th>index2</th>
      <th>min3</th>
      <th>index3</th>
      <th>min4</th>
      <th>index4</th>
      <th>min5</th>
      <th>...</th>
      <th>maxA0w</th>
      <th>maxBi</th>
      <th>maxB</th>
      <th>maxBw</th>
      <th>maxCi</th>
      <th>maxC</th>
      <th>maxCw</th>
      <th>Int_A</th>
      <th>Int_C</th>
      <th>Int_N_A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ASW_2020_09_16_1</td>
      <td>-0.018844</td>
      <td>6636</td>
      <td>-0.008464</td>
      <td>4235</td>
      <td>-0.008369</td>
      <td>4139</td>
      <td>-0.001418</td>
      <td>2403</td>
      <td>-0.000786</td>
      <td>...</td>
      <td>3268.321</td>
      <td>2945</td>
      <td>0.009284</td>
      <td>2219.700</td>
      <td>1773</td>
      <td>0.023557</td>
      <td>1654.651</td>
      <td>95.913079</td>
      <td>6.952239</td>
      <td>100.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ASW_2020_09_16_2</td>
      <td>-0.017376</td>
      <td>6636</td>
      <td>-0.006804</td>
      <td>4235</td>
      <td>-0.006714</td>
      <td>4139</td>
      <td>0.000216</td>
      <td>2432</td>
      <td>0.000863</td>
      <td>...</td>
      <td>3264.464</td>
      <td>2945</td>
      <td>0.009251</td>
      <td>2219.700</td>
      <td>1771</td>
      <td>0.023602</td>
      <td>1653.686</td>
      <td>96.271574</td>
      <td>7.064048</td>
      <td>100.373772</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ASW_2020_09_16_3</td>
      <td>-0.015208</td>
      <td>6636</td>
      <td>-0.005247</td>
      <td>4197</td>
      <td>-0.005165</td>
      <td>4130</td>
      <td>0.001310</td>
      <td>2413</td>
      <td>0.001796</td>
      <td>...</td>
      <td>3264.464</td>
      <td>2947</td>
      <td>0.010343</td>
      <td>2220.665</td>
      <td>1754</td>
      <td>0.024362</td>
      <td>1645.490</td>
      <td>98.372535</td>
      <td>7.669780</td>
      <td>102.564255</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ASW_2020_09_16_4</td>
      <td>-0.014749</td>
      <td>6631</td>
      <td>-0.004931</td>
      <td>4197</td>
      <td>-0.004867</td>
      <td>4130</td>
      <td>0.001626</td>
      <td>2413</td>
      <td>0.002152</td>
      <td>...</td>
      <td>3264.464</td>
      <td>2947</td>
      <td>0.010512</td>
      <td>2220.665</td>
      <td>1754</td>
      <td>0.024289</td>
      <td>1645.490</td>
      <td>98.949916</td>
      <td>7.710412</td>
      <td>103.166239</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ASW_2020_09_16_5</td>
      <td>-0.014274</td>
      <td>6620</td>
      <td>-0.004424</td>
      <td>4245</td>
      <td>-0.004362</td>
      <td>4130</td>
      <td>0.002212</td>
      <td>2413</td>
      <td>0.002702</td>
      <td>...</td>
      <td>3264.464</td>
      <td>2947</td>
      <td>0.010562</td>
      <td>2220.665</td>
      <td>1754</td>
      <td>0.024293</td>
      <td>1645.490</td>
      <td>99.128959</td>
      <td>7.740047</td>
      <td>103.352911</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ASW_2020_09_16_6</td>
      <td>-0.013616</td>
      <td>6636</td>
      <td>-0.003845</td>
      <td>4235</td>
      <td>-0.003754</td>
      <td>4139</td>
      <td>0.003361</td>
      <td>2444</td>
      <td>0.003725</td>
      <td>...</td>
      <td>3255.303</td>
      <td>2949</td>
      <td>0.010078</td>
      <td>2221.629</td>
      <td>1756</td>
      <td>0.023139</td>
      <td>1646.454</td>
      <td>102.427355</td>
      <td>8.047927</td>
      <td>106.791854</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ASW_2020_09_16_7</td>
      <td>-0.013178</td>
      <td>6632</td>
      <td>-0.003492</td>
      <td>4235</td>
      <td>-0.003383</td>
      <td>4139</td>
      <td>0.003972</td>
      <td>2425</td>
      <td>0.004340</td>
      <td>...</td>
      <td>3255.303</td>
      <td>2951</td>
      <td>0.010252</td>
      <td>2222.593</td>
      <td>1756</td>
      <td>0.022505</td>
      <td>1646.454</td>
      <td>103.570509</td>
      <td>8.057326</td>
      <td>107.983719</td>
    </tr>
    <tr>
      <th>7</th>
      <td>ASW_2020_09_16_8</td>
      <td>-0.012907</td>
      <td>6632</td>
      <td>-0.003190</td>
      <td>4235</td>
      <td>-0.003086</td>
      <td>4139</td>
      <td>0.004323</td>
      <td>2406</td>
      <td>0.004697</td>
      <td>...</td>
      <td>3255.303</td>
      <td>2951</td>
      <td>0.010345</td>
      <td>2222.593</td>
      <td>1756</td>
      <td>0.022478</td>
      <td>1646.454</td>
      <td>103.920588</td>
      <td>8.069566</td>
      <td>108.348714</td>
    </tr>
    <tr>
      <th>8</th>
      <td>ASW_2020_09_16_9</td>
      <td>-0.013285</td>
      <td>6636</td>
      <td>-0.002969</td>
      <td>4245</td>
      <td>-0.002883</td>
      <td>4139</td>
      <td>0.004149</td>
      <td>2415</td>
      <td>0.004730</td>
      <td>...</td>
      <td>3251.446</td>
      <td>2959</td>
      <td>0.011390</td>
      <td>2226.450</td>
      <td>1754</td>
      <td>0.022548</td>
      <td>1645.490</td>
      <td>106.316388</td>
      <td>8.023931</td>
      <td>110.846602</td>
    </tr>
    <tr>
      <th>9</th>
      <td>ASW_2020_09_16_10</td>
      <td>-0.013301</td>
      <td>6636</td>
      <td>-0.002779</td>
      <td>4216</td>
      <td>-0.002666</td>
      <td>4139</td>
      <td>0.004334</td>
      <td>2367</td>
      <td>0.004952</td>
      <td>...</td>
      <td>3251.446</td>
      <td>2959</td>
      <td>0.011787</td>
      <td>2226.450</td>
      <td>1754</td>
      <td>0.022958</td>
      <td>1645.490</td>
      <td>107.623907</td>
      <td>8.026164</td>
      <td>112.209835</td>
    </tr>
    <tr>
      <th>10</th>
      <td>ASW_2020_09_16_11</td>
      <td>-0.013018</td>
      <td>6636</td>
      <td>-0.002502</td>
      <td>4197</td>
      <td>-0.002379</td>
      <td>4120</td>
      <td>0.004644</td>
      <td>2367</td>
      <td>0.005298</td>
      <td>...</td>
      <td>3250.482</td>
      <td>2959</td>
      <td>0.011822</td>
      <td>2226.450</td>
      <td>1754</td>
      <td>0.022904</td>
      <td>1645.490</td>
      <td>107.980853</td>
      <td>8.037065</td>
      <td>112.581991</td>
    </tr>
    <tr>
      <th>11</th>
      <td>ASW_2020_09_16_12</td>
      <td>-0.012113</td>
      <td>6636</td>
      <td>-0.002024</td>
      <td>4149</td>
      <td>-0.001986</td>
      <td>4130</td>
      <td>0.005265</td>
      <td>2415</td>
      <td>0.005871</td>
      <td>...</td>
      <td>3251.446</td>
      <td>2959</td>
      <td>0.011693</td>
      <td>2226.450</td>
      <td>1754</td>
      <td>0.020700</td>
      <td>1645.490</td>
      <td>108.386906</td>
      <td>8.033410</td>
      <td>113.005345</td>
    </tr>
    <tr>
      <th>12</th>
      <td>ASW_2020_09_16_13</td>
      <td>-0.011900</td>
      <td>6636</td>
      <td>-0.001360</td>
      <td>4151</td>
      <td>-0.001341</td>
      <td>4132</td>
      <td>0.005725</td>
      <td>2367</td>
      <td>0.006299</td>
      <td>...</td>
      <td>3250.482</td>
      <td>2980</td>
      <td>0.012006</td>
      <td>2236.575</td>
      <td>1771</td>
      <td>0.021517</td>
      <td>1653.686</td>
      <td>109.276611</td>
      <td>8.503723</td>
      <td>113.932962</td>
    </tr>
    <tr>
      <th>13</th>
      <td>ASW_2020_09_16_14</td>
      <td>-0.011673</td>
      <td>6636</td>
      <td>-0.001157</td>
      <td>4151</td>
      <td>-0.001115</td>
      <td>4130</td>
      <td>0.005912</td>
      <td>2415</td>
      <td>0.006504</td>
      <td>...</td>
      <td>3250.482</td>
      <td>2959</td>
      <td>0.011885</td>
      <td>2226.450</td>
      <td>1771</td>
      <td>0.021516</td>
      <td>1653.686</td>
      <td>109.502264</td>
      <td>8.477687</td>
      <td>114.168230</td>
    </tr>
    <tr>
      <th>14</th>
      <td>ASW_2020_09_16_15</td>
      <td>-0.011645</td>
      <td>6636</td>
      <td>-0.001251</td>
      <td>4149</td>
      <td>-0.001226</td>
      <td>4139</td>
      <td>0.006022</td>
      <td>2415</td>
      <td>0.006723</td>
      <td>...</td>
      <td>3250.482</td>
      <td>2966</td>
      <td>0.011713</td>
      <td>2229.825</td>
      <td>1699</td>
      <td>0.020339</td>
      <td>1618.973</td>
      <td>109.378492</td>
      <td>8.007280</td>
      <td>114.039184</td>
    </tr>
    <tr>
      <th>15</th>
      <td>ASW_2020_09_16_16</td>
      <td>-0.011338</td>
      <td>6636</td>
      <td>-0.000905</td>
      <td>4168</td>
      <td>-0.000901</td>
      <td>4139</td>
      <td>0.006207</td>
      <td>2415</td>
      <td>0.006852</td>
      <td>...</td>
      <td>3247.107</td>
      <td>2964</td>
      <td>0.012078</td>
      <td>2228.861</td>
      <td>1769</td>
      <td>0.020189</td>
      <td>1652.722</td>
      <td>109.838625</td>
      <td>8.093852</td>
      <td>114.518923</td>
    </tr>
    <tr>
      <th>16</th>
      <td>ASW_2020_09_16_17</td>
      <td>-0.011244</td>
      <td>6636</td>
      <td>-0.000821</td>
      <td>4149</td>
      <td>-0.000807</td>
      <td>4139</td>
      <td>0.006330</td>
      <td>2415</td>
      <td>0.006958</td>
      <td>...</td>
      <td>3247.107</td>
      <td>2964</td>
      <td>0.012166</td>
      <td>2228.861</td>
      <td>1769</td>
      <td>0.020213</td>
      <td>1652.722</td>
      <td>110.041893</td>
      <td>8.142568</td>
      <td>114.730852</td>
    </tr>
    <tr>
      <th>17</th>
      <td>ASW_2020_09_16_18</td>
      <td>-0.011332</td>
      <td>6636</td>
      <td>-0.000989</td>
      <td>4149</td>
      <td>-0.001025</td>
      <td>4130</td>
      <td>0.006762</td>
      <td>2480</td>
      <td>0.007738</td>
      <td>...</td>
      <td>3246.625</td>
      <td>2957</td>
      <td>0.011663</td>
      <td>2225.486</td>
      <td>1754</td>
      <td>0.021377</td>
      <td>1645.490</td>
      <td>109.763420</td>
      <td>7.476483</td>
      <td>114.440514</td>
    </tr>
    <tr>
      <th>18</th>
      <td>ASW_2020_09_16_19</td>
      <td>-0.010872</td>
      <td>6636</td>
      <td>-0.000882</td>
      <td>4158</td>
      <td>-0.000914</td>
      <td>4130</td>
      <td>0.006530</td>
      <td>2480</td>
      <td>0.008113</td>
      <td>...</td>
      <td>3246.625</td>
      <td>2978</td>
      <td>0.011855</td>
      <td>2235.610</td>
      <td>1697</td>
      <td>0.021481</td>
      <td>1618.009</td>
      <td>109.666245</td>
      <td>7.569996</td>
      <td>114.339198</td>
    </tr>
    <tr>
      <th>19</th>
      <td>ASW_2020_09_16_20</td>
      <td>-0.010809</td>
      <td>6636</td>
      <td>-0.000910</td>
      <td>4149</td>
      <td>-0.000942</td>
      <td>4130</td>
      <td>0.006549</td>
      <td>2480</td>
      <td>0.008185</td>
      <td>...</td>
      <td>3246.143</td>
      <td>2978</td>
      <td>0.011966</td>
      <td>2235.610</td>
      <td>1697</td>
      <td>0.021457</td>
      <td>1618.009</td>
      <td>109.738473</td>
      <td>7.560006</td>
      <td>114.414504</td>
    </tr>
    <tr>
      <th>20</th>
      <td>ASW_2020_09_16_21</td>
      <td>-0.011159</td>
      <td>6636</td>
      <td>-0.001222</td>
      <td>4151</td>
      <td>-0.001287</td>
      <td>4103</td>
      <td>0.006266</td>
      <td>2415</td>
      <td>0.007035</td>
      <td>...</td>
      <td>3242.286</td>
      <td>2966</td>
      <td>0.012110</td>
      <td>2229.825</td>
      <td>1699</td>
      <td>0.020884</td>
      <td>1618.973</td>
      <td>109.665610</td>
      <td>8.124397</td>
      <td>114.338537</td>
    </tr>
    <tr>
      <th>21</th>
      <td>ASW_2020_09_16_22</td>
      <td>-0.010915</td>
      <td>6630</td>
      <td>-0.001349</td>
      <td>4151</td>
      <td>-0.001461</td>
      <td>4111</td>
      <td>0.006305</td>
      <td>2444</td>
      <td>0.007058</td>
      <td>...</td>
      <td>3232.161</td>
      <td>2976</td>
      <td>0.012184</td>
      <td>2234.646</td>
      <td>1535</td>
      <td>0.020529</td>
      <td>1539.905</td>
      <td>109.891203</td>
      <td>8.369954</td>
      <td>114.573742</td>
    </tr>
    <tr>
      <th>22</th>
      <td>ASW_2020_09_16_23</td>
      <td>-0.010836</td>
      <td>6630</td>
      <td>-0.001540</td>
      <td>4151</td>
      <td>-0.001650</td>
      <td>4084</td>
      <td>0.006335</td>
      <td>2396</td>
      <td>0.007176</td>
      <td>...</td>
      <td>3228.304</td>
      <td>2976</td>
      <td>0.012485</td>
      <td>2234.646</td>
      <td>1535</td>
      <td>0.020793</td>
      <td>1539.905</td>
      <td>110.395286</td>
      <td>8.440394</td>
      <td>115.099305</td>
    </tr>
    <tr>
      <th>23</th>
      <td>ASW_2020_09_16_24</td>
      <td>-0.014164</td>
      <td>6636</td>
      <td>-0.006225</td>
      <td>4149</td>
      <td>-0.006255</td>
      <td>4101</td>
      <td>0.003633</td>
      <td>2444</td>
      <td>0.004862</td>
      <td>...</td>
      <td>3228.304</td>
      <td>2976</td>
      <td>0.011491</td>
      <td>2234.646</td>
      <td>1697</td>
      <td>0.019248</td>
      <td>1618.009</td>
      <td>108.090993</td>
      <td>7.265889</td>
      <td>112.696823</td>
    </tr>
    <tr>
      <th>24</th>
      <td>ASW_2020_09_16_25</td>
      <td>-0.013780</td>
      <td>6636</td>
      <td>-0.008598</td>
      <td>4151</td>
      <td>-0.008599</td>
      <td>4122</td>
      <td>0.001659</td>
      <td>2484</td>
      <td>0.002442</td>
      <td>...</td>
      <td>3228.304</td>
      <td>2978</td>
      <td>0.008953</td>
      <td>2235.610</td>
      <td>1535</td>
      <td>0.016275</td>
      <td>1539.905</td>
      <td>83.840839</td>
      <td>5.785232</td>
      <td>87.413354</td>
    </tr>
    <tr>
      <th>25</th>
      <td>ASW_2020_09_16_26</td>
      <td>0.002459</td>
      <td>6636</td>
      <td>0.004937</td>
      <td>4151</td>
      <td>0.004895</td>
      <td>4053</td>
      <td>0.006344</td>
      <td>2329</td>
      <td>0.006488</td>
      <td>...</td>
      <td>3227.822</td>
      <td>2978</td>
      <td>0.004050</td>
      <td>2235.610</td>
      <td>1535</td>
      <td>0.009392</td>
      <td>1539.905</td>
      <td>27.229288</td>
      <td>2.969525</td>
      <td>28.389547</td>
    </tr>
    <tr>
      <th>26</th>
      <td>ASW_2020_09_16_27</td>
      <td>0.007303</td>
      <td>6636</td>
      <td>0.007753</td>
      <td>4533</td>
      <td>0.008098</td>
      <td>3959</td>
      <td>0.007518</td>
      <td>2300</td>
      <td>0.007247</td>
      <td>...</td>
      <td>3228.304</td>
      <td>2295</td>
      <td>0.001530</td>
      <td>1906.319</td>
      <td>1495</td>
      <td>0.004807</td>
      <td>1520.620</td>
      <td>3.170572</td>
      <td>1.399266</td>
      <td>3.305672</td>
    </tr>
    <tr>
      <th>27</th>
      <td>ASW_2020_09_16_28</td>
      <td>0.007890</td>
      <td>6332</td>
      <td>0.008135</td>
      <td>4545</td>
      <td>0.008503</td>
      <td>4139</td>
      <td>0.008035</td>
      <td>2480</td>
      <td>0.007282</td>
      <td>...</td>
      <td>3242.286</td>
      <td>2698</td>
      <td>0.001674</td>
      <td>2100.615</td>
      <td>1495</td>
      <td>0.006589</td>
      <td>1520.620</td>
      <td>2.966754</td>
      <td>1.841489</td>
      <td>3.093169</td>
    </tr>
    <tr>
      <th>28</th>
      <td>ASW_2020_09_16_29</td>
      <td>0.008264</td>
      <td>6332</td>
      <td>0.008545</td>
      <td>4563</td>
      <td>0.008896</td>
      <td>4139</td>
      <td>0.008449</td>
      <td>2480</td>
      <td>0.007719</td>
      <td>...</td>
      <td>3242.286</td>
      <td>2698</td>
      <td>0.001720</td>
      <td>2100.615</td>
      <td>1495</td>
      <td>0.006580</td>
      <td>1520.620</td>
      <td>3.023007</td>
      <td>1.840784</td>
      <td>3.151819</td>
    </tr>
    <tr>
      <th>29</th>
      <td>ASW_2020_09_16_30</td>
      <td>0.008619</td>
      <td>6331</td>
      <td>0.008641</td>
      <td>4562</td>
      <td>0.009109</td>
      <td>4084</td>
      <td>0.008596</td>
      <td>2480</td>
      <td>0.008381</td>
      <td>...</td>
      <td>3228.304</td>
      <td>2602</td>
      <td>0.001573</td>
      <td>2054.332</td>
      <td>1574</td>
      <td>0.004599</td>
      <td>1558.708</td>
      <td>3.025809</td>
      <td>1.338555</td>
      <td>3.154741</td>
    </tr>
    <tr>
      <th>30</th>
      <td>ASW_2020_09_16_31</td>
      <td>0.008318</td>
      <td>6636</td>
      <td>0.008889</td>
      <td>4543</td>
      <td>0.009277</td>
      <td>3959</td>
      <td>0.008351</td>
      <td>2461</td>
      <td>0.008204</td>
      <td>...</td>
      <td>3223.965</td>
      <td>2437</td>
      <td>0.002416</td>
      <td>1974.781</td>
      <td>1495</td>
      <td>0.006633</td>
      <td>1520.620</td>
      <td>3.256800</td>
      <td>1.924223</td>
      <td>3.395574</td>
    </tr>
  </tbody>
</table>
<p>31 rows √ó 31 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#data_anex_df = data_anex_df.T.iloc[1:].T</span>
<span class="c1">#data_anex_df_2 = data_anex_df_2.T.iloc[1:].T</span>
<span class="c1">#data_anex_df_3 = data_anex_df_3.T.iloc[1:].T</span>
<span class="c1">#data_anex_df_4 = data_anex_df_4.T.iloc[1:].T</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_anex_df_2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>min1</th>
      <th>index1</th>
      <th>min2</th>
      <th>index2</th>
      <th>min3</th>
      <th>index3</th>
      <th>min4</th>
      <th>index4</th>
      <th>min5</th>
      <th>...</th>
      <th>maxA0w</th>
      <th>maxBi</th>
      <th>maxB</th>
      <th>maxBw</th>
      <th>maxCi</th>
      <th>maxC</th>
      <th>maxCw</th>
      <th>Int_A</th>
      <th>Int_C</th>
      <th>Int_N_A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ASW_2020_09_28_1</td>
      <td>-0.026504</td>
      <td>6620</td>
      <td>-0.024226</td>
      <td>4401</td>
      <td>-0.022407</td>
      <td>4134</td>
      <td>-0.009105</td>
      <td>2458</td>
      <td>-0.007995</td>
      <td>...</td>
      <td>3272.178</td>
      <td>2923</td>
      <td>0.009211</td>
      <td>2209.094</td>
      <td>1780</td>
      <td>0.022529</td>
      <td>1658.026</td>
      <td>86.558093</td>
      <td>6.591012</td>
      <td>100.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ASW_2020_09_28_2</td>
      <td>-0.025427</td>
      <td>6636</td>
      <td>-0.022822</td>
      <td>4372</td>
      <td>-0.021184</td>
      <td>4144</td>
      <td>-0.007454</td>
      <td>2477</td>
      <td>-0.006254</td>
      <td>...</td>
      <td>3276.035</td>
      <td>2942</td>
      <td>0.007386</td>
      <td>2218.254</td>
      <td>1771</td>
      <td>0.019989</td>
      <td>1653.686</td>
      <td>86.043652</td>
      <td>5.563222</td>
      <td>99.405669</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ASW_2020_09_28_3</td>
      <td>-0.024675</td>
      <td>6636</td>
      <td>-0.021948</td>
      <td>4401</td>
      <td>-0.020278</td>
      <td>4142</td>
      <td>-0.006614</td>
      <td>2477</td>
      <td>-0.005435</td>
      <td>...</td>
      <td>3276.035</td>
      <td>2942</td>
      <td>0.007681</td>
      <td>2218.254</td>
      <td>1771</td>
      <td>0.020173</td>
      <td>1653.686</td>
      <td>86.876902</td>
      <td>5.599657</td>
      <td>100.368318</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ASW_2020_09_28_4</td>
      <td>-0.024353</td>
      <td>6632</td>
      <td>-0.021656</td>
      <td>4393</td>
      <td>-0.019961</td>
      <td>4142</td>
      <td>-0.006287</td>
      <td>2477</td>
      <td>-0.005064</td>
      <td>...</td>
      <td>3271.213</td>
      <td>2923</td>
      <td>0.007746</td>
      <td>2209.094</td>
      <td>1771</td>
      <td>0.020165</td>
      <td>1653.686</td>
      <td>87.117734</td>
      <td>5.607032</td>
      <td>100.646549</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ASW_2020_09_28_5</td>
      <td>-0.024163</td>
      <td>6632</td>
      <td>-0.021448</td>
      <td>4401</td>
      <td>-0.019691</td>
      <td>4134</td>
      <td>-0.005975</td>
      <td>2458</td>
      <td>-0.004768</td>
      <td>...</td>
      <td>3276.035</td>
      <td>2942</td>
      <td>0.007936</td>
      <td>2218.254</td>
      <td>1771</td>
      <td>0.020096</td>
      <td>1653.686</td>
      <td>87.298165</td>
      <td>5.540918</td>
      <td>100.855000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>75</th>
      <td>ASW_2020_09_28_76</td>
      <td>0.033360</td>
      <td>6633</td>
      <td>0.035411</td>
      <td>4154</td>
      <td>0.035383</td>
      <td>4135</td>
      <td>0.040743</td>
      <td>2479</td>
      <td>0.041975</td>
      <td>...</td>
      <td>3226.858</td>
      <td>2990</td>
      <td>0.005160</td>
      <td>2241.396</td>
      <td>1675</td>
      <td>0.008315</td>
      <td>1607.402</td>
      <td>40.624815</td>
      <td>2.506664</td>
      <td>46.933584</td>
    </tr>
    <tr>
      <th>76</th>
      <td>ASW_2020_09_28_77</td>
      <td>0.039784</td>
      <td>6633</td>
      <td>0.040950</td>
      <td>4154</td>
      <td>0.040848</td>
      <td>4077</td>
      <td>0.043054</td>
      <td>2479</td>
      <td>0.043847</td>
      <td>...</td>
      <td>3225.894</td>
      <td>3040</td>
      <td>0.003348</td>
      <td>2265.502</td>
      <td>1675</td>
      <td>0.006200</td>
      <td>1607.402</td>
      <td>22.869835</td>
      <td>1.940948</td>
      <td>26.421371</td>
    </tr>
    <tr>
      <th>77</th>
      <td>ASW_2020_09_28_78</td>
      <td>0.043527</td>
      <td>6335</td>
      <td>0.043778</td>
      <td>4163</td>
      <td>0.043654</td>
      <td>3962</td>
      <td>0.043991</td>
      <td>2345</td>
      <td>0.043920</td>
      <td>...</td>
      <td>3224.929</td>
      <td>2300</td>
      <td>0.002073</td>
      <td>1908.730</td>
      <td>947</td>
      <td>0.005038</td>
      <td>1256.416</td>
      <td>5.198979</td>
      <td>2.124355</td>
      <td>6.006347</td>
    </tr>
    <tr>
      <th>78</th>
      <td>ASW_2020_09_28_79</td>
      <td>0.043639</td>
      <td>6638</td>
      <td>0.043704</td>
      <td>4557</td>
      <td>0.044042</td>
      <td>3943</td>
      <td>0.044228</td>
      <td>2345</td>
      <td>0.044163</td>
      <td>...</td>
      <td>3224.929</td>
      <td>2321</td>
      <td>0.002171</td>
      <td>1918.855</td>
      <td>947</td>
      <td>0.005697</td>
      <td>1256.416</td>
      <td>3.493992</td>
      <td>2.447063</td>
      <td>4.036586</td>
    </tr>
    <tr>
      <th>79</th>
      <td>ASW_2020_09_28_80</td>
      <td>0.016138</td>
      <td>6633</td>
      <td>0.020018</td>
      <td>4211</td>
      <td>0.020286</td>
      <td>4136</td>
      <td>0.033108</td>
      <td>2489</td>
      <td>0.034497</td>
      <td>...</td>
      <td>3248.072</td>
      <td>3037</td>
      <td>0.011578</td>
      <td>2264.056</td>
      <td>1698</td>
      <td>0.018059</td>
      <td>1618.491</td>
      <td>102.387413</td>
      <td>7.200944</td>
      <td>118.287510</td>
    </tr>
  </tbody>
</table>
<p>80 rows √ó 31 columns</p>
</div></div></div>
</div>
<p>Purpose of this section is to perform a deep analysis of the sample with respect to the temperature ramp as for example,</p>
<ul class="simple">
<li><p>plots various scans at different temperature, identify various range of interest.</p></li>
<li><p>perform linear regression of desorption data</p></li>
<li><p>average scans when isotherm ?</p></li>
</ul>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="data-cleaning">
<h1>1.2 DATA Cleaning<a class="headerlink" href="#data-cleaning" title="Permalink to this headline">¬∂</a></h1>
<div class="section" id="annealing-scan-supression-and-averaging-of-the-isotherms">
<h2>1.2.1 Annealing scan supression and averaging of the isotherms ?<a class="headerlink" href="#annealing-scan-supression-and-averaging-of-the-isotherms" title="Permalink to this headline">¬∂</a></h2>
</div>
<div class="section" id="error-analysis">
<h2>1.2.2 Error Analysis<a class="headerlink" href="#error-analysis" title="Permalink to this headline">¬∂</a></h2>
<p>After having avaeraged the scan previously, the purpose of this section is to identify the potential sources of errors and to generate error bars for the data accordingly</p>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="data-compare">
<h1>1.2 DATA Compare<a class="headerlink" href="#data-compare" title="Permalink to this headline">¬∂</a></h1>
<div class="section" id="maxa">
<h2>1.2.1 MaxA<a class="headerlink" href="#maxa" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="prepare-two-dictionnaries">
<h3>Prepare two dictionnaries<a class="headerlink" href="#prepare-two-dictionnaries" title="Permalink to this headline">¬∂</a></h3>
<div class="section" id="dict-1">
<h4>Dict 1<a class="headerlink" href="#dict-1" title="Permalink to this headline">¬∂</a></h4>
<p>16-09</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">25</span><span class="p">]</span>
<span class="n">j</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Dep&quot;</span><span class="p">,</span><span class="s2">&quot;20&quot;</span><span class="p">,</span><span class="s2">&quot;40&quot;</span><span class="p">,</span><span class="s2">&quot;60&quot;</span><span class="p">,</span><span class="s2">&quot;80&quot;</span><span class="p">,</span><span class="s2">&quot;100&quot;</span><span class="p">,</span><span class="s2">&quot;120&quot;</span><span class="p">,</span><span class="s2">&quot;130&quot;</span><span class="p">,</span><span class="s2">&quot;140&quot;</span><span class="p">,</span><span class="s2">&quot;160&quot;</span><span class="p">]</span>

<span class="n">Td</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>

<span class="n">nscanTd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data_anex_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">nscanTd</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Td</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>31
{&#39;Dep&#39;: 0, &#39;20&#39;: 1, &#39;40&#39;: 4, &#39;60&#39;: 7, &#39;80&#39;: 10, &#39;100&#39;: 13, &#39;120&#39;: 16, &#39;130&#39;: 19, &#39;140&#39;: 22, &#39;160&#39;: 25}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="dict-2">
<h4>Dict 2<a class="headerlink" href="#dict-2" title="Permalink to this headline">¬∂</a></h4>
<p>28-09</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">79</span><span class="p">]</span>
<span class="n">j</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Dep&quot;</span><span class="p">,</span><span class="s2">&quot;20&quot;</span><span class="p">,</span><span class="s2">&quot;40&quot;</span><span class="p">,</span><span class="s2">&quot;60&quot;</span><span class="p">,</span><span class="s2">&quot;80&quot;</span><span class="p">,</span><span class="s2">&quot;100&quot;</span><span class="p">,</span><span class="s2">&quot;120&quot;</span><span class="p">,</span><span class="s2">&quot;130&quot;</span><span class="p">,</span><span class="s2">&quot;140&quot;</span><span class="p">,</span><span class="s2">&quot;160&quot;</span><span class="p">]</span>

<span class="n">T2d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>

<span class="n">nscanT2d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data_anex_df_2</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">nscanT2d</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">T2d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>80
{&#39;Dep&#39;: 0, &#39;20&#39;: 1, &#39;40&#39;: 8, &#39;60&#39;: 16, &#39;80&#39;: 24, &#39;100&#39;: 32, &#39;120&#39;: 40, &#39;130&#39;: 52, &#39;140&#39;: 60, &#39;160&#39;: 79}
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="plot">
<h3>Plot<a class="headerlink" href="#plot" title="Permalink to this headline">¬∂</a></h3>
<div class="section" id="peak-frequency-shift">
<h4>Peak frequency shift<a class="headerlink" href="#peak-frequency-shift" title="Permalink to this headline">¬∂</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">),</span> <span class="p">(</span><span class="n">k2</span><span class="p">,</span><span class="n">v2</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">Td</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">T2d</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>

    <span class="n">spl1</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">data_anex_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">v</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">v</span><span class="o">/</span><span class="n">nscanTd</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span> <span class="s2">&quot;16_09&quot;</span><span class="p">)</span>
    <span class="n">spl2</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k2</span><span class="p">,</span> <span class="n">data_anex_df_2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">v2</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">v2</span><span class="o">/</span><span class="n">nscanT2d</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span> <span class="s2">&quot;28_09&quot;</span><span class="p">)</span>
    <span class="n">spl3</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">data_anex_df_3</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">v</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">v</span><span class="o">/</span><span class="n">nscanTd</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span> <span class="s2">&quot;17_09&quot;</span><span class="p">)</span>
    <span class="n">spl4</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">data_anex_df_4</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">v</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">v</span><span class="o">/</span><span class="n">nscanTd</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span> <span class="s2">&quot;21_09&quot;</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;DR2 OH stretch Peak frequency (sample comparison)&#39;</span><span class="p">)</span>
<span class="c1">#plt.axis([3210,3270])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Peak frequency (cm-1)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="c1">#ax = fig.gca()</span>
<span class="c1">#plt.grid()</span>
<span class="c1">#plt.legend()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">spl1</span><span class="p">,</span> <span class="n">spl2</span><span class="p">,</span> <span class="n">spl3</span><span class="p">,</span> <span class="n">spl4</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;16_09&quot;</span><span class="p">,</span> <span class="s2">&quot;28_09&quot;</span><span class="p">,</span> <span class="s2">&quot;17_09&quot;</span><span class="p">,</span> <span class="s2">&quot;21_09&quot;</span><span class="p">],</span><span class="n">bbox_to_anchor</span> <span class="o">=</span><span class="p">(</span><span class="mf">1.25</span><span class="p">,</span> <span class="mi">1</span><span class="p">),)</span>

<span class="c1">#plt.savefig(&#39;D:\DATA-Processing\PAC\{}/Compare/DR2_{}_{}_PeakA-frequency.png&#39;.format(XP, date, date2))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Data_Processing_Full_07-22_63_0.png" src="../../_images/Data_Processing_Full_07-22_63_0.png" />
</div>
</div>
</div>
<div class="section" id="integration-from-normalized-data">
<h4>Integration from normalized data<a class="headerlink" href="#integration-from-normalized-data" title="Permalink to this headline">¬∂</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">),</span> <span class="p">(</span><span class="n">k2</span><span class="p">,</span><span class="n">v2</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">Td</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">T2d</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>

    <span class="n">spl1</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">data_anex_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">v</span><span class="p">,</span><span class="mi">30</span><span class="p">],</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">v</span><span class="o">/</span><span class="n">nscanTd</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span> <span class="s2">&quot;16_09&quot;</span><span class="p">)</span>
    <span class="n">spl2</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k2</span><span class="p">,</span> <span class="n">data_anex_df_2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">v2</span><span class="p">,</span><span class="mi">30</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">v2</span><span class="o">/</span><span class="n">nscanT2d</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span> <span class="s2">&quot;28_09&quot;</span><span class="p">)</span>
    <span class="n">spl3</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">data_anex_df_3</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">v</span><span class="p">,</span><span class="mi">30</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">v</span><span class="o">/</span><span class="n">nscanTd</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span> <span class="s2">&quot;17_09&quot;</span><span class="p">)</span>
    <span class="n">spl4</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">data_anex_df_4</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">v</span><span class="p">,</span><span class="mi">30</span><span class="p">],</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">v</span><span class="o">/</span><span class="n">nscanTd</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span> <span class="s2">&quot;21_09&quot;</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;DR2 OH stretch Integration value (sample comparison)&#39;</span><span class="p">)</span>
<span class="c1">#plt.axis([3210,3270])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Integration (AU)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="c1">#ax = fig.gca()</span>
<span class="c1">#plt.grid()</span>
<span class="c1">#plt.legend()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">spl1</span><span class="p">,</span> <span class="n">spl2</span><span class="p">,</span> <span class="n">spl3</span><span class="p">,</span> <span class="n">spl4</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;16_09&quot;</span><span class="p">,</span> <span class="s2">&quot;28_09&quot;</span><span class="p">,</span> <span class="s2">&quot;17_09&quot;</span><span class="p">,</span> <span class="s2">&quot;21_09&quot;</span><span class="p">])</span>

<span class="c1">#plt.savefig(&#39;D:\DATA-Processing\PAC\{}/Compare/DR2_{}_{}_PeakA-frequency.png&#39;.format(XP, date, date2))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="data-chopping">
<h1>1.3 Data chopping<a class="headerlink" href="#data-chopping" title="Permalink to this headline">¬∂</a></h1>
<div class="section" id="temperature-list-splitting">
<h2>1.3.1 Temperature list splitting<a class="headerlink" href="#temperature-list-splitting" title="Permalink to this headline">¬∂</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Temp</span> <span class="o">=</span> <span class="n">XP_Ramp_df_I</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Temp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;20K &#39;,
 &#39;30K&#39;,
 &#39;40K&#39;,
 &#39;50K&#39;,
 &#39;60K&#39;,
 &#39;70K&#39;,
 &#39;80K&#39;,
 &#39;90K&#39;,
 &#39;100K&#39;,
 &#39;110K&#39;,
 &#39;120K&#39;,
 &#39;125K&#39;,
 &#39;130K&#39;,
 &#39;132K&#39;,
 &#39;134K&#39;,
 &#39;135K&#39;,
 &#39;136K&#39;,
 &#39;137K&#39;,
 &#39;138K&#39;,
 &#39;140K&#39;,
 &#39;142K&#39;,
 &#39;145K&#39;,
 &#39;150K&#39;,
 &#39;155K&#39;,
 &#39;160K&#39;,
 &#39;180K&#39;,
 &#39;200K&#39;]
</pre></div>
</div>
</div>
</div>
<p>iterate through temp and recover scan number value for T in range 1,2,3,4</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T1</span> <span class="o">=</span> <span class="n">Temp</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span>
<span class="n">T2</span> <span class="o">=</span> <span class="n">Temp</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">13</span><span class="p">]</span>
<span class="n">T3</span> <span class="o">=</span> <span class="n">Temp</span><span class="p">[</span><span class="mi">12</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span>
<span class="n">T4</span> <span class="o">=</span> <span class="n">Temp</span><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">26</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="sanity-check">
<h3>Sanity Check<a class="headerlink" href="#sanity-check" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;100K&#39;, &#39;110K&#39;, &#39;120K&#39;, &#39;125K&#39;, &#39;130K&#39;]
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="list-of-sample-names-per-range">
<h2>1.1.3 List of sample names per range<a class="headerlink" href="#list-of-sample-names-per-range" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="range-1">
<h3>Range 1<a class="headerlink" href="#range-1" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">value_1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">file_number1</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">T1</span><span class="p">:</span>

    <span class="n">value</span> <span class="o">=</span> <span class="n">XP_Ramp_df_I</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">XP_Ramp_df_I</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notnull</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        
        <span class="n">value_1</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[-+]?\d*\.\d+|\d+&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="n">value_1</span><span class="p">:</span>
        
            <span class="n">to_plot</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spl</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">items</span><span class="p">))</span>
            <span class="n">z</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                
            <span class="s1">&#39;Name&#39;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">to_plot</span><span class="p">),</span>
            <span class="s1">&#39;Temp&#39;</span> <span class="p">:</span> <span class="n">y</span><span class="p">,</span>
            <span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">date</span><span class="p">,</span>
         
            <span class="p">})</span>
            
            <span class="n">file_number1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">items</span><span class="p">))</span>

<span class="n">dat1</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">R1_df</span> <span class="o">=</span> <span class="n">dat1</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Name&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;Name&#39;: &#39;ASW_2021_05_24_1&#39;, &#39;Temp&#39;: &#39;20K &#39;, &#39;Date&#39;: &#39;2021_05_24&#39;},
 {&#39;Name&#39;: &#39;ASW_2021_05_24_2&#39;, &#39;Temp&#39;: &#39;20K &#39;, &#39;Date&#39;: &#39;2021_05_24&#39;},
 {&#39;Name&#39;: &#39;ASW_2021_05_24_3&#39;, &#39;Temp&#39;: &#39;20K &#39;, &#39;Date&#39;: &#39;2021_05_24&#39;},
 {&#39;Name&#39;: &#39;ASW_2021_05_24_4&#39;, &#39;Temp&#39;: &#39;70K&#39;, &#39;Date&#39;: &#39;2021_05_24&#39;},
 {&#39;Name&#39;: &#39;ASW_2021_05_24_5&#39;, &#39;Temp&#39;: &#39;70K&#39;, &#39;Date&#39;: &#39;2021_05_24&#39;},
 {&#39;Name&#39;: &#39;ASW_2021_05_24_6&#39;, &#39;Temp&#39;: &#39;70K&#39;, &#39;Date&#39;: &#39;2021_05_24&#39;},
 {&#39;Name&#39;: &#39;ASW_2021_05_24_7&#39;, &#39;Temp&#39;: &#39;70K&#39;, &#39;Date&#39;: &#39;2021_05_24&#39;}]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R1_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Temp</th>
      <th>Date</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ASW_2021_05_24_1</th>
      <td>20K</td>
      <td>2021_05_24</td>
    </tr>
    <tr>
      <th>ASW_2021_05_24_2</th>
      <td>20K</td>
      <td>2021_05_24</td>
    </tr>
    <tr>
      <th>ASW_2021_05_24_3</th>
      <td>20K</td>
      <td>2021_05_24</td>
    </tr>
    <tr>
      <th>ASW_2021_05_24_4</th>
      <td>70K</td>
      <td>2021_05_24</td>
    </tr>
    <tr>
      <th>ASW_2021_05_24_5</th>
      <td>70K</td>
      <td>2021_05_24</td>
    </tr>
    <tr>
      <th>ASW_2021_05_24_6</th>
      <td>70K</td>
      <td>2021_05_24</td>
    </tr>
    <tr>
      <th>ASW_2021_05_24_7</th>
      <td>70K</td>
      <td>2021_05_24</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="range-2">
<h3>Range 2<a class="headerlink" href="#range-2" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">value_1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">file_number2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">T2</span><span class="p">:</span>

    <span class="n">value</span> <span class="o">=</span> <span class="n">XP_Ramp_df_I</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">XP_Ramp_df_I</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notnull</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        
        <span class="n">value_1</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[-+]?\d*\.\d+|\d+&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="n">value_1</span><span class="p">:</span>
        
            <span class="n">to_plot</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spl</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">items</span><span class="p">))</span>
            <span class="n">z</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                
            <span class="s1">&#39;Name&#39;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">to_plot</span><span class="p">),</span>
            <span class="s1">&#39;Temp&#39;</span> <span class="p">:</span> <span class="n">y</span><span class="p">,</span>
            <span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">date</span><span class="p">,</span>
         
            <span class="p">})</span>
            
            <span class="n">file_number2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">items</span><span class="p">))</span>

<span class="n">dat2</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">R2_df</span> <span class="o">=</span> <span class="n">dat2</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Name&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">21</span><span class="o">-</span><span class="mi">5</span><span class="n">bf50306e56a</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">24</span> 
<span class="g g-Whitespace">     </span><span class="mi">25</span> <span class="n">dat2</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">26</span> <span class="n">R2_df</span> <span class="o">=</span> <span class="n">dat2</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Name&#39;</span><span class="p">)</span>

<span class="nn">~\Anaconda3\lib\site-packages\pandas\core\frame.py</span> in <span class="ni">set_index</span><span class="nt">(self, keys, drop, append, inplace, verify_integrity)</span>
<span class="g g-Whitespace">   </span><span class="mi">4301</span> 
<span class="g g-Whitespace">   </span><span class="mi">4302</span>         <span class="k">if</span> <span class="n">missing</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">4303</span>             <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;None of </span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2"> are in the columns&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4304</span> 
<span class="g g-Whitespace">   </span><span class="mi">4305</span>         <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>

<span class="ne">KeyError</span>: &quot;None of [&#39;Name&#39;] are in the columns&quot;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R2_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="range-3">
<h3>Range 3<a class="headerlink" href="#range-3" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">value_1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">file_number3</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">T3</span><span class="p">:</span>

    <span class="n">value</span> <span class="o">=</span> <span class="n">XP_Ramp_df_I</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">XP_Ramp_df_I</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notnull</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        
        <span class="n">value_1</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[-+]?\d*\.\d+|\d+&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="n">value_1</span><span class="p">:</span>
        
            <span class="n">to_plot</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spl</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">items</span><span class="p">))</span>
            <span class="n">z</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                
            <span class="s1">&#39;Name&#39;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">to_plot</span><span class="p">),</span>
            <span class="s1">&#39;Temp&#39;</span> <span class="p">:</span> <span class="n">y</span><span class="p">,</span>
            <span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">date</span><span class="p">,</span>
         
            <span class="p">})</span>
            
            <span class="n">file_number3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">items</span><span class="p">))</span>

<span class="n">dat3</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">R3_df</span> <span class="o">=</span> <span class="n">dat3</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Name&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R3_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Temp</th>
      <th>Date</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ASW_2021_05_24_8</th>
      <td>135K</td>
      <td>2021_05_24</td>
    </tr>
    <tr>
      <th>ASW_2021_05_24_9</th>
      <td>135K</td>
      <td>2021_05_24</td>
    </tr>
    <tr>
      <th>ASW_2021_05_24_10</th>
      <td>135K</td>
      <td>2021_05_24</td>
    </tr>
    <tr>
      <th>ASW_2021_05_24_11</th>
      <td>135K</td>
      <td>2021_05_24</td>
    </tr>
    <tr>
      <th>ASW_2021_05_24_12</th>
      <td>135K</td>
      <td>2021_05_24</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>ASW_2021_05_24_414</th>
      <td>140K</td>
      <td>2021_05_24</td>
    </tr>
    <tr>
      <th>ASW_2021_05_24_415</th>
      <td>140K</td>
      <td>2021_05_24</td>
    </tr>
    <tr>
      <th>ASW_2021_05_24_416</th>
      <td>140K</td>
      <td>2021_05_24</td>
    </tr>
    <tr>
      <th>ASW_2021_05_24_417</th>
      <td>140K</td>
      <td>2021_05_24</td>
    </tr>
    <tr>
      <th>ASW_2021_05_24_418</th>
      <td>140K</td>
      <td>2021_05_24</td>
    </tr>
  </tbody>
</table>
<p>411 rows √ó 2 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="range-4">
<h3>Range 4<a class="headerlink" href="#range-4" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">value_1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">file_number4</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">T4</span><span class="p">:</span>

    <span class="n">value</span> <span class="o">=</span> <span class="n">XP_Ramp_df_I</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">XP_Ramp_df_I</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notnull</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        
        <span class="n">value_1</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[-+]?\d*\.\d+|\d+&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="n">value_1</span><span class="p">:</span>
        
            <span class="n">to_plot</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spl</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">items</span><span class="p">))</span>
            <span class="n">z</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                
            <span class="s1">&#39;Name&#39;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">to_plot</span><span class="p">),</span>
            <span class="s1">&#39;Temp&#39;</span> <span class="p">:</span> <span class="n">y</span><span class="p">,</span>
            <span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">date</span><span class="p">,</span>
         
            <span class="p">})</span>
            
            <span class="n">file_number4</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">items</span><span class="p">))</span>

<span class="n">dat4</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">R4_df</span> <span class="o">=</span> <span class="n">dat4</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Name&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R4_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Temp</th>
      <th>Date</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ASW_2021_05_24_393</th>
      <td>140K</td>
      <td>2021_05_24</td>
    </tr>
    <tr>
      <th>ASW_2021_05_24_394</th>
      <td>140K</td>
      <td>2021_05_24</td>
    </tr>
    <tr>
      <th>ASW_2021_05_24_395</th>
      <td>140K</td>
      <td>2021_05_24</td>
    </tr>
    <tr>
      <th>ASW_2021_05_24_396</th>
      <td>140K</td>
      <td>2021_05_24</td>
    </tr>
    <tr>
      <th>ASW_2021_05_24_397</th>
      <td>140K</td>
      <td>2021_05_24</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>ASW_2021_05_24_495</th>
      <td>145K</td>
      <td>2021_05_24</td>
    </tr>
    <tr>
      <th>ASW_2021_05_24_496</th>
      <td>145K</td>
      <td>2021_05_24</td>
    </tr>
    <tr>
      <th>ASW_2021_05_24_497</th>
      <td>145K</td>
      <td>2021_05_24</td>
    </tr>
    <tr>
      <th>ASW_2021_05_24_498</th>
      <td>145K</td>
      <td>2021_05_24</td>
    </tr>
    <tr>
      <th>ASW_2021_05_24_499</th>
      <td>145K</td>
      <td>2021_05_24</td>
    </tr>
  </tbody>
</table>
<p>107 rows √ó 2 columns</p>
</div></div></div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="plotting">
<h1>1.4 Plotting<a class="headerlink" href="#plotting" title="Permalink to this headline">¬∂</a></h1>
<p>Plot 4 subplot in square formating for all 4 T range</p>
<div class="section" id="t-ranges">
<h2>1.4.1 T ranges<a class="headerlink" href="#t-ranges" title="Permalink to this headline">¬∂</a></h2>
</div>
<div class="section" id="gridspec">
<h2>Gridspec<a class="headerlink" href="#gridspec" title="Permalink to this headline">¬∂</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;20K 10-7 All samples&#39;</span><span class="p">)</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">])</span> <span class="c1"># row 0, col 0</span>

<span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">R1_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>


<span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dat1</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">],</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nscan</span><span class="p">)):</span>   
<span class="c1">#    for iscan in range(1,nscan):</span>
<span class="c1">#DR2</span>

    <span class="c1">#x = DR2_Allscans_full.Wavenumber</span>
    <span class="c1">#y = DR2_Allscans_full[&#39;{}&#39;.format(i)]</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">DR3_Allscan_df</span><span class="o">.</span><span class="n">Wavenumber</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">DR3_Allscan_df</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">R1_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Date&#39;</span><span class="p">]),</span> <span class="nb">str</span><span class="p">(</span><span class="n">R1_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Temp&#39;</span><span class="p">])),</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">j</span><span class="o">/</span><span class="n">nscan</span><span class="p">))</span> 
    
    <span class="n">j</span><span class="o">=+</span><span class="mi">1</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Full range&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">4000</span><span class="p">,</span> <span class="mi">2800</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span><span class="mi">16</span><span class="p">])</span> <span class="c1"># row 0, col 0</span>
<span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">R2_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>


<span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dat2</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">],</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nscan</span><span class="p">)):</span>   
<span class="c1">#    for iscan in range(1,nscan):</span>
<span class="c1">#DR2</span>

    <span class="c1">#x = DR2_Allscans_full.Wavenumber</span>
    <span class="c1">#y = DR2_Allscans_full[&#39;{}&#39;.format(i)]</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">DR3_Allscan_df</span><span class="o">.</span><span class="n">Wavenumber</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">DR3_Allscan_df</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">R2_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Date&#39;</span><span class="p">]),</span> <span class="nb">str</span><span class="p">(</span><span class="n">R2_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Temp&#39;</span><span class="p">])),</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">j</span><span class="o">/</span><span class="n">nscan</span><span class="p">))</span> 
    
    <span class="n">j</span><span class="o">=+</span><span class="mi">1</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Normalized zoom&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>     
<span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">4000</span><span class="p">,</span> <span class="mi">2800</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">])</span> <span class="c1"># row 0, col 0  </span>

<span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">R3_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>


<span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dat3</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">],</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nscan</span><span class="p">)):</span>   
<span class="c1">#    for iscan in range(1,nscan):</span>
<span class="c1">#DR2</span>

    <span class="c1">#x = DR2_Allscans_full.Wavenumber</span>
    <span class="c1">#y = DR2_Allscans_full[&#39;{}&#39;.format(i)]</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">DR3_Allscan_df</span><span class="o">.</span><span class="n">Wavenumber</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">DR3_Allscan_df</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">R3_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Date&#39;</span><span class="p">]),</span> <span class="nb">str</span><span class="p">(</span><span class="n">R3_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Temp&#39;</span><span class="p">])),</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">j</span><span class="o">/</span><span class="n">nscan</span><span class="p">))</span> 
    
    <span class="n">j</span><span class="o">=+</span><span class="mi">1</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;BC zoomed&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">4000</span><span class="p">,</span> <span class="mi">2800</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span><span class="mi">16</span><span class="p">])</span> <span class="c1"># row 0, col 0  </span>

<span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">R4_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>


<span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dat4</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">],</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nscan</span><span class="p">)):</span>   
<span class="c1">#    for iscan in range(1,nscan):</span>
<span class="c1">#DR2</span>

    <span class="c1">#x = DR2_Allscans_full.Wavenumber</span>
    <span class="c1">#y = DR2_Allscans_full[&#39;{}&#39;.format(i)]</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">DR3_Allscan_df</span><span class="o">.</span><span class="n">Wavenumber</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">DR3_Allscan_df</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">R4_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Date&#39;</span><span class="p">]),</span> <span class="nb">str</span><span class="p">(</span><span class="n">R4_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Temp&#39;</span><span class="p">])),</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">j</span><span class="o">/</span><span class="n">nscan</span><span class="p">))</span> 
    
    <span class="n">j</span><span class="o">=+</span><span class="mi">1</span>

<span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;BC zoomed&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">4000</span><span class="p">,</span> <span class="mi">2800</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">26</span><span class="o">-</span><span class="n">d01ae63ef9a4</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">30</span> 
<span class="g g-Whitespace">     </span><span class="mi">31</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span><span class="mi">16</span><span class="p">])</span> <span class="c1"># row 0, col 0</span>
<span class="ne">---&gt; </span><span class="mi">32</span> <span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">R2_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
<span class="g g-Whitespace">     </span><span class="mi">33</span> 
<span class="g g-Whitespace">     </span><span class="mi">34</span> 

<span class="ne">NameError</span>: name &#39;R2_df&#39; is not defined
</pre></div>
</div>
<img alt="../../_images/Data_Processing_Full_07-22_92_1.png" src="../../_images/Data_Processing_Full_07-22_92_1.png" />
</div>
</div>
<p>insert condition to supress first scan (ramp)
Implement maxA
Increase spacing between plots</p>
</div>
<div class="section" id="other-plot">
<h2>Other plot<a class="headerlink" href="#other-plot" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="different-dr-outputs">
<h3>Different DR Outputs<a class="headerlink" href="#different-dr-outputs" title="Permalink to this headline">¬∂</a></h3>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="scan-averaging-and-error-analysis">
<h1>1.6 Scan Averaging and error analysis ?<a class="headerlink" href="#scan-averaging-and-error-analysis" title="Permalink to this headline">¬∂</a></h1>
<p>Supress the first scan and average the remaining scan</p>
<p>Have a though about error bars</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="id1">
<h1>1.7 Data processing<a class="headerlink" href="#id1" title="Permalink to this headline">¬∂</a></h1>
<div class="section" id="linear-regression-of-desorption">
<h2>1.7.1 Linear regression of desorption<a class="headerlink" href="#linear-regression-of-desorption" title="Permalink to this headline">¬∂</a></h2>
<p>This is where some fitting options needs to be implemented ie:</p>
<ul class="simple">
<li><p>linear regression for desorption data</p></li>
<li><p>Polynomial for isotherms at 130, 135K ?</p></li>
</ul>
</div>
<div class="section" id="polynomial-fitting-of-isotherm-at-130k">
<h2>1.7.2 polynomial fitting of isotherm at 130K<a class="headerlink" href="#polynomial-fitting-of-isotherm-at-130k" title="Permalink to this headline">¬∂</a></h2>
<p>Goal,</p>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="span-style-background-yellow-color-green-text-dp2-substraction-scan-span">
<h1><span style='background :yellow' > <span class="math notranslate nohighlight">\(\color{green}{\text{DP2 : Substraction scan}}\)</span> </span><a class="headerlink" href="#span-style-background-yellow-color-green-text-dp2-substraction-scan-span" title="Permalink to this headline">¬∂</a></h1>
<p>use DR2 data</p>
<p>Purpose here is to obtain 4 different substraction spectra for each of the presestablished range (use hot-warm color to plot)</p>
<div class="section" id="data-sanity-check">
<h2>2.1 Data Sanity Check<a class="headerlink" href="#data-sanity-check" title="Permalink to this headline">¬∂</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DR2_Allscan_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Wavenumber</th>
      <th>ASW_2021_05_24_1</th>
      <th>ASW_2021_05_24_2</th>
      <th>ASW_2021_05_24_3</th>
      <th>ASW_2021_05_24_4</th>
      <th>ASW_2021_05_24_5</th>
      <th>ASW_2021_05_24_6</th>
      <th>ASW_2021_05_24_7</th>
      <th>ASW_2021_05_24_8</th>
      <th>ASW_2021_05_24_9</th>
      <th>...</th>
      <th>ASW_2021_05_24_483</th>
      <th>ASW_2021_05_24_484</th>
      <th>ASW_2021_05_24_485</th>
      <th>ASW_2021_05_24_486</th>
      <th>ASW_2021_05_24_487</th>
      <th>ASW_2021_05_24_488</th>
      <th>ASW_2021_05_24_489</th>
      <th>ASW_2021_05_24_490</th>
      <th>ASW_2021_05_24_491</th>
      <th>ASW_2021_05_24_492</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>799.8442</td>
      <td>6.517882e-02</td>
      <td>6.611663e-02</td>
      <td>6.766044e-02</td>
      <td>7.767758e-02</td>
      <td>8.016905e-02</td>
      <td>8.028784e-02</td>
      <td>0.079780</td>
      <td>7.776978e-02</td>
      <td>7.765637e-02</td>
      <td>...</td>
      <td>0.048800</td>
      <td>0.048767</td>
      <td>0.048408</td>
      <td>0.049178</td>
      <td>0.047778</td>
      <td>0.051763</td>
      <td>0.052555</td>
      <td>0.055020</td>
      <td>0.056034</td>
      <td>0.061171</td>
    </tr>
    <tr>
      <th>1</th>
      <td>800.3264</td>
      <td>6.945459e-02</td>
      <td>6.969134e-02</td>
      <td>7.088943e-02</td>
      <td>7.296595e-02</td>
      <td>7.390441e-02</td>
      <td>7.500930e-02</td>
      <td>0.074624</td>
      <td>7.745363e-02</td>
      <td>7.897147e-02</td>
      <td>...</td>
      <td>0.052965</td>
      <td>0.053671</td>
      <td>0.052923</td>
      <td>0.054063</td>
      <td>0.053984</td>
      <td>0.055621</td>
      <td>0.057292</td>
      <td>0.059009</td>
      <td>0.059942</td>
      <td>0.066201</td>
    </tr>
    <tr>
      <th>2</th>
      <td>800.8085</td>
      <td>7.292112e-02</td>
      <td>7.288691e-02</td>
      <td>7.361745e-02</td>
      <td>6.737457e-02</td>
      <td>6.700571e-02</td>
      <td>6.841946e-02</td>
      <td>0.068437</td>
      <td>7.570509e-02</td>
      <td>7.891863e-02</td>
      <td>...</td>
      <td>0.056586</td>
      <td>0.057301</td>
      <td>0.056603</td>
      <td>0.057588</td>
      <td>0.059036</td>
      <td>0.058832</td>
      <td>0.060971</td>
      <td>0.062315</td>
      <td>0.063480</td>
      <td>0.070444</td>
    </tr>
    <tr>
      <th>3</th>
      <td>801.2906</td>
      <td>6.940653e-02</td>
      <td>6.975350e-02</td>
      <td>7.111548e-02</td>
      <td>6.573625e-02</td>
      <td>6.443463e-02</td>
      <td>6.554944e-02</td>
      <td>0.066081</td>
      <td>7.037464e-02</td>
      <td>7.083752e-02</td>
      <td>...</td>
      <td>0.051400</td>
      <td>0.051448</td>
      <td>0.051381</td>
      <td>0.052487</td>
      <td>0.053773</td>
      <td>0.053324</td>
      <td>0.055295</td>
      <td>0.055882</td>
      <td>0.058406</td>
      <td>0.063919</td>
    </tr>
    <tr>
      <th>4</th>
      <td>801.7727</td>
      <td>6.659455e-02</td>
      <td>6.678519e-02</td>
      <td>6.828554e-02</td>
      <td>6.814425e-02</td>
      <td>6.737859e-02</td>
      <td>6.831091e-02</td>
      <td>0.068845</td>
      <td>6.914572e-02</td>
      <td>6.787662e-02</td>
      <td>...</td>
      <td>0.046206</td>
      <td>0.046325</td>
      <td>0.046060</td>
      <td>0.047885</td>
      <td>0.049168</td>
      <td>0.048616</td>
      <td>0.049703</td>
      <td>0.050537</td>
      <td>0.053893</td>
      <td>0.058902</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6636</th>
      <td>3998.2570</td>
      <td>6.052594e-04</td>
      <td>6.155879e-04</td>
      <td>5.891753e-04</td>
      <td>4.509248e-04</td>
      <td>3.057191e-04</td>
      <td>3.017703e-04</td>
      <td>0.000373</td>
      <td>3.303686e-04</td>
      <td>5.509026e-04</td>
      <td>...</td>
      <td>0.000525</td>
      <td>0.000569</td>
      <td>0.000513</td>
      <td>0.000519</td>
      <td>0.000521</td>
      <td>0.000546</td>
      <td>0.000569</td>
      <td>0.000509</td>
      <td>0.000523</td>
      <td>0.000514</td>
    </tr>
    <tr>
      <th>6637</th>
      <td>3998.7390</td>
      <td>3.875527e-04</td>
      <td>3.993715e-04</td>
      <td>3.591537e-04</td>
      <td>2.900099e-04</td>
      <td>1.944961e-04</td>
      <td>1.994642e-04</td>
      <td>0.000299</td>
      <td>2.035522e-04</td>
      <td>3.159683e-04</td>
      <td>...</td>
      <td>0.000346</td>
      <td>0.000352</td>
      <td>0.000322</td>
      <td>0.000330</td>
      <td>0.000345</td>
      <td>0.000352</td>
      <td>0.000361</td>
      <td>0.000334</td>
      <td>0.000336</td>
      <td>0.000338</td>
    </tr>
    <tr>
      <th>6638</th>
      <td>3999.2210</td>
      <td>-8.673617e-19</td>
      <td>-4.336809e-19</td>
      <td>-2.168404e-19</td>
      <td>-3.469447e-18</td>
      <td>-1.301043e-18</td>
      <td>3.469447e-18</td>
      <td>0.000121</td>
      <td>2.168404e-18</td>
      <td>1.734723e-18</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>6639</th>
      <td>3999.7030</td>
      <td>7.357823e-04</td>
      <td>7.429329e-04</td>
      <td>7.613905e-04</td>
      <td>3.697233e-04</td>
      <td>6.489695e-05</td>
      <td>1.846985e-05</td>
      <td>0.000126</td>
      <td>1.990229e-04</td>
      <td>7.767737e-04</td>
      <td>...</td>
      <td>0.000430</td>
      <td>0.000447</td>
      <td>0.000411</td>
      <td>0.000422</td>
      <td>0.000424</td>
      <td>0.000413</td>
      <td>0.000430</td>
      <td>0.000414</td>
      <td>0.000451</td>
      <td>0.000435</td>
    </tr>
    <tr>
      <th>6640</th>
      <td>4000.1850</td>
      <td>1.665731e-03</td>
      <td>1.684217e-03</td>
      <td>1.704210e-03</td>
      <td>9.846366e-04</td>
      <td>4.392129e-04</td>
      <td>3.268367e-04</td>
      <td>0.000441</td>
      <td>5.654779e-04</td>
      <td>1.681778e-03</td>
      <td>...</td>
      <td>0.001176</td>
      <td>0.001227</td>
      <td>0.001154</td>
      <td>0.001179</td>
      <td>0.001158</td>
      <td>0.001152</td>
      <td>0.001200</td>
      <td>0.001149</td>
      <td>0.001240</td>
      <td>0.001204</td>
    </tr>
  </tbody>
</table>
<p>6641 rows √ó 493 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavelength</span> <span class="o">=</span> <span class="n">DR2_Allscan_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavelength</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0        799.8442
1        800.3264
2        800.8085
3        801.2906
4        801.7727
          ...    
6636    3998.2570
6637    3998.7390
6638    3999.2210
6639    3999.7030
6640    4000.1850
Name: Wavenumber, Length: 6641, dtype: float64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="function-definition">
<h2>2.2  Function definition<a class="headerlink" href="#function-definition" title="Permalink to this headline">¬∂</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">substraction</span><span class="p">(</span><span class="n">index1</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">index2</span><span class="p">):</span>
    
<span class="c1">#    exp_date1 = input(&#39;date of experiment 1 (format YYYY_MM_DD) = &#39;)</span>
<span class="c1">#    index1 = int(input(&#39;index 1 = &#39;))</span>
<span class="c1">#    exp_date2 = input(&#39;date of experiment 2 (format YYYY_MM_DD) = &#39;)</span>
<span class="c1">#    index2 = int(input(&#39;index 2 = &#39;))</span>
    
    <span class="n">data1</span> <span class="o">=</span> <span class="n">DR2_Allscan_df</span>
    <span class="c1">#data2 = pd.read_csv(&#39;D:\PhD-WS\Projects\PAC\{}}\DATA\{0}\Data\DR2_{}_All_data.csv&#39;.format(XP,date))</span>

    <span class="n">data1</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
    <span class="c1">#data2 = data2.T.iloc[1:].T</span>
    
    
<span class="c1">#Scan 1    </span>
    
    <span class="n">list_name1</span> <span class="o">=</span>  <span class="nb">list</span><span class="p">(</span><span class="n">data1</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    
    <span class="n">scan_place1</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_name1</span><span class="p">)):</span>
                
        <span class="n">name_corr</span> <span class="o">=</span> <span class="n">list_name1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">name_corr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">index1</span><span class="p">):</span>
    
            <span class="n">scan_place1</span> <span class="o">=</span> <span class="n">i</span>
    
    <span class="n">scan1</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">scan_place1</span><span class="p">]</span>
    
<span class="c1">#Scan 2    </span>
    
    <span class="n">list_name2</span> <span class="o">=</span>  <span class="nb">list</span><span class="p">(</span><span class="n">data1</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    
    <span class="n">scan_place2</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_name2</span><span class="p">)):</span>
        
        <span class="n">name_corr</span> <span class="o">=</span> <span class="n">list_name2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">name_corr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">index2</span><span class="p">):</span>
    
            <span class="n">scan_place2</span> <span class="o">=</span> <span class="n">i</span>
    
    <span class="n">scan2</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">scan_place2</span><span class="p">]</span>
    
    <span class="n">sub_scan</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">scan1</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">iscan</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_scan</span><span class="p">)):</span>
        
        <span class="n">sub_scan</span><span class="p">[</span><span class="n">iscan</span><span class="p">]</span> <span class="o">=</span> <span class="n">scan2</span><span class="p">[</span><span class="n">iscan</span><span class="p">]</span> <span class="o">-</span> <span class="n">scan1</span><span class="p">[</span><span class="n">iscan</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">sub_scan</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id2">
<h2>2.3 Plotting<a class="headerlink" href="#id2" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="all-range">
<h3>All Range<a class="headerlink" href="#all-range" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#date = &quot;2020_09_15&quot;</span>

<span class="n">data1</span> <span class="o">=</span> <span class="n">DR2_Allscan_df</span>


<span class="n">data1</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
    
<span class="c1">#data = data.T.iloc[1:].T</span>
<span class="c1">#data = data1</span>


<span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data1</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>
<span class="c1">#print(data1)</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>


<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavenumber (cm-1)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Absorbance&#39;</span><span class="p">)</span>
<span class="c1">#ax.set_zlabel(&#39;Absorbance&#39;)</span>

<span class="n">data_sub</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">data_sub_2</span> <span class="o">=</span><span class="p">[]</span>

<span class="k">for</span> <span class="n">iscan</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nscan</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">iscan</span> <span class="o">=</span> <span class="n">iscan</span><span class="o">+</span><span class="mi">1</span>
     
    <span class="n">sub_scan</span> <span class="o">=</span> <span class="n">substraction</span><span class="p">(</span><span class="n">iscan</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">iscan</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Wavenumber&#39;</span><span class="p">:</span> <span class="n">wavelength</span><span class="p">,</span> <span class="s2">&quot;ASW_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="p">)</span> <span class="o">+</span><span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span> <span class="n">sub_scan</span><span class="p">})</span>
    
    <span class="c1">#df.to_csv(&#39;D:\PhD-WS\Projects\PAC\XP_1-1\DATA\{}\Data\DP1\DP1_{}_sub-scan_{}.csv&#39;.format(date,date, iscan))</span>
    
    <span class="c1">#data_int.append(df)</span>
    
    
    <span class="n">data_sub</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        
        <span class="p">{</span>
            

            <span class="s1">&#39;Name&#39;</span> <span class="p">:</span> <span class="s2">&quot;ASW_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="p">)</span> <span class="o">+</span><span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;Wavenumber&#39;</span> <span class="p">:</span> <span class="n">wavelength</span><span class="p">,</span>
            <span class="s1">&#39;sub_scan&#39;</span> <span class="p">:</span> <span class="n">sub_scan</span><span class="p">,</span>

        <span class="p">})</span> 
    
    <span class="n">data_sub_2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    


    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">sub_scan</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">iscan</span><span class="o">/</span><span class="n">nscan</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;scan</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="p">)))</span>
       

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_Substraction scans&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="p">),</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3900</span><span class="p">,</span><span class="mi">2900</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">3800</span><span class="p">,</span><span class="mi">2900</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>492
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\vmrd3\Anaconda3\lib\site-packages\IPython\core\pylabtools.py:132: UserWarning: Creating legend with loc=&quot;best&quot; can be slow with large amounts of data.
  fig.canvas.print_figure(bytes_io, **kw)
</pre></div>
</div>
<img alt="../../_images/Data_Processing_Full_07-22_114_2.png" src="../../_images/Data_Processing_Full_07-22_114_2.png" />
</div>
</div>
</div>
<div class="section" id="id3">
<h3>Range 1<a class="headerlink" href="#id3" title="Permalink to this headline">¬∂</a></h3>
<p>Insert condition to use only items present in range 1</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#date = &quot;2020_09_15&quot;</span>

<span class="n">data1</span> <span class="o">=</span> <span class="n">DR2_Allscan_df</span>


<span class="n">data1</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
    
<span class="c1">#data = data.T.iloc[1:].T</span>
<span class="c1">#data = data1</span>


<span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data1</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>
<span class="c1">#print(data1)</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>


<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavenumber (cm-1)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Absorbance&#39;</span><span class="p">)</span>
<span class="c1">#ax.set_zlabel(&#39;Absorbance&#39;)</span>

<span class="n">data_sub</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">data_sub_2</span> <span class="o">=</span><span class="p">[]</span>

<span class="k">for</span> <span class="n">iscan</span> <span class="ow">in</span> <span class="n">file_number1</span><span class="p">:</span>
    
    <span class="n">iscan</span> <span class="o">=</span> <span class="n">iscan</span><span class="o">+</span><span class="mi">1</span>
     
    <span class="n">sub_scan</span> <span class="o">=</span> <span class="n">substraction</span><span class="p">(</span><span class="n">iscan</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">iscan</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Wavenumber&#39;</span><span class="p">:</span> <span class="n">wavelength</span><span class="p">,</span> <span class="s2">&quot;ASW_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="p">)</span> <span class="o">+</span><span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span> <span class="n">sub_scan</span><span class="p">})</span>
    
    <span class="c1">#df.to_csv(&#39;D:\PhD-WS\Projects\PAC\XP_1-1\DATA\{}\Data\DP1\DP1_{}_sub-scan_{}.csv&#39;.format(date,date, iscan))</span>
    
    <span class="c1">#data_int.append(df)</span>
    
    
    <span class="n">data_sub</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        
        <span class="p">{</span>
            

            <span class="s1">&#39;Name&#39;</span> <span class="p">:</span> <span class="s2">&quot;ASW_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="p">)</span> <span class="o">+</span><span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;Wavenumber&#39;</span> <span class="p">:</span> <span class="n">wavelength</span><span class="p">,</span>
            <span class="s1">&#39;sub_scan&#39;</span> <span class="p">:</span> <span class="n">sub_scan</span><span class="p">,</span>

        <span class="p">})</span> 
    
    <span class="n">data_sub_2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    


    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">sub_scan</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">iscan</span><span class="o">/</span><span class="n">nscan</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;scan</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="p">)))</span>
       

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_Substraction scans&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="p">),</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3900</span><span class="p">,</span><span class="mi">2900</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">3800</span><span class="p">,</span><span class="mi">2900</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>492
</pre></div>
</div>
<img alt="../../_images/Data_Processing_Full_07-22_117_1.png" src="../../_images/Data_Processing_Full_07-22_117_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Wavenumber</th>
      <th>ASW_2021_05_24_8-9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>799.8442</td>
      <td>-1.134107e-04</td>
    </tr>
    <tr>
      <th>1</th>
      <td>800.3264</td>
      <td>1.517846e-03</td>
    </tr>
    <tr>
      <th>2</th>
      <td>800.8085</td>
      <td>3.213542e-03</td>
    </tr>
    <tr>
      <th>3</th>
      <td>801.2906</td>
      <td>4.628880e-04</td>
    </tr>
    <tr>
      <th>4</th>
      <td>801.7727</td>
      <td>-1.269106e-03</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6636</th>
      <td>3998.2570</td>
      <td>2.205339e-04</td>
    </tr>
    <tr>
      <th>6637</th>
      <td>3998.7390</td>
      <td>1.124161e-04</td>
    </tr>
    <tr>
      <th>6638</th>
      <td>3999.2210</td>
      <td>-4.336809e-19</td>
    </tr>
    <tr>
      <th>6639</th>
      <td>3999.7030</td>
      <td>5.777508e-04</td>
    </tr>
    <tr>
      <th>6640</th>
      <td>4000.1850</td>
      <td>1.116301e-03</td>
    </tr>
  </tbody>
</table>
<p>6641 rows √ó 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_sub</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;Name&#39;: &#39;ASW_2021_05_24_2-3&#39;,
  &#39;Wavenumber&#39;: 0        799.8442
  1        800.3264
  2        800.8085
  3        801.2906
  4        801.7727
            ...    
  6636    3998.2570
  6637    3998.7390
  6638    3999.2210
  6639    3999.7030
  6640    4000.1850
  Name: Wavenumber, Length: 6641, dtype: float64,
  &#39;sub_scan&#39;: array([1.54380954e-03, 1.19808933e-03, 7.30539117e-04, ...,
         2.16840434e-19, 1.84575997e-05, 1.99932794e-05])},
 {&#39;Name&#39;: &#39;ASW_2021_05_24_3-4&#39;,
  &#39;Wavenumber&#39;: 0        799.8442
  1        800.3264
  2        800.8085
  3        801.2906
  4        801.7727
            ...    
  6636    3998.2570
  6637    3998.7390
  6638    3999.2210
  6639    3999.7030
  6640    4000.1850
  Name: Wavenumber, Length: 6641, dtype: float64,
  &#39;sub_scan&#39;: array([ 1.00171360e-02,  2.07651706e-03, -6.24288189e-03, ...,
         -3.25260652e-18, -3.91667293e-04, -7.19573885e-04])},
 {&#39;Name&#39;: &#39;ASW_2021_05_24_4-5&#39;,
  &#39;Wavenumber&#39;: 0        799.8442
  1        800.3264
  2        800.8085
  3        801.2906
  4        801.7727
            ...    
  6636    3998.2570
  6637    3998.7390
  6638    3999.2210
  6639    3999.7030
  6640    4000.1850
  Name: Wavenumber, Length: 6641, dtype: float64,
  &#39;sub_scan&#39;: array([ 2.49147249e-03,  9.38463666e-04, -3.68855160e-04, ...,
          2.16840434e-18, -3.04826309e-04, -5.45423718e-04])},
 {&#39;Name&#39;: &#39;ASW_2021_05_24_5-6&#39;,
  &#39;Wavenumber&#39;: 0        799.8442
  1        800.3264
  2        800.8085
  3        801.2906
  4        801.7727
            ...    
  6636    3998.2570
  6637    3998.7390
  6638    3999.2210
  6639    3999.7030
  6640    4000.1850
  Name: Wavenumber, Length: 6641, dtype: float64,
  &#39;sub_scan&#39;: array([ 1.18793290e-04,  1.10489031e-03,  1.41374733e-03, ...,
          4.77048956e-18, -4.64270998e-05, -1.12376200e-04])},
 {&#39;Name&#39;: &#39;ASW_2021_05_24_6-7&#39;,
  &#39;Wavenumber&#39;: 0        799.8442
  1        800.3264
  2        800.8085
  3        801.2906
  4        801.7727
            ...    
  6636    3998.2570
  6637    3998.7390
  6638    3999.2210
  6639    3999.7030
  6640    4000.1850
  Name: Wavenumber, Length: 6641, dtype: float64,
  &#39;sub_scan&#39;: array([-5.07472153e-04, -3.85217634e-04,  1.70768859e-05, ...,
          1.20905107e-04,  1.07518578e-04,  1.13815049e-04])},
 {&#39;Name&#39;: &#39;ASW_2021_05_24_7-8&#39;,
  &#39;Wavenumber&#39;: 0        799.8442
  1        800.3264
  2        800.8085
  3        801.2906
  4        801.7727
            ...    
  6636    3998.2570
  6637    3998.7390
  6638    3999.2210
  6639    3999.7030
  6640    4000.1850
  Name: Wavenumber, Length: 6641, dtype: float64,
  &#39;sub_scan&#39;: array([-2.01059091e-03,  2.82954489e-03,  7.26855070e-03, ...,
         -1.20905107e-04,  7.30345003e-05,  1.24826107e-04])},
 {&#39;Name&#39;: &#39;ASW_2021_05_24_8-9&#39;,
  &#39;Wavenumber&#39;: 0        799.8442
  1        800.3264
  2        800.8085
  3        801.2906
  4        801.7727
            ...    
  6636    3998.2570
  6637    3998.7390
  6638    3999.2210
  6639    3999.7030
  6640    4000.1850
  Name: Wavenumber, Length: 6641, dtype: float64,
  &#39;sub_scan&#39;: array([-1.13410710e-04,  1.51784552e-03,  3.21354176e-03, ...,
         -4.33680869e-19,  5.77750781e-04,  1.11630056e-03])}]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_sub_2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[      Wavenumber  ASW_2021_05_24_2-3
 0       799.8442        1.543810e-03
 1       800.3264        1.198089e-03
 2       800.8085        7.305391e-04
 3       801.2906        1.361979e-03
 4       801.7727        1.500349e-03
 ...          ...                 ...
 6636   3998.2570       -2.641260e-05
 6637   3998.7390       -4.021780e-05
 6638   3999.2210        2.168404e-19
 6639   3999.7030        1.845760e-05
 6640   4000.1850        1.999328e-05
 
 [6641 rows x 2 columns],
       Wavenumber  ASW_2021_05_24_3-4
 0       799.8442        1.001714e-02
 1       800.3264        2.076517e-03
 2       800.8085       -6.242882e-03
 3       801.2906       -5.379231e-03
 4       801.7727       -1.412898e-04
 ...          ...                 ...
 6636   3998.2570       -1.382505e-04
 6637   3998.7390       -6.914371e-05
 6638   3999.2210       -3.252607e-18
 6639   3999.7030       -3.916673e-04
 6640   4000.1850       -7.195739e-04
 
 [6641 rows x 2 columns],
       Wavenumber  ASW_2021_05_24_4-5
 0       799.8442        2.491472e-03
 1       800.3264        9.384637e-04
 2       800.8085       -3.688552e-04
 3       801.2906       -1.301614e-03
 4       801.7727       -7.656528e-04
 ...          ...                 ...
 6636   3998.2570       -1.452057e-04
 6637   3998.7390       -9.551389e-05
 6638   3999.2210        2.168404e-18
 6639   3999.7030       -3.048263e-04
 6640   4000.1850       -5.454237e-04
 
 [6641 rows x 2 columns],
       Wavenumber  ASW_2021_05_24_5-6
 0       799.8442        1.187933e-04
 1       800.3264        1.104890e-03
 2       800.8085        1.413747e-03
 3       801.2906        1.114804e-03
 4       801.7727        9.323114e-04
 ...          ...                 ...
 6636   3998.2570       -3.948800e-06
 6637   3998.7390        4.968100e-06
 6638   3999.2210        4.770490e-18
 6639   3999.7030       -4.642710e-05
 6640   4000.1850       -1.123762e-04
 
 [6641 rows x 2 columns],
       Wavenumber  ASW_2021_05_24_6-7
 0       799.8442           -0.000507
 1       800.3264           -0.000385
 2       800.8085            0.000017
 3       801.2906            0.000531
 4       801.7727            0.000534
 ...          ...                 ...
 6636   3998.2570            0.000071
 6637   3998.7390            0.000099
 6638   3999.2210            0.000121
 6639   3999.7030            0.000108
 6640   4000.1850            0.000114
 
 [6641 rows x 2 columns],
       Wavenumber  ASW_2021_05_24_7-8
 0       799.8442           -0.002011
 1       800.3264            0.002830
 2       800.8085            0.007269
 3       801.2906            0.004294
 4       801.7727            0.000301
 ...          ...                 ...
 6636   3998.2570           -0.000042
 6637   3998.7390           -0.000095
 6638   3999.2210           -0.000121
 6639   3999.7030            0.000073
 6640   4000.1850            0.000125
 
 [6641 rows x 2 columns],
       Wavenumber  ASW_2021_05_24_8-9
 0       799.8442       -1.134107e-04
 1       800.3264        1.517846e-03
 2       800.8085        3.213542e-03
 3       801.2906        4.628880e-04
 4       801.7727       -1.269106e-03
 ...          ...                 ...
 6636   3998.2570        2.205339e-04
 6637   3998.7390        1.124161e-04
 6638   3999.2210       -4.336809e-19
 6639   3999.7030        5.777508e-04
 6640   4000.1850        1.116301e-03
 
 [6641 rows x 2 columns]]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id4">
<h3>Range 2<a class="headerlink" href="#id4" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#date = &quot;2020_09_15&quot;</span>

<span class="n">data1</span> <span class="o">=</span> <span class="n">DR2_Allscan_df</span>


<span class="n">data1</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
    
<span class="c1">#data = data.T.iloc[1:].T</span>
<span class="c1">#data = data1</span>


<span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data1</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>
<span class="c1">#print(data1)</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>


<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavenumber (cm-1)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Absorbance&#39;</span><span class="p">)</span>
<span class="c1">#ax.set_zlabel(&#39;Absorbance&#39;)</span>

<span class="n">data_sub</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">data_sub_2</span> <span class="o">=</span><span class="p">[]</span>

<span class="k">for</span> <span class="n">iscan</span> <span class="ow">in</span> <span class="n">file_number2</span><span class="p">:</span>
    
    <span class="n">iscan</span> <span class="o">=</span> <span class="n">iscan</span><span class="o">+</span><span class="mi">1</span>
     
    <span class="n">sub_scan</span> <span class="o">=</span> <span class="n">substraction</span><span class="p">(</span><span class="n">iscan</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">iscan</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Wavenumber&#39;</span><span class="p">:</span> <span class="n">wavelength</span><span class="p">,</span> <span class="s2">&quot;ASW_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="p">)</span> <span class="o">+</span><span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span> <span class="n">sub_scan</span><span class="p">})</span>
    
    <span class="c1">#df.to_csv(&#39;D:\PhD-WS\Projects\PAC\XP_1-1\DATA\{}\Data\DP1\DP1_{}_sub-scan_{}.csv&#39;.format(date,date, iscan))</span>
    
    <span class="c1">#data_int.append(df)</span>
    
    
    <span class="n">data_sub</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        
        <span class="p">{</span>
            

            <span class="s1">&#39;Name&#39;</span> <span class="p">:</span> <span class="s2">&quot;ASW_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="p">)</span> <span class="o">+</span><span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;Wavenumber&#39;</span> <span class="p">:</span> <span class="n">wavelength</span><span class="p">,</span>
            <span class="s1">&#39;sub_scan&#39;</span> <span class="p">:</span> <span class="n">sub_scan</span><span class="p">,</span>

        <span class="p">})</span> 
    
    <span class="n">data_sub_2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    


    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">sub_scan</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">iscan</span><span class="o">/</span><span class="n">nscan</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;scan</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="p">)))</span>
       

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_Substraction scans&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="p">),</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3900</span><span class="p">,</span><span class="mi">2900</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">3800</span><span class="p">,</span><span class="mi">2900</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>31
</pre></div>
</div>
<img alt="../../_images/Data_Processing_Full_07-22_122_1.png" src="../../_images/Data_Processing_Full_07-22_122_1.png" />
</div>
</div>
</div>
<div class="section" id="id5">
<h3>Range 3<a class="headerlink" href="#id5" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#date = &quot;2020_09_15&quot;</span>

<span class="n">data1</span> <span class="o">=</span> <span class="n">DR2_Allscan_df</span>


<span class="n">data1</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
    
<span class="c1">#data = data.T.iloc[1:].T</span>
<span class="c1">#data = data1</span>


<span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data1</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>
<span class="c1">#print(data1)</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>


<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavenumber (cm-1)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Absorbance&#39;</span><span class="p">)</span>
<span class="c1">#ax.set_zlabel(&#39;Absorbance&#39;)</span>

<span class="n">data_sub</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">data_sub_2</span> <span class="o">=</span><span class="p">[]</span>

<span class="k">for</span> <span class="n">iscan</span> <span class="ow">in</span> <span class="n">file_number3</span><span class="p">:</span>
    
    <span class="n">iscan</span> <span class="o">=</span> <span class="n">iscan</span><span class="o">+</span><span class="mi">1</span>
     
    <span class="n">sub_scan</span> <span class="o">=</span> <span class="n">substraction</span><span class="p">(</span><span class="n">iscan</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">iscan</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Wavenumber&#39;</span><span class="p">:</span> <span class="n">wavelength</span><span class="p">,</span> <span class="s2">&quot;ASW_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="p">)</span> <span class="o">+</span><span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span> <span class="n">sub_scan</span><span class="p">})</span>
    
    <span class="c1">#df.to_csv(&#39;D:\PhD-WS\Projects\PAC\XP_1-1\DATA\{}\Data\DP1\DP1_{}_sub-scan_{}.csv&#39;.format(date,date, iscan))</span>
    
    <span class="c1">#data_int.append(df)</span>
    
    
    <span class="n">data_sub</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        
        <span class="p">{</span>
            

            <span class="s1">&#39;Name&#39;</span> <span class="p">:</span> <span class="s2">&quot;ASW_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="p">)</span> <span class="o">+</span><span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;Wavenumber&#39;</span> <span class="p">:</span> <span class="n">wavelength</span><span class="p">,</span>
            <span class="s1">&#39;sub_scan&#39;</span> <span class="p">:</span> <span class="n">sub_scan</span><span class="p">,</span>

        <span class="p">})</span> 
    
    <span class="n">data_sub_2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    


    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">sub_scan</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">iscan</span><span class="o">/</span><span class="n">nscan</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;scan</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="p">)))</span>
       

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_Substraction scans&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="p">),</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3900</span><span class="p">,</span><span class="mi">2900</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">3800</span><span class="p">,</span><span class="mi">2900</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.0075</span><span class="p">,</span><span class="mf">0.0075</span><span class="p">])</span>
<span class="c1">#plt.legend()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>492
</pre></div>
</div>
<img alt="../../_images/Data_Processing_Full_07-22_124_1.png" src="../../_images/Data_Processing_Full_07-22_124_1.png" />
</div>
</div>
</div>
<div class="section" id="id6">
<h3>Range 4<a class="headerlink" href="#id6" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#date = &quot;2020_09_15&quot;</span>

<span class="n">data1</span> <span class="o">=</span> <span class="n">DR2_Allscan_df</span>


<span class="n">data1</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
    
<span class="c1">#data = data.T.iloc[1:].T</span>
<span class="c1">#data = data1</span>


<span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data1</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>
<span class="c1">#print(data1)</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>


<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavenumber (cm-1)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Absorbance&#39;</span><span class="p">)</span>
<span class="c1">#ax.set_zlabel(&#39;Absorbance&#39;)</span>

<span class="n">data_sub</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">data_sub_2</span> <span class="o">=</span><span class="p">[]</span>

<span class="k">for</span> <span class="n">iscan</span> <span class="ow">in</span> <span class="n">file_number4</span><span class="p">:</span>
    
    <span class="n">iscan</span> <span class="o">=</span> <span class="n">iscan</span><span class="o">+</span><span class="mi">1</span>
     
    <span class="n">sub_scan</span> <span class="o">=</span> <span class="n">substraction</span><span class="p">(</span><span class="n">iscan</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">iscan</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Wavenumber&#39;</span><span class="p">:</span> <span class="n">wavelength</span><span class="p">,</span> <span class="s2">&quot;ASW_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="p">)</span> <span class="o">+</span><span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span> <span class="n">sub_scan</span><span class="p">})</span>
    
    <span class="c1">#df.to_csv(&#39;D:\PhD-WS\Projects\PAC\XP_1-1\DATA\{}\Data\DP1\DP1_{}_sub-scan_{}.csv&#39;.format(date,date, iscan))</span>
    
    <span class="c1">#data_int.append(df)</span>
    
    
    <span class="n">data_sub</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        
        <span class="p">{</span>
            

            <span class="s1">&#39;Name&#39;</span> <span class="p">:</span> <span class="s2">&quot;ASW_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="p">)</span> <span class="o">+</span><span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;Wavenumber&#39;</span> <span class="p">:</span> <span class="n">wavelength</span><span class="p">,</span>
            <span class="s1">&#39;sub_scan&#39;</span> <span class="p">:</span> <span class="n">sub_scan</span><span class="p">,</span>

        <span class="p">})</span> 
    
    <span class="n">data_sub_2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    


    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">sub_scan</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">iscan</span><span class="o">/</span><span class="n">nscan</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;scan</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">iscan</span><span class="p">)))</span>
       

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_Substraction scans&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="p">),</span> <span class="n">pad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3900</span><span class="p">,</span><span class="mi">2900</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">3800</span><span class="p">,</span><span class="mi">2900</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>492
</pre></div>
</div>
<img alt="../../_images/Data_Processing_Full_07-22_126_1.png" src="../../_images/Data_Processing_Full_07-22_126_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="preliminary-analysis">
<h2>Preliminary analysis<a class="headerlink" href="#preliminary-analysis" title="Permalink to this headline">¬∂</a></h2>
<p>Purpose here would be (for the different physical processes that the ice undergo upon annealing) to investigate the different contributions lost and gain from the substraction spectra</p>
<p>This will subsequently be used as initial guesses for the gaussian fit of the whole samples</p>
<p>An intermediate gaussian fitting routine could be implemented here with the substraction spectra</p>
</div>
<div class="section" id="export-data-sub-as-csv">
<h2>Export Data Sub as csv<a class="headerlink" href="#export-data-sub-as-csv" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="concatenation">
<h3>Concatenation<a class="headerlink" href="#concatenation" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_sub</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_sub_2_df</span>  <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">left</span><span class="p">,</span><span class="n">right</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span><span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Wavenumber&#39;</span><span class="p">],</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">),</span> <span class="n">data_sub_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="export-as-csv">
<h2>Export as csv<a class="headerlink" href="#export-as-csv" title="Permalink to this headline">¬∂</a></h2>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="span-style-background-yellow-color-green-text-dp3-gaussian-fitting-span">
<h1><span style='background :yellow' > <span class="math notranslate nohighlight">\(\color{green}{\text{DP3 : Gaussian Fitting}}\)</span> </span><a class="headerlink" href="#span-style-background-yellow-color-green-text-dp3-gaussian-fitting-span" title="Permalink to this headline">¬∂</a></h1>
<p><a class="reference external" href="https://lmfit.github.io/lmfit-py/builtin_models.html#example-3-fitting-multiple-peaks-and-using-prefixes">Lmfit web-site - Example</a></p>
<div class="section" id="what-data">
<h2>What Data ?<a class="headerlink" href="#what-data" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="substraction-scan">
<h3>Substraction scan<a class="headerlink" href="#substraction-scan" title="Permalink to this headline">¬∂</a></h3>
<p>Later</p>
</div>
<div class="section" id="oh-stretch">
<h3>OH Stretch<a class="headerlink" href="#oh-stretch" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DR2_A_df</span> <span class="o">=</span> <span class="n">DR2_df</span><span class="p">[</span><span class="mi">4149</span><span class="p">:</span><span class="mi">6639</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DR2_A_df</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="gaussian-fit-1">
<h2>Gaussian fit 1<a class="headerlink" href="#gaussian-fit-1" title="Permalink to this headline">¬∂</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">DR2_A_df</span><span class="p">[</span><span class="s2">&quot;Wavenumber&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">DR2_A_df</span><span class="p">[</span><span class="s2">&quot;ASW_2020_09_16_1&quot;</span><span class="p">]</span>

<span class="n">pars</span> <span class="o">=</span> <span class="n">exp_mod</span><span class="o">.</span><span class="n">guess</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>

<span class="n">gauss1</span> <span class="o">=</span> <span class="n">GaussianModel</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;g1_&#39;</span><span class="p">)</span>
<span class="n">pars</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">gauss1</span><span class="o">.</span><span class="n">make_params</span><span class="p">())</span>

<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;g1_center&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">3400</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">3300</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">3500</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;g1_sigma&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;g1_amplitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">gauss2</span> <span class="o">=</span> <span class="n">GaussianModel</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;g2_&#39;</span><span class="p">)</span>
<span class="n">pars</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">gauss2</span><span class="o">.</span><span class="n">make_params</span><span class="p">())</span>

<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;g2_center&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">3260</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">3200</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">3300</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;g2_sigma&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">&#39;g2_amplitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">mod</span> <span class="o">=</span> <span class="n">gauss1</span> <span class="o">+</span> <span class="n">gauss2</span> 

<span class="n">init</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pars</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">fit_report</span><span class="p">(</span><span class="n">min_correl</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">12.8</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">init</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;initial fit&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">out</span><span class="o">.</span><span class="n">best_fit</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;best fit&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

<span class="n">comps</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">eval_components</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">comps</span><span class="p">[</span><span class="s1">&#39;g1_&#39;</span><span class="p">],</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gaussian component 1&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">comps</span><span class="p">[</span><span class="s1">&#39;g2_&#39;</span><span class="p">],</span> <span class="s1">&#39;m--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gaussian component 2&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># &lt;end examples/doc_builtinmodels_nistgauss.py&gt;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">42</span><span class="o">-</span><span class="mi">82</span><span class="n">c111bdc377</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">x</span> <span class="o">=</span> <span class="n">DR2_A_df</span><span class="p">[</span><span class="s2">&quot;Wavenumber&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">y</span> <span class="o">=</span> <span class="n">DR2_A_df</span><span class="p">[</span><span class="s2">&quot;ASW_2020_09_16_1&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> 
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">pars</span> <span class="o">=</span> <span class="n">exp_mod</span><span class="o">.</span><span class="n">guess</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> 

<span class="ne">NameError</span>: name &#39;DR2_A_df&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Notes\Script_Copie"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Vincent Deguin<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>