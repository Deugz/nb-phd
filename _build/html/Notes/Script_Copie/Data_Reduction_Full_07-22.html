
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Intro &#8212; PhD</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom_style.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/.ipynb_checkpoints/custom_style-checkpoint.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/assets/Calendar/public/css/calendar.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/assets/GC/GC6-08-2022_files/stylesheet.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/assets/Sample_list/Sample_list_files/stylesheet.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/assets/Picture_display.js"></script>
    <script src="../../_static/assets/.ipynb_checkpoints/Picture_display-checkpoint.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "https://github.com/Deugz/nb-phd");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "üí¨ comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://deugz.github.io/nb-phd/_build/html/Notes/Script_Copie/Data_Reduction_Full_07-22.html" />
    <link rel="shortcut icon" href="../../_static/OU_Logo.svg"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-EQV9FEH9JF"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-EQV9FEH9JF');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/OU_logo.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">PhD</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Thesis_JB/Chapter1/Chapter1.html">
   ‚úè
   <strong>
    Chapter 1.A
   </strong>
   Ô∏è
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Science_Notes/Science.html">
   Science
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Science_Notes/Water.html">
     Water Ice
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Science_Notes/Space.html">
     in Space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Science_Notes/Amorphous.html">
     is Amorphous
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Science_Notes/Mixed.html">
     and Mixed
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Science_Notes/Questions.html">
     Questions ?
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Methods
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Thesis_JB/Chapter2/Chapter2.html">
   ‚úè
   <strong>
    Chapter 2.A
   </strong>
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Method_Notes/Method.html">
   Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Method_Notes/PAC.html">
     PAC
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Method_Notes/Spectroscopy.html">
     IR Spectroscopy
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Data_Notes/Data_Main.html">
   Management plan
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/Reduction/Data_Reduction.html">
     Reduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/Processing/Data_Processing_Main.html">
     Processing
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../Data_Notes/Analysis/Data_Analysis.html">
     Analysis
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../Data_Notes/Analysis/Control_Experiments/Control_experiments.html">
       Control experiments
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Data_Notes/Analysis/Ethane_Samples/Ethane_analysis.html">
       Ethane analysis
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Data_Notes/Analysis/2OK_ASW.html">
       ASW 20K Deposition
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Data_Notes/XP-1_1/XP-1_1.html">
   XP 1-1
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/XP-1_1/2020_09_15/2020_09_15.html">
     2020/09/15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/XP-1_1/2020_09_16/2020_09_16.html">
     2020/09/16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/XP-1_1/2020_09_17/2020_09_17.html">
     2020/09/17
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/XP-1_1/2020_09_21/2020_09_21.html">
     2020/09/21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/XP-1_1/2020_09_24/2020_09_24.html">
     2020/09/24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/XP-1_1/2020_09_28/2020_09_28.html">
     2020/09/28
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/XP-1_1/2020_10_14/2020_10_14.html">
     2020/10/14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/XP-1_1/2020_10_15/2020_10_15.html">
     2020/10/15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/XP-1_1/2020_10_22/2020_10_22.html">
     2020/10/22
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/XP-1_1/2020_10_30/2020_10_30.html">
     2020/10/30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/XP-1_1/2020_11_16/2020_11_16.html">
     2020/11/16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/XP-1_1/2020_11_19/2020_11_19.html">
     2020/11/19
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/XP-1_1/2020_11_23/2020_11_23.html">
     2020/11/23
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/XP-1_1/2020_11_26/2020_11_26.html">
     2020/11/26
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/XP-1_1/2020_11_30/2020_11_30.html">
     2020/11/30
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/XP-1_1/2021_01_21/2021_01_21.html">
     2021/01/21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/XP-1_1/2021_01_25/2021_01_25.html">
     2021/01/25
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/XP-1_1/2021_02_09/2021_02_09.html">
     2021/02/09
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/XP-1_1/2021_04_26/2021_04_26.html">
     2021/04/26
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/XP-1_1/2021_05_13/2021_05_13.html">
     2021/05/13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/XP-1_1/2021_05_24/2021_05_24.html">
     2021/05/24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Data_Notes/XP-1_1/2021_07_13/2021_07_13.html">
     2021/07/13
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Data_Notes/XP-1_2/XP-1_2.html">
   XP 1-2
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="simple">
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Results
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Thesis_JB/Chapter3/Chapter3.html">
   ‚úè
   <strong>
    Chapter 3
   </strong>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Thesis_JB/Chapter4/Chapter4.html">
   ‚úè
   <strong>
    Chapter 4
   </strong>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Thesis_JB/Chapter5/Chapter5.html">
   ‚úè
   <strong>
    Chapter 5
   </strong>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Discussion
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Thesis_JB/Discussion.html">
   ‚úè
   <strong>
    Discussion
   </strong>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Conclusion
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Thesis_JB/Chapter8/Chapter8.html">
   ‚úè
   <strong>
    Conclusion
   </strong>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Bibliography
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Thesis_JB/Biblio/Thesis_Bibliography/bibliography.html">
   Bibliography
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Dissemination
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Dissemination/Conference.html">
   Conferences
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="simple">
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Dissemination/Outreach.html">
   Outreach
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Dissemination/Outreach/Outreach1.html">
     OUtreach
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  My Corner
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../My_Space/Productivity_Dashboard.html">
   Productivity
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../My_Space/Organisation.html">
   Notes
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../My_Space/Daily_Log.html">
     Daily Log
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../My_Space/Monthly_Dashbord.html">
     Monthly Dashboard
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../My_Space/Archives/Archive_Main.html">
     Archives
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Thesis_JB/Biblio/Litterature_Review.html">
   Litterature review
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendix
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../My_Space/How_do_I.html">
   How do I use this Book
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../My_Space/Style_guide.html">
   Style Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../My_Space/Help.html">
   Help
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/Notes/Script_Copie/Data_Reduction_Full_07-22.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/Deugz/nb-phd"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/Deugz/nb-phd/issues/new?title=Issue%20on%20page%20%2FNotes/Script_Copie/Data_Reduction_Full_07-22.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/Deugz/nb-phd/edit/main/_build/html/Notes/Script_Copie/Data_Reduction_Full_07-22.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/Deugz/nb-phd/main?urlpath=tree/_build/html/Notes/Script_Copie/Data_Reduction_Full_07-22.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Intro
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#workflow">
     Workflow
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#libraries">
     Libraries
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-raw-data">
     The RAW Data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#input-parameters">
     Input parameters
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#date-today">
       Date (today)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#experiment">
       Experiment
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#temperature-ramp">
       Temperature Ramp
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#append-df-to-csv">
         Append df to csv
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#sanity-check">
         Sanity Check
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#t-ramp-for-reduction">
       T ramp for Reduction
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#ramp">
         Ramp
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#isotherm">
         Isotherm
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-background-yellow-color-green-text-dr1-sanity-check-and-merging-span">
   <span style="background :yellow">
    <span class="math notranslate nohighlight">
     \(\color{green}{\text{DR1 : Sanity Check and Merging}}\)
    </span>
   </span>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-import-and-read-the-data-u">
     <u>
      Import and read the data
     </u>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-sanity-check-u">
     <u>
      Sanity Check
     </u>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-concatenation-u">
     <u>
      Concatenation
     </u>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-plotting-u">
     <u>
      Plotting
     </u>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-chop-the-data-u">
     <u>
      Chop the data
     </u>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#oh-stretch">
       1.5.1 OH Stretch
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#combination-bands">
       1.5.2 Combination bands
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bending-modes">
       1.5.3 bending modes
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-background-yellow-color-green-text-dr2-baseline-correction-span">
   <span style="background :yellow">
    <span class="math notranslate nohighlight">
     \(\color{green}{\text{DR2 : Baseline Correction}}\)
    </span>
   </span>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-background-function-definition-u">
     <u>
      Background function definition
     </u>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#minimum-single-point-within-a-range">
       Minimum (single point) within a range
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#minimum-within-a-range-smoothing">
       Minimum within a range + Smoothing
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#minimum-using-single-value-same-for-all-scans">
       Minimum Using single value (same for all scans)
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-baseline-correction-u">
     <u>
      Baseline correction
     </u>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#data-background-subtraction">
       data - background subtraction
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#asw">
         ASW
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#ethane-samples">
         Ethane samples
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cleaning-and-sanity-check">
       Cleaning and Sanity Check
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#concatenation">
         Concatenation
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#export-as-csv">
         Export as csv
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-max-absorbance-u">
     <u>
      Max Absorbance
     </u>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#preliminary-steps">
       Preliminary steps
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#range-b">
         Range B
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#range-c">
         Range C
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#extract-max-a">
       Extract max A
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#clean">
       Clean
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#append-to-data-annex">
       Append to data Annex
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     <u>
      Plotting
     </u>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#full-range">
       Full range
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Oh stretch
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#baseline-correction">
         Baseline correction
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#all-scans">
         All scans
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#a-4b-all-scans-using-dictionnary-vale-discrete-t">
         2.4.A.4b All scans (using dictionnary vale - discrete T)
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#a-4-max-absorbance-peak-frequency-shift-clean">
         2.4.A.4 Max Absorbance (peak frequency shift) - Clean
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#a-5-max-absorbance-peak-frequency-shift-isotherm-1">
         2.4.A.5 Max Absorbance (peak frequency shift) - Isotherm 1
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#b-comb-bands">
       2.4.B Comb Bands
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#b-1-baseline-correction">
         2.4.B.1 Baseline correction
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#b-2-backgrounds">
         2.4.B.2 Backgrounds
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#b-3-all-scans">
         2.4.B.3 All scans
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#b-4-max-a-redshift">
         2.4.B.4 Max A + Redshift
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#c-bending">
       2.4.C Bending
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id3">
         2.4.B.1 Baseline correction
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id4">
         2.4.B.2 Backgrounds
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id5">
         2.4.B.3 All scans
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id6">
         2.4.B.4 Max A + Redshift
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#b-4-max-a-per-temperature">
         2.4.B.4 Max A, per temperature
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-background-yellow-color-green-text-dr3-normalisation-span">
   <span style="background :yellow">
    <span class="math notranslate nohighlight">
     \(\color{green}{\text{DR3 : Normalisation}}\)
    </span>
   </span>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-integration-u">
     3.1
     <u>
      Integration
     </u>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#function-definition">
       Function definition
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-oh-stretch">
       3.1.A Oh stretch
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#b-bending-modes">
       3.1.B Bending Modes
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id7">
       3.1.4 Clean
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-2-ethane-peaks-integration">
       3.1.A.2 Ethane peaks integration
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       3.1.5 Append to data Annex
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plotting">
       3.1.6 Plotting
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dict-values">
         Dict values
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id9">
         Dict values
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-column-density-calculation-u">
     3.2
     <u>
      Column Density Calculation
     </u>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#theory">
       3.2.1 Theory
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#normalisation-factor">
       3.2.2 Normalisation factor
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#optical-depth-calcul">
       3.3 Optical depth Calcul
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id10">
       3.3.A Oh stretch
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#b-oh-bend">
       3.3.B Oh bend
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#c-comparison-and-analysis">
       3.3.C Comparison and analysis
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#e-append-to-ice-thickness-df">
       3.3.E Append to Ice_thickness_df
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-normalisation-u">
     3.3
     <u>
      Normalisation
     </u>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#k-depositions">
       20K depositions
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     Export as csv
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-integration-ii-u">
     3.4
     <u>
      Integration II
     </u>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#high-temperature-deposition">
       High Temperature deposition
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-background-yellow-color-green-text-dr4-cleaning-and-error-analysis-span">
   <span style="background :yellow">
    <span class="math notranslate nohighlight">
     \(\color{green}{\text{DR4 : Cleaning and error analysis}}\)
    </span>
   </span>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#export-data-anex-as-csv">
     4.1 Export data_Anex as csv
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#insert-time-column">
     Insert time column
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sample-specific-reduction">
   5. Sample specific reduction
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     02_09
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#export-result-in-web-page">
     4.2 Export result in web-page
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#common-feature">
       Common feature
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#specific-feature">
       Specific feature
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#isotherms">
         Isotherms
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Intro</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Intro
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#workflow">
     Workflow
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#libraries">
     Libraries
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-raw-data">
     The RAW Data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#input-parameters">
     Input parameters
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#date-today">
       Date (today)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#experiment">
       Experiment
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#temperature-ramp">
       Temperature Ramp
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#append-df-to-csv">
         Append df to csv
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#sanity-check">
         Sanity Check
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#t-ramp-for-reduction">
       T ramp for Reduction
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#ramp">
         Ramp
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#isotherm">
         Isotherm
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-background-yellow-color-green-text-dr1-sanity-check-and-merging-span">
   <span style="background :yellow">
    <span class="math notranslate nohighlight">
     \(\color{green}{\text{DR1 : Sanity Check and Merging}}\)
    </span>
   </span>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-import-and-read-the-data-u">
     <u>
      Import and read the data
     </u>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-sanity-check-u">
     <u>
      Sanity Check
     </u>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-concatenation-u">
     <u>
      Concatenation
     </u>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-plotting-u">
     <u>
      Plotting
     </u>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-chop-the-data-u">
     <u>
      Chop the data
     </u>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#oh-stretch">
       1.5.1 OH Stretch
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#combination-bands">
       1.5.2 Combination bands
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bending-modes">
       1.5.3 bending modes
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-background-yellow-color-green-text-dr2-baseline-correction-span">
   <span style="background :yellow">
    <span class="math notranslate nohighlight">
     \(\color{green}{\text{DR2 : Baseline Correction}}\)
    </span>
   </span>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-background-function-definition-u">
     <u>
      Background function definition
     </u>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#minimum-single-point-within-a-range">
       Minimum (single point) within a range
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#minimum-within-a-range-smoothing">
       Minimum within a range + Smoothing
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#minimum-using-single-value-same-for-all-scans">
       Minimum Using single value (same for all scans)
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-baseline-correction-u">
     <u>
      Baseline correction
     </u>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#data-background-subtraction">
       data - background subtraction
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#asw">
         ASW
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#ethane-samples">
         Ethane samples
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cleaning-and-sanity-check">
       Cleaning and Sanity Check
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#concatenation">
         Concatenation
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#export-as-csv">
         Export as csv
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-max-absorbance-u">
     <u>
      Max Absorbance
     </u>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#preliminary-steps">
       Preliminary steps
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#range-b">
         Range B
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#range-c">
         Range C
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#extract-max-a">
       Extract max A
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#clean">
       Clean
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#append-to-data-annex">
       Append to data Annex
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     <u>
      Plotting
     </u>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#full-range">
       Full range
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Oh stretch
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#baseline-correction">
         Baseline correction
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#all-scans">
         All scans
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#a-4b-all-scans-using-dictionnary-vale-discrete-t">
         2.4.A.4b All scans (using dictionnary vale - discrete T)
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#a-4-max-absorbance-peak-frequency-shift-clean">
         2.4.A.4 Max Absorbance (peak frequency shift) - Clean
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#a-5-max-absorbance-peak-frequency-shift-isotherm-1">
         2.4.A.5 Max Absorbance (peak frequency shift) - Isotherm 1
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#b-comb-bands">
       2.4.B Comb Bands
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#b-1-baseline-correction">
         2.4.B.1 Baseline correction
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#b-2-backgrounds">
         2.4.B.2 Backgrounds
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#b-3-all-scans">
         2.4.B.3 All scans
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#b-4-max-a-redshift">
         2.4.B.4 Max A + Redshift
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#c-bending">
       2.4.C Bending
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id3">
         2.4.B.1 Baseline correction
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id4">
         2.4.B.2 Backgrounds
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id5">
         2.4.B.3 All scans
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id6">
         2.4.B.4 Max A + Redshift
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#b-4-max-a-per-temperature">
         2.4.B.4 Max A, per temperature
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-background-yellow-color-green-text-dr3-normalisation-span">
   <span style="background :yellow">
    <span class="math notranslate nohighlight">
     \(\color{green}{\text{DR3 : Normalisation}}\)
    </span>
   </span>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-integration-u">
     3.1
     <u>
      Integration
     </u>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#function-definition">
       Function definition
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-oh-stretch">
       3.1.A Oh stretch
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#b-bending-modes">
       3.1.B Bending Modes
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id7">
       3.1.4 Clean
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-2-ethane-peaks-integration">
       3.1.A.2 Ethane peaks integration
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       3.1.5 Append to data Annex
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plotting">
       3.1.6 Plotting
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#dict-values">
         Dict values
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id9">
         Dict values
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-column-density-calculation-u">
     3.2
     <u>
      Column Density Calculation
     </u>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#theory">
       3.2.1 Theory
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#normalisation-factor">
       3.2.2 Normalisation factor
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#optical-depth-calcul">
       3.3 Optical depth Calcul
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id10">
       3.3.A Oh stretch
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#b-oh-bend">
       3.3.B Oh bend
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#c-comparison-and-analysis">
       3.3.C Comparison and analysis
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#e-append-to-ice-thickness-df">
       3.3.E Append to Ice_thickness_df
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-normalisation-u">
     3.3
     <u>
      Normalisation
     </u>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#k-depositions">
       20K depositions
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     Export as csv
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#u-integration-ii-u">
     3.4
     <u>
      Integration II
     </u>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#high-temperature-deposition">
       High Temperature deposition
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-background-yellow-color-green-text-dr4-cleaning-and-error-analysis-span">
   <span style="background :yellow">
    <span class="math notranslate nohighlight">
     \(\color{green}{\text{DR4 : Cleaning and error analysis}}\)
    </span>
   </span>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#export-data-anex-as-csv">
     4.1 Export data_Anex as csv
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#insert-time-column">
     Insert time column
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sample-specific-reduction">
   5. Sample specific reduction
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     02_09
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#export-result-in-web-page">
     4.2 Export result in web-page
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#common-feature">
       Common feature
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#specific-feature">
       Specific feature
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#isotherms">
         Isotherms
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <p><span style="font-size:42px;"><strong>DATA Reduction </strong></span></p>
<hr>
<div class="tex2jax_ignore mathjax_ignore section" id="intro">
<h1>Intro<a class="headerlink" href="#intro" title="Permalink to this headline">¬∂</a></h1>
<p>The purpose of this Notebook is to perform the Reduction pipeline for each samples (ie classified by dates) divided in 3 steps:</p>
<ul class="simple">
<li><p>DR1: Sanity Check Merging</p></li>
<li><p>DR2: Baseline Correction</p></li>
<li><p>DR3: Integration Normalisation</p></li>
</ul>
<p>I learned Python during my PhD, starting from scratch and I have to confess, it was a mixed feeling experience all along. It looked very scary at first, was painfull most of the time but sometimes very satisfying and rewarding as well. All together, it is a great tool for analysing data and I will try to show you why, and teach you how to use it using a ‚Äúreal life example‚Äù by breaking down all the steps I took to perform the analysis of my own data set.</p>
<hr class="docutils" />
<p>For more information about the research itself (which I strongly recommend) have a look there: <span class="xref myst">Personal Web-site</span></p>
<hr class="docutils" />
<p><b> Notes formatting: </b></p>
<div class="alert alert-block alert-info">
<b>Teaching notes:</b> I produced this notebook while learning, hence I think it may be uselfull for teaching python
</div>
<div class="alert alert-block alert-success">
<b>Other users notes:</b> It is also one of the aim of my work to produce reliable and interoperable tools to reduce, process and analyse IR data
</div>
<div class="alert alert-block alert-warning">
<b>Notes for me: </b> This is for me to highligt improvment needed.
</div>
<div class="alert alert-block alert-danger">
<b>Important notes for all:</b> Just in case ;)
</div><div class="section" id="workflow">
<h2>Workflow<a class="headerlink" href="#workflow" title="Permalink to this headline">¬∂</a></h2>
<div class="alert alert-block alert-info">
<b>First thing first:</b> Download your python environment: Jupyter, Donload Anaconda ...
</div><p><img alt="DR_workflow_02_08_21.png" src="Notes/Script_Copie/attachment:DR_workflow_02_08_21.png" /></p>
<p><strong>Figure 1:</strong> Workflow</p>
<p>Explain ‚Ä¶</p>
</div>
<div class="section" id="libraries">
<h2>Libraries<a class="headerlink" href="#libraries" title="Permalink to this headline">¬∂</a></h2>
<div class="alert alert-block alert-info">
One of the greatest strength of Python reside in it`s collaborative nature ... libraries developped by the community ... (Open source ...)
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> 
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">mcolors</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">SVG</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="the-raw-data">
<h2>The RAW Data<a class="headerlink" href="#the-raw-data" title="Permalink to this headline">¬∂</a></h2>
<p>From Omnic I obtain individual .spa scans named:
<br><br><span class="math notranslate nohighlight">\(\color{red}{\text{ASW}}\)</span><em><span class="math notranslate nohighlight">\(\color{blue}{\text{2020_09_15}}\)</span></em><span class="math notranslate nohighlight">\(\color{green}{\text{0001}}\)</span>.spa<br></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\color{red}{\text{Sample type}}\)</span> : can take value : ASW, C2H6, C2H6_ASW</p></li>
<li><p><span class="math notranslate nohighlight">\(\color{blue}{\text{Sample date}}\)</span> : format yyyy_mm_dd (is the id of every sample).</p></li>
<li><p><span class="math notranslate nohighlight">\(\color{green}{\text{Scan number}}\)</span> : is allocate incrementaly and represent each scan.</p></li>
</ul>
<p>This scan is saved as a csv and I performe a smoothing (15) using Omnic.
Overall, for each experimental scans I obtain 3 output: <br></p>
<div class="alert alert-block alert-success">
<b>The RAW Data:</b>
<br><br>
- ASW_2020_09_15_0001.spa (Raw Data)<br>
- ASW_2020_09_15_0001.csv (Raw Data - python ready)<br>
- ASW_2020_09_15_0001_smooth.csv (pre-reduced Data) 
<br>    
</div>
<p>In the remaining reduction steps, I will used the smoothed Data.</p>
<p><span class="xref myst">List of experiments</span>: click on the link to download a table summarising the different experiments.</p>
<p>To continue ‚Ä¶</p>
</div>
<div class="section" id="input-parameters">
<h2>Input parameters<a class="headerlink" href="#input-parameters" title="Permalink to this headline">¬∂</a></h2>
<p>The Data Reduction routine is performed ‚Äúper sample‚Äù. Hence we need to define some input parameters to select what sample we want to reduce (and how).</p>
<div class="section" id="date-today">
<h3>Date (today)<a class="headerlink" href="#date-today" title="Permalink to this headline">¬∂</a></h3>
<p>somehow allow for version control (really?)</p>
<p>Check for calendar input</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">date_jour</span> <span class="o">=</span> <span class="s2">&quot;2021_09_15&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="experiment">
<h3>Experiment<a class="headerlink" href="#experiment" title="Permalink to this headline">¬∂</a></h3>
<div class="alert alert-block alert-success">
<b>X:</b>
blabla
</div>
<div class="alert alert-block alert-warning">
Should I use input to make sure those fields are filled ? --> later
</div>
<p><span class="math notranslate nohighlight">\(\color{red}{\text{Update manually !}}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 0.1 Date</span>

<span class="n">date</span> <span class="o">=</span> <span class="s2">&quot;2020_09_15&quot;</span>

<span class="c1"># 0.2 XP</span>
    <span class="c1"># Can take value XP_1-1, XP_1-2 </span>

<span class="n">XP</span> <span class="o">=</span> <span class="s2">&quot;XP_1-1&quot;</span>

<span class="c1"># 0.3 Sample type</span>
    <span class="c1"># Can take value ASW, C2H6, C2H6_ASW</span>

<span class="n">spl</span> <span class="o">=</span> <span class="s2">&quot;ASW&quot;</span>

<span class="c1"># 0.4 Deposition Temperature</span>

<span class="n">Tdep</span> <span class="o">=</span> <span class="s2">&quot;20&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="temperature-ramp">
<h3>Temperature Ramp<a class="headerlink" href="#temperature-ramp" title="Permalink to this headline">¬∂</a></h3>
<p>Needs to be <span class="math notranslate nohighlight">\(\color{red}{\text{Implemented manually !}}\)</span></p>
<div class="alert alert-block alert-info">
Dictionary: {key: value }
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T_ramp</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">T_ramp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        
        <span class="p">{</span>
            <span class="s1">&#39;Sample&#39;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">spl</span><span class="p">),</span>
            <span class="s1">&#39;Date&#39;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">),</span>
            <span class="s1">&#39;20&#39;</span> <span class="p">:</span>  <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;30&#39;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;40&#39;</span> <span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="s1">&#39;50&#39;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;60&#39;</span> <span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="s1">&#39;70&#39;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;80&#39;</span> <span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="s1">&#39;90&#39;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;100&#39;</span> <span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="s1">&#39;110&#39;</span> <span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;120&#39;</span> <span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="s1">&#39;125&#39;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;130&#39;</span> <span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="s1">&#39;132&#39;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;134&#39;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;135&#39;</span> <span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="s1">&#39;136&#39;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;137&#39;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;138&#39;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;140&#39;</span> <span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">65</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="s1">&#39;142&#39;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;145&#39;</span> <span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">76</span><span class="p">,</span> <span class="mi">166</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="s1">&#39;150&#39;</span> <span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;155&#39;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;160&#39;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;180&#39;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s1">&#39;200&#39;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>

            <span class="p">})</span>

<span class="c1">#T_ramp</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-info">
Pandas library
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T_ramp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">T_ramp</span><span class="p">)</span>

<span class="c1">#T_ramp_df </span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="append-df-to-csv">
<h4>Append df to csv<a class="headerlink" href="#append-df-to-csv" title="Permalink to this headline">¬∂</a></h4>
<p>We want to append T_ramp_df to XP_file.cvs, only if the date is not already present</p>
<p>Open XP_Ramp csv and create a df</p>
<div class="alert alert-block alert-info">
Read csv
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">XP_Ramp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;..\DATA\DATA-Processing\PAC\XP_list_test.csv&#39;</span><span class="p">)</span>

<span class="c1">#XP_Ramp_df</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-info">
Extract information from df
</div>
<p>What date are already present</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">XP_Date</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">XP_Date</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">XP_Ramp_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>

<span class="c1">#print(XP_Date)</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-info">
if statement
</div>
<p>Conditions that state if date already exist, don`t append, otherwise append T_ramp_df to XP_ramp_df</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">XP_Date</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Not appended&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">T_ramp_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;..\DATA\DATA-Processing\PAC\XP_list_test.csv&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Not appended
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="sanity-check">
<h4>Sanity Check<a class="headerlink" href="#sanity-check" title="Permalink to this headline">¬∂</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#XP_file_df = pd.read_csv(&#39;D:\PhD-WS\Projects\PAC\XP_1-1\DATA\XP_list_test.csv&#39;)</span>

<span class="c1">#XP_file_df</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="t-ramp-for-reduction">
<h3>T ramp for Reduction<a class="headerlink" href="#t-ramp-for-reduction" title="Permalink to this headline">¬∂</a></h3>
<div class="section" id="ramp">
<h4>Ramp<a class="headerlink" href="#ramp" title="Permalink to this headline">¬∂</a></h4>
<p>Purpose here is to produce a dictionnary where one scan is allocated to a Temperature for a rough processing within this Reduction Notebook.</p>
<p><span class="math notranslate nohighlight">\(\color{red}{\text{Implement manually !}}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">j</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;20&quot;</span><span class="p">,</span><span class="s2">&quot;130&quot;</span><span class="p">,</span><span class="s2">&quot;140&quot;</span><span class="p">,</span><span class="s2">&quot;160&quot;</span><span class="p">]</span>


<span class="n">Tdictionary</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p><em><strong>Previous Dictionnaries</strong></em></p>
<p>Creating those dictionnary is a tedious process that, hence to prevent having to rewrite them each times we store them here as comments. However there is probaly a better method preventing a surcharge here (to implement)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#15-09 Sample </span>

<span class="c1">#i = [0,1,2,3]</span>
<span class="c1">#j = [&quot;20&quot;,&quot;130&quot;,&quot;140&quot;,&quot;160&quot;]</span>

<span class="c1">#16-09 Sample </span>

<span class="c1">#i = [0,1,4,7,10,13,16,19,22,25,28,30]</span>
<span class="c1">#j = [&quot;Dep&quot;,&quot;20&quot;,&quot;40&quot;,&quot;60&quot;,&quot;80&quot;,&quot;100&quot;,&quot;120&quot;,&quot;130&quot;,&quot;140&quot;,&quot;160&quot;,&quot;180&quot;,&quot;200&quot;]</span>

<span class="c1">#28-09</span>

<span class="c1">#i = [0,1,4,8,12,16,20,24,28,32,36,40,48,52,56,60,64,68,76,79]</span>
<span class="c1">#j = [&quot;Dep&quot;,&quot;20&quot;,&quot;30&quot;,&quot;40&quot;,&quot;50&quot;,&quot;60&quot;,&quot;70&quot;,&quot;80&quot;,&quot;90&quot;,&quot;100&quot;,&quot;110&quot;,&quot;120&quot;,&quot;125&quot;,&quot;130&quot;,&quot;135&quot;,&quot;140&quot;,&quot;145&quot;,&quot;150&quot;,&quot;155&quot;,&quot;160&quot;,]</span>

<span class="c1">#17-09 and 21-09</span>

<span class="c1">#i = [0,1,4,7,10,13,16,19,22,25,27]</span>
<span class="c1">#j = [&quot;Dep&quot;,&quot;20&quot;,&quot;40&quot;,&quot;60&quot;,&quot;80&quot;,&quot;100&quot;,&quot;120&quot;,&quot;130&quot;,&quot;140&quot;,&quot;160&quot;,&quot;180&quot;]</span>

<span class="c1">#22-10</span>

<span class="c1">#i = [0,1,4,8,34,37,40,43,46,49,52,55,57,66]</span>
<span class="c1">#j = [&quot;Dep&quot;,&quot;20&quot;,&quot;120&quot;,&quot;130&quot;, &quot;130*&quot;, &quot;132&quot;,&quot;134&quot;,&quot;136&quot;,&quot;138&quot;,&quot;140&quot;,&quot;142&quot;,&quot;145&quot;,&quot;150&quot;,&quot;150*&quot;]</span>

<span class="c1">#16-11</span>

<span class="c1">#i = [0,1,4,6,17,18,41,45,49,51,63,66,68,88]</span>
<span class="c1">#j = [&quot;Dep&quot;,&quot;20&quot;,&quot;60&quot;,&quot;70&quot;,&quot;70*&quot;,&quot;130&quot;,&quot;130*&quot;,&quot;136&quot;,&quot;137&quot;,&quot;138&quot;,&quot;138*&quot;,&quot;140&quot;,&quot;145&quot;,&quot;145*&quot;]</span>

<span class="c1">#11-19</span>

<span class="c1">#i = [0,1,4,9,12,52,55,66,69,88,91,94,159]</span>
<span class="c1">#j = [&quot;Dep&quot;,&quot;20&quot;,&quot;60&quot;,&quot;60*&quot;,&quot;70&quot;,&quot;70*&quot;,&quot;130&quot;,&quot;130*&quot;,&quot;135&quot;,&quot;135*&quot;,&quot;140&quot;,&quot;145&quot;,&quot;145*&quot;]</span>

<span class="c1">#11-23</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="isotherm">
<h4>Isotherm<a class="headerlink" href="#isotherm" title="Permalink to this headline">¬∂</a></h4>
<p>For specific samples, it is necessary to have the same approach as before but using Isotherm data. ie for one temperature specific scans are selected and included in a dictionnary where key is time (hour)</p>
<div class="alert alert-block alert-info">
if statement
<br>   
<p><a href="https://ipywidgets.readthedocs.io/en/latest/examples/Widget%20List.html#Boolean-widgets">Widget list</a></p>
</div>
<p><span class="math notranslate nohighlight">\(\color{red}{\text{Modify accordingly !}}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Iso</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Checkbox</span><span class="p">(</span>
      <span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
      <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Isotherm&#39;</span><span class="p">,</span>
      <span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
      <span class="n">indent</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">Iso</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "7c2ec63f696641e6841e5581c7ae2fef", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>$\color{red}{\text{Implement the Tiso !}}$
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Tiso1 = &quot;130&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#k = [8,24,41,58,75,90,106,123,140,157,174,191,208,225,242,259,276,293,310,327,344,361,378,395,412,429,446,463,480,497,514,531,548,565,582,599,616,633,650,667,684,701,718,735,752,769,786]</span>
<span class="c1">#l = [&quot;0&quot;,&quot;4&quot;,&quot;8&quot;,&quot;12&quot;,&quot;16&quot;,&quot;20&quot;,&quot;24&quot;,&quot;28&quot;,&quot;32&quot;,&quot;36&quot;,&quot;40&quot;,&quot;44&quot;,&quot;48&quot;,&quot;52&quot;,&quot;56&quot;,&quot;60&quot;,&quot;64&quot;,&quot;68&quot;,&quot;72&quot;,&quot;76&quot;,&quot;80&quot;,&quot;84&quot;,&quot;88&quot;,&quot;92&quot;,&quot;96&quot;,&quot;100&quot;,&quot;104&quot;,&quot;108&quot;,&quot;112&quot;,&quot;116&quot;,&quot;120&quot;,&quot;124&quot;,&quot;128&quot;,&quot;132&quot;,&quot;136&quot;,&quot;140&quot;,&quot;144&quot;,&quot;148&quot;,&quot;152&quot;,&quot;156&quot;,&quot;160&quot;,&quot;164&quot;,&quot;168&quot;,&quot;172&quot;,&quot;176&quot;,&quot;180&quot;]</span>

<span class="c1">#k = [8,12,16,20,24,28,31,35,39,43,47,51,55,59,63,67,71,75,79,83,87,90,94,98,102,106,110,114,118,122,125,129,133,137,141,145,149,153,157,161,165,169,173,177,181,185,189,193]</span>
<span class="c1">#l = [&quot;0&quot;,&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;6&quot;,&quot;7&quot;,&quot;8&quot;,&quot;9&quot;,&quot;10&quot;,&quot;11&quot;,&quot;12&quot;,&quot;13&quot;,&quot;14&quot;,&quot;15&quot;,&quot;16&quot;,&quot;17&quot;,&quot;18&quot;,&quot;19&quot;,&quot;20&quot;,&quot;21&quot;,&quot;22&quot;,&quot;23&quot;,&quot;24&quot;,&quot;25&quot;,&quot;26&quot;,&quot;27&quot;,&quot;28&quot;,&quot;29&quot;,&quot;30&quot;,&quot;31&quot;,&quot;32&quot;,&quot;33&quot;,&quot;34&quot;,&quot;35&quot;,&quot;36&quot;,&quot;37&quot;,&quot;38&quot;,&quot;39&quot;,&quot;40&quot;,&quot;41&quot;,&quot;42&quot;,&quot;43&quot;,&quot;44&quot;,&quot;45&quot;,&quot;46&quot;,&quot;47&quot;,&quot;48&quot;]</span>

<span class="c1">#k = [10,50,100,150,200,250,300,350,400,450,500,550,600,650,700,750,800] </span>
<span class="c1">#l = [&quot;0&quot;,&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;6&quot;,&quot;7&quot;,&quot;8&quot;,&quot;9&quot;,&quot;10&quot;,&quot;11&quot;,&quot;12&quot;,&quot;13&quot;,&quot;14&quot;,&quot;15&quot;,&quot;16&quot;]</span>

<span class="n">Isodic1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">23</span><span class="o">-</span><span class="mi">2224</span><span class="n">bc7216a1</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="c1">#l = [&quot;0&quot;,&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;6&quot;,&quot;7&quot;,&quot;8&quot;,&quot;9&quot;,&quot;10&quot;,&quot;11&quot;,&quot;12&quot;,&quot;13&quot;,&quot;14&quot;,&quot;15&quot;,&quot;16&quot;]</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> 
<span class="ne">---&gt; </span><span class="mi">10</span> <span class="n">Isodic1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>

<span class="ne">NameError</span>: name &#39;l&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p><em><strong>Previous Dictionnaries</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#10-22 130K</span>

<span class="c1">#k = [6,10,14,18,22,26,29,33]</span>
<span class="c1">#l = [&quot;0&quot;,&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;15&quot;,&quot;16&quot;]</span>

<span class="c1">#11-16 130K</span>

<span class="c1">#k = [20,24,28,32,36,40]</span>
<span class="c1">#l = [&quot;0&quot;,&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;16&quot;]</span>

<span class="c1">#11-19 145K</span>

<span class="c1">#k = [94,98,102,106,110,114,118,122,126,130,134,138,142,146,150,154,158]</span>
<span class="c1">#l = [&quot;0&quot;,&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;6&quot;,&quot;7&quot;,&quot;8&quot;,&quot;9&quot;,&quot;10&quot;,&quot;11&quot;,&quot;12&quot;,&quot;13&quot;,&quot;14&quot;,&quot;15&quot;,&quot;16&quot;]</span>

<span class="c1">#11-19 135K</span>

<span class="c1">#k = [68,72,76,80,84,89]</span>
<span class="c1">#l = [&quot;0&quot;,&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;22&quot;]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="span-style-background-yellow-color-green-text-dr1-sanity-check-and-merging-span">
<h1><span style='background :yellow' > <span class="math notranslate nohighlight">\(\color{green}{\text{DR1 : Sanity Check and Merging}}\)</span> </span><a class="headerlink" href="#span-style-background-yellow-color-green-text-dr1-sanity-check-and-merging-span" title="Permalink to this headline">¬∂</a></h1>
<p>I have one individual csv for each experimental scan (smoothed by omnic) called: ASW_2020_09_15_0001_smooth and located in the folder ‚ÄúD:\DATA-RAW\PAC\XP_1-1/2020_09_15/‚Äù</p>
<p>Purpose :</p>
<ul class="simple">
<li><p>Import all the data</p></li>
<li><p>Create one data frame for each spectrum and add header (wavenumber, spectrum title)</p></li>
<li><p>merge all the data frame and create one big with (wavenumber, 0001, 0002, 0003, ‚Ä¶)</p></li>
<li><p>Also during this phase a new csv will be created with various data that we aquired from the sample processing and named data_anex.csv</p></li>
</ul>
<p>All the outputs generated will be located in the following folder: D:\DATA-Processing\PAC\XP_1-1\Samples\2020_09_15 and we expect two types of outputs:</p>
<ul class="simple">
<li><p>Data</p></li>
<li><p>Plots</p></li>
</ul>
<div class="section" id="u-import-and-read-the-data-u">
<h2><u>Import and read the data</u><a class="headerlink" href="#u-import-and-read-the-data-u" title="Permalink to this headline">¬∂</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file_path</span> <span class="o">=</span> <span class="s2">&quot;..\DATA\DATA-RAW\PAC\</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">/*_smooth.csv&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span><span class="n">date</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><em><strong>Empty lists</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># List within which all the individual scans will be added prior to merging</span>
<span class="n">All_data_frame</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># List where all the &quot;data annex&quot; (ie max absorbance ...), will be stored </span>
<span class="n">data_anex</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1">#Temperature Ramp that the sample experienced (need to be entered manually later)</span>
<span class="n">T_ramp</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Data annex values</span>
<span class="n">data_max</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">minimum_1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">minimum_1_index</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">minimum_2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">minimum_2_index</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">minimum_3</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">minimum_3_index</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">minimum_4</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">minimum_4_index</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">minimum_5</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">minimum_5_index</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">minimum_6</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">minimum_6_index</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">maximum</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">maximum_index</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<p><em><strong>For loop</strong></em></p>
<p>Open all the individual files (df) and append to a list (All_data_frame) that will subsequently be transformed into a df.</p>
<p>Extract some informations for each sample:</p>
<ul class="simple">
<li><p>min between 3 ranges</p></li>
<li><p>max
that will subsequently be used for the remaining of the Data reduction pipeline and store it in data annex</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># iterator</span>

<span class="n">file_number</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1">#for loop</span>

<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Wavenumber&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">spl</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">file_number</span><span class="p">)])</span>
    
    <span class="n">All_data_frame</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> 

    <span class="c1">#Min 4000 - 3800 wavenumber</span>
    
    <span class="n">min1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">6223</span><span class="p">:</span><span class="mi">6639</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="n">min1_index</span><span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">6223</span><span class="p">:</span><span class="mi">6639</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
    
    <span class="c1">#Min 3000 - 2800 wavenumber</span>
    
    <span class="n">min2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4149</span><span class="p">:</span><span class="mi">4564</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="n">min2_index</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4149</span><span class="p">:</span><span class="mi">4564</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
    
    <span class="c1">#Min 2800 - 2700 wavenumber</span>
    
    <span class="n">min3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3941</span><span class="p">:</span><span class="mi">4149</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="n">min3_index</span><span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3941</span><span class="p">:</span><span class="mi">4149</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
    
    <span class="c1">#Min 2000 - 1900 wavenumber</span>
    
    <span class="n">min4</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2282</span><span class="p">:</span><span class="mi">2490</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="n">min4_index</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2282</span><span class="p">:</span><span class="mi">2490</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
    
    <span class="c1">#Min 2800 - 2700 wavenumber</span>
    
    <span class="n">min3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3941</span><span class="p">:</span><span class="mi">4149</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="n">min3_index</span><span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3941</span><span class="p">:</span><span class="mi">4149</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
    
    <span class="c1">#Min 2000 - 1900 wavenumber</span>
    
    <span class="n">min4</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2282</span><span class="p">:</span><span class="mi">2490</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="n">min4_index</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2282</span><span class="p">:</span><span class="mi">2490</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
    
    <span class="c1">#Min 1900 - 1800 wavenumber</span>
    
    <span class="n">min5</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2075</span><span class="p">:</span><span class="mi">2282</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="n">min5_index</span><span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2075</span><span class="p">:</span><span class="mi">2282</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
    
    <span class="c1">#Min 1300 - 800 wavenumber</span>
    
    <span class="n">min6</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1038</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="n">min6_index</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1038</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
    
    <span class="n">maxi</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4149</span><span class="p">:</span><span class="mi">6639</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="n">maxi_index</span><span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4149</span><span class="p">:</span><span class="mi">6639</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
    

    <span class="c1">#Wavenumber.append(Wav)    </span>
    <span class="c1">#RAW_data.append(RAW)</span>
    
    <span class="n">minimum_1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">min1</span><span class="p">)</span>
    <span class="n">minimum_1_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">min1_index</span><span class="p">)</span>
    
    <span class="n">minimum_2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">min2</span><span class="p">)</span>
    <span class="n">minimum_2_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">min2_index</span><span class="p">)</span>
    
    <span class="n">minimum_3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">min3</span><span class="p">)</span>
    <span class="n">minimum_3_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">min3_index</span><span class="p">)</span>
    
    <span class="n">minimum_4</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">min3</span><span class="p">)</span>
    <span class="n">minimum_4_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">min3_index</span><span class="p">)</span>
    
    <span class="n">minimum_5</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">min5</span><span class="p">)</span>
    <span class="n">minimum_5_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">min5_index</span><span class="p">)</span>
    
    <span class="n">minimum_6</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">min6</span><span class="p">)</span>
    <span class="n">minimum_6_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">min6_index</span><span class="p">)</span>
    
    <span class="n">maximum</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">maxi</span><span class="p">)</span>
    <span class="n">maximum_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">maxi_index</span><span class="p">)</span>
        
    <span class="n">data_anex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        
        <span class="p">{</span>

            <span class="s1">&#39;Name&#39;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">spl</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">file_number</span><span class="p">),</span>
            <span class="s1">&#39;min1&#39;</span> <span class="p">:</span> <span class="n">min1</span><span class="p">,</span>
            <span class="s1">&#39;index1&#39;</span> <span class="p">:</span>  <span class="n">min1_index</span><span class="p">,</span>
            <span class="s1">&#39;min2&#39;</span> <span class="p">:</span> <span class="n">min2</span><span class="p">,</span>
            <span class="s1">&#39;index2&#39;</span> <span class="p">:</span>  <span class="n">min2_index</span><span class="p">,</span>
            <span class="s1">&#39;min3&#39;</span> <span class="p">:</span> <span class="n">min3</span><span class="p">,</span>
            <span class="s1">&#39;index3&#39;</span> <span class="p">:</span>  <span class="n">min3_index</span><span class="p">,</span>
            <span class="s1">&#39;min4&#39;</span> <span class="p">:</span> <span class="n">min4</span><span class="p">,</span>
            <span class="s1">&#39;index4&#39;</span> <span class="p">:</span>  <span class="n">min4_index</span><span class="p">,</span>
            <span class="s1">&#39;min5&#39;</span> <span class="p">:</span> <span class="n">min5</span><span class="p">,</span>
            <span class="s1">&#39;index5&#39;</span> <span class="p">:</span>  <span class="n">min5_index</span><span class="p">,</span>
            <span class="s1">&#39;min6&#39;</span> <span class="p">:</span> <span class="n">min6</span><span class="p">,</span>
            <span class="s1">&#39;index6&#39;</span> <span class="p">:</span>  <span class="n">min6_index</span><span class="p">,</span>
            <span class="s1">&#39;max&#39;</span> <span class="p">:</span> <span class="n">maxi</span><span class="p">,</span>
            <span class="s1">&#39;max_index&#39;</span> <span class="p">:</span>  <span class="n">maxi_index</span><span class="p">,</span>
        <span class="p">})</span>
    


    
    <span class="n">file_number</span> <span class="o">+=</span><span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<p>Should I had a new min range for ethane data ?</p>
</div>
<div class="section" id="u-sanity-check-u">
<h2><u>Sanity Check </u><a class="headerlink" href="#u-sanity-check-u" title="Permalink to this headline">¬∂</a></h2>
<p><em><strong>All Data</strong></em></p>
<p>Check that the list has the same number of scans, and that every scan has 6639 rows</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">All_data_frame</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[      Wavenumber  ASW_2020_09_15_1
 0       799.8442          0.070200
 1       800.3264          0.069613
 2       800.8085          0.069002
 3       801.2906          0.069099
 4       801.7727          0.068733
 ...          ...               ...
 6634   3998.2570         -0.017155
 6635   3998.7390         -0.017126
 6636   3999.2210         -0.017211
 6637   3999.7030         -0.017211
 6638   4000.1850         -0.017199
 
 [6639 rows x 2 columns],
       Wavenumber  ASW_2020_09_15_2
 0       799.8442          0.086859
 1       800.3264          0.085440
 2       800.8085          0.081987
 3       801.2906          0.078084
 4       801.7727          0.076453
 ...          ...               ...
 6634   3998.2570         -0.016794
 6635   3998.7390         -0.017087
 6636   3999.2210         -0.017489
 6637   3999.7030         -0.016742
 6638   4000.1850         -0.016014
 
 [6639 rows x 2 columns],
       Wavenumber  ASW_2020_09_15_3
 0       799.8442          0.080537
 1       800.3264          0.084133
 2       800.8085          0.086396
 3       801.2906          0.083552
 4       801.7727          0.081117
 ...          ...               ...
 6634   3998.2570         -0.016967
 6635   3998.7390         -0.017292
 6636   3999.2210         -0.017849
 6637   3999.7030         -0.017107
 6638   4000.1850         -0.016281
 
 [6639 rows x 2 columns],
       Wavenumber  ASW_2020_09_15_4
 0       799.8442          0.055492
 1       800.3264          0.045511
 2       800.8085          0.034734
 3       801.2906          0.036551
 4       801.7727          0.039316
 ...          ...               ...
 6634   3998.2570         -0.006420
 6635   3998.7390         -0.006350
 6636   3999.2210         -0.006541
 6637   3999.7030         -0.006789
 6638   4000.1850         -0.006947
 
 [6639 rows x 2 columns]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_anex</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;Name&#39;: &#39;ASW_2020_09_15_1&#39;,
  &#39;min1&#39;: -0.01729266,
  &#39;index1&#39;: 6630,
  &#39;min2&#39;: -0.009476378,
  &#39;index2&#39;: 4293,
  &#39;min3&#39;: -0.009150573,
  &#39;index3&#39;: 4147,
  &#39;min4&#39;: 0.001202779,
  &#39;index4&#39;: 2482,
  &#39;min5&#39;: 0.001967053,
  &#39;index5&#39;: 2281,
  &#39;min6&#39;: 0.008000653,
  &#39;index6&#39;: 490,
  &#39;max&#39;: 0.27797659999999996,
  &#39;max_index&#39;: 5124},
 {&#39;Name&#39;: &#39;ASW_2020_09_15_2&#39;,
  &#39;min1&#39;: -0.01748862,
  &#39;index1&#39;: 6636,
  &#39;min2&#39;: -0.008994884,
  &#39;index2&#39;: 4161,
  &#39;min3&#39;: -0.009001405,
  &#39;index3&#39;: 4132,
  &#39;min4&#39;: 0.0024301089999999997,
  &#39;index4&#39;: 2480,
  &#39;min5&#39;: 0.003481556,
  &#39;index5&#39;: 2281,
  &#39;min6&#39;: 0.009176878000000001,
  &#39;index6&#39;: 474,
  &#39;max&#39;: 0.3958895,
  &#39;max_index&#39;: 5074},
 {&#39;Name&#39;: &#39;ASW_2020_09_15_3&#39;,
  &#39;min1&#39;: -0.01784931,
  &#39;index1&#39;: 6636,
  &#39;min2&#39;: -0.00971482,
  &#39;index2&#39;: 4151,
  &#39;min3&#39;: -0.009664497,
  &#39;index3&#39;: 4132,
  &#39;min4&#39;: 0.001594619,
  &#39;index4&#39;: 2463,
  &#39;min5&#39;: 0.003062862,
  &#39;index5&#39;: 2269,
  &#39;min6&#39;: 0.007826916,
  &#39;index6&#39;: 476,
  &#39;max&#39;: 0.40064920000000004,
  &#39;max_index&#39;: 5047},
 {&#39;Name&#39;: &#39;ASW_2020_09_15_4&#39;,
  &#39;min1&#39;: -0.006971228,
  &#39;index1&#39;: 6630,
  &#39;min2&#39;: -0.004297984,
  &#39;index2&#39;: 4149,
  &#39;min3&#39;: -0.004221556,
  &#39;index3&#39;: 4120,
  &#39;min4&#39;: 0.002219502,
  &#39;index4&#39;: 2473,
  &#39;min5&#39;: 0.002968179,
  &#39;index5&#39;: 2279,
  &#39;min6&#39;: 0.005999863,
  &#39;index6&#39;: 829,
  &#39;max&#39;: 0.20309029999999997,
  &#39;max_index&#39;: 5037}]
</pre></div>
</div>
</div>
</div>
<p><em><strong>Data Annex</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_anex_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_anex</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_anex_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>min1</th>
      <th>index1</th>
      <th>min2</th>
      <th>index2</th>
      <th>min3</th>
      <th>index3</th>
      <th>min4</th>
      <th>index4</th>
      <th>min5</th>
      <th>index5</th>
      <th>min6</th>
      <th>index6</th>
      <th>max</th>
      <th>max_index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ASW_2020_09_15_1</td>
      <td>-0.017293</td>
      <td>6630</td>
      <td>-0.009476</td>
      <td>4293</td>
      <td>-0.009151</td>
      <td>4147</td>
      <td>0.001203</td>
      <td>2482</td>
      <td>0.001967</td>
      <td>2281</td>
      <td>0.008001</td>
      <td>490</td>
      <td>0.277977</td>
      <td>5124</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ASW_2020_09_15_2</td>
      <td>-0.017489</td>
      <td>6636</td>
      <td>-0.008995</td>
      <td>4161</td>
      <td>-0.009001</td>
      <td>4132</td>
      <td>0.002430</td>
      <td>2480</td>
      <td>0.003482</td>
      <td>2281</td>
      <td>0.009177</td>
      <td>474</td>
      <td>0.395890</td>
      <td>5074</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ASW_2020_09_15_3</td>
      <td>-0.017849</td>
      <td>6636</td>
      <td>-0.009715</td>
      <td>4151</td>
      <td>-0.009664</td>
      <td>4132</td>
      <td>0.001595</td>
      <td>2463</td>
      <td>0.003063</td>
      <td>2269</td>
      <td>0.007827</td>
      <td>476</td>
      <td>0.400649</td>
      <td>5047</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ASW_2020_09_15_4</td>
      <td>-0.006971</td>
      <td>6630</td>
      <td>-0.004298</td>
      <td>4149</td>
      <td>-0.004222</td>
      <td>4120</td>
      <td>0.002220</td>
      <td>2473</td>
      <td>0.002968</td>
      <td>2279</td>
      <td>0.006000</td>
      <td>829</td>
      <td>0.203090</td>
      <td>5037</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="u-concatenation-u">
<h2><u>Concatenation </u><a class="headerlink" href="#u-concatenation-u" title="Permalink to this headline">¬∂</a></h2>
<p>Purpose here is to concatenate all the individual scans into 1 big df that will subsequently be converted into csv</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">All_RAW_df</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">left</span><span class="p">,</span><span class="n">right</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span><span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Wavenumber&#39;</span><span class="p">],</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">),</span> <span class="n">All_data_frame</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">All_RAW_df</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Wavenumber</th>
      <th>ASW_2020_09_15_1</th>
      <th>ASW_2020_09_15_2</th>
      <th>ASW_2020_09_15_3</th>
      <th>ASW_2020_09_15_4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>799.8442</td>
      <td>0.070200</td>
      <td>0.086859</td>
      <td>0.080537</td>
      <td>0.055492</td>
    </tr>
    <tr>
      <th>1</th>
      <td>800.3264</td>
      <td>0.069613</td>
      <td>0.085440</td>
      <td>0.084133</td>
      <td>0.045511</td>
    </tr>
    <tr>
      <th>2</th>
      <td>800.8085</td>
      <td>0.069002</td>
      <td>0.081987</td>
      <td>0.086396</td>
      <td>0.034734</td>
    </tr>
    <tr>
      <th>3</th>
      <td>801.2906</td>
      <td>0.069099</td>
      <td>0.078084</td>
      <td>0.083552</td>
      <td>0.036551</td>
    </tr>
    <tr>
      <th>4</th>
      <td>801.7727</td>
      <td>0.068733</td>
      <td>0.076453</td>
      <td>0.081117</td>
      <td>0.039316</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6634</th>
      <td>3998.2570</td>
      <td>-0.017155</td>
      <td>-0.016794</td>
      <td>-0.016967</td>
      <td>-0.006420</td>
    </tr>
    <tr>
      <th>6635</th>
      <td>3998.7390</td>
      <td>-0.017126</td>
      <td>-0.017087</td>
      <td>-0.017292</td>
      <td>-0.006350</td>
    </tr>
    <tr>
      <th>6636</th>
      <td>3999.2210</td>
      <td>-0.017211</td>
      <td>-0.017489</td>
      <td>-0.017849</td>
      <td>-0.006541</td>
    </tr>
    <tr>
      <th>6637</th>
      <td>3999.7030</td>
      <td>-0.017211</td>
      <td>-0.016742</td>
      <td>-0.017107</td>
      <td>-0.006789</td>
    </tr>
    <tr>
      <th>6638</th>
      <td>4000.1850</td>
      <td>-0.017199</td>
      <td>-0.016014</td>
      <td>-0.016281</td>
      <td>-0.006947</td>
    </tr>
  </tbody>
</table>
<p>6639 rows √ó 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">All_RAW_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Wavenumber</th>
      <th>ASW_2020_09_15_1</th>
      <th>ASW_2020_09_15_2</th>
      <th>ASW_2020_09_15_3</th>
      <th>ASW_2020_09_15_4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>799.8442</td>
      <td>0.070200</td>
      <td>0.086859</td>
      <td>0.080537</td>
      <td>0.055492</td>
    </tr>
    <tr>
      <th>1</th>
      <td>800.3264</td>
      <td>0.069613</td>
      <td>0.085440</td>
      <td>0.084133</td>
      <td>0.045511</td>
    </tr>
    <tr>
      <th>2</th>
      <td>800.8085</td>
      <td>0.069002</td>
      <td>0.081987</td>
      <td>0.086396</td>
      <td>0.034734</td>
    </tr>
    <tr>
      <th>3</th>
      <td>801.2906</td>
      <td>0.069099</td>
      <td>0.078084</td>
      <td>0.083552</td>
      <td>0.036551</td>
    </tr>
    <tr>
      <th>4</th>
      <td>801.7727</td>
      <td>0.068733</td>
      <td>0.076453</td>
      <td>0.081117</td>
      <td>0.039316</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6634</th>
      <td>3998.2570</td>
      <td>-0.017155</td>
      <td>-0.016794</td>
      <td>-0.016967</td>
      <td>-0.006420</td>
    </tr>
    <tr>
      <th>6635</th>
      <td>3998.7390</td>
      <td>-0.017126</td>
      <td>-0.017087</td>
      <td>-0.017292</td>
      <td>-0.006350</td>
    </tr>
    <tr>
      <th>6636</th>
      <td>3999.2210</td>
      <td>-0.017211</td>
      <td>-0.017489</td>
      <td>-0.017849</td>
      <td>-0.006541</td>
    </tr>
    <tr>
      <th>6637</th>
      <td>3999.7030</td>
      <td>-0.017211</td>
      <td>-0.016742</td>
      <td>-0.017107</td>
      <td>-0.006789</td>
    </tr>
    <tr>
      <th>6638</th>
      <td>4000.1850</td>
      <td>-0.017199</td>
      <td>-0.016014</td>
      <td>-0.016281</td>
      <td>-0.006947</td>
    </tr>
  </tbody>
</table>
<p>6639 rows √ó 5 columns</p>
</div></div></div>
</div>
<p><em><strong>CSV Export</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">All_RAW_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;..\DATA\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s2">/Samples/</span><span class="si">{}</span><span class="s2">/Data/DR/DR1_</span><span class="si">{}</span><span class="s2">_All-scans.csv&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">date</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="u-plotting-u">
<h2><u> Plotting </u><a class="headerlink" href="#u-plotting-u" title="Permalink to this headline">¬∂</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">All_RAW_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>


<span class="n">fig</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>


<span class="n">normalize</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">nscan</span><span class="p">)</span>
<span class="n">colormap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">jet</span>
<span class="n">i</span><span class="o">=</span><span class="mi">1</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nscan</span><span class="p">):</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">All_RAW_df</span><span class="o">.</span><span class="n">Wavenumber</span><span class="p">,</span> <span class="n">All_RAW_df</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spl</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">i</span><span class="p">)],</span> <span class="n">color</span><span class="o">=</span><span class="n">colormap</span><span class="p">(</span><span class="n">normalize</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
    
    <span class="n">i</span><span class="o">=+</span><span class="mi">1</span>
    

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;DR1 Unprocessed </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">4000</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.50</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wavenumber (cm-1)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Absorbance&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="c1">#ax = fig.gca()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="c1">#plt.legend()</span>

<span class="n">scalarmappaple</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">normalize</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">colormap</span><span class="p">)</span>
<span class="n">scalarmappaple</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scalarmappaple</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;..\DATA\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s1">/Samples/</span><span class="si">{}</span><span class="s1">/Plots/DR/DR1_</span><span class="si">{}</span><span class="s1">_Full-range.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">date</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
<img alt="../../_images/Data_Reduction_Full_07-22_76_1.png" src="../../_images/Data_Reduction_Full_07-22_76_1.png" />
</div>
</div>
</div>
<div class="section" id="u-chop-the-data-u">
<h2><u> Chop the data </u><a class="headerlink" href="#u-chop-the-data-u" title="Permalink to this headline">¬∂</a></h2>
<p>Data is choped in 3 range:</p>
<ul class="simple">
<li><p>A: OH stretch : (4000 - 2800 cm-1)</p></li>
<li><p>B: Combination bands : (2800 - 1900 cm-1)</p></li>
<li><p>C: Bending modes : (1900 - 800 cm-1)</p></li>
</ul>
<p>If spl = C2H6 implement sub range for each peak:</p>
<p><span class="math notranslate nohighlight">\(\color{blue}{\text{do we need to do that ?}}\)</span></p>
<p>Yes because each baseline correction function will use the data within those ranges (there is probably a better solution there but for the moment that work quite well)</p>
<div class="section" id="oh-stretch">
<h3>1.5.1 OH Stretch<a class="headerlink" href="#oh-stretch" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DR1_A_df</span> <span class="o">=</span> <span class="n">All_RAW_df</span><span class="p">[</span><span class="mi">4150</span><span class="p">:</span><span class="mi">6639</span><span class="p">]</span>

<span class="c1">#DR1_A_df</span>
</pre></div>
</div>
</div>
</div>
<p><em><strong>Export as csv</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#DR1_A_df.to_csv(&#39;..\DATA\DATA-Processing\PAC\{}/Samples/{}/Data/DR/DR1_{}_A.csv&#39;.format(XP, date, date))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="combination-bands">
<h3>1.5.2 Combination bands<a class="headerlink" href="#combination-bands" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DR1_B_df</span> <span class="o">=</span> <span class="n">All_RAW_df</span><span class="p">[</span><span class="mi">2282</span><span class="p">:</span><span class="mi">4150</span><span class="p">]</span>

<span class="c1">#DR1_B_df</span>
</pre></div>
</div>
</div>
</div>
<p><em><strong>Export as csv</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#DR1_B_df.to_csv(&#39;..\DATA\DATA-Processing\PAC\{}/Samples/{}/Data/DR/DR1_{}_B.csv&#39;.format(XP, date, date))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="bending-modes">
<h3>1.5.3 bending modes<a class="headerlink" href="#bending-modes" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DR1_C_df</span> <span class="o">=</span> <span class="n">All_RAW_df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2282</span><span class="p">]</span>

<span class="c1">#DR1_C_df</span>
</pre></div>
</div>
</div>
</div>
<p><em><strong>Export as csv</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#DR1_C_df.to_csv(&#39;..\DATA\DATA-Processing\PAC\{}/Samples/{}/Data/DR/DR1_{}_C.csv&#39;.format(XP, date, date))</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="span-style-background-yellow-color-green-text-dr2-baseline-correction-span">
<h1><span style='background :yellow' > <span class="math notranslate nohighlight">\(\color{green}{\text{DR2 : Baseline Correction}}\)</span> </span><a class="headerlink" href="#span-style-background-yellow-color-green-text-dr2-baseline-correction-span" title="Permalink to this headline">¬∂</a></h1>
<p>One of the reason to perform all the reduction steps within the same notebook is that we can keep the previously created df all along. Also, the various outputs that are generated at the various reduction steps will be implemented into the same df (data_annex that will be converted to a csv at the end of the reduction). Here is a list of the df created so far:</p>
<p>Dataframe | Purpose</p>
<ul class="simple">
<li><p>| -
All_RAW_df | -
T_ramp_df | -
data_annex_df | -
DR1_A_df | -
DR1_B_df | -
DR1_C_df | -</p></li>
</ul>
<p>The purpose of this section is to perform a Baseline correction for each of the previously chopped data before to concatenate them in a fully baseline corrected df</p>
<p>Different samples (ASW - C2H6 - ASW_C2H6) needs different baseline correction. Hence, based on the variable ‚ÄúSpl‚Äù we will run different sub-notebooks that will aply the baseline correction:</p>
<p>Sample | Notebook | Function | Dataframe (name) | Output (csv)
:-: | :-: | :-:
ASW 1 | ASW_DR2_1.ipynb | select minimum value within a range
ASW 2 | ASW_DR2_2.ipynb | Select mean value within +- 5 wavenumber around a centered value
C2H6 | - | -
C2H6_ASW | - | -</p>
<p><em><strong>Empty List</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">maxA</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">maxAi</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<p><em><strong>Data check</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#DR1_A_df</span>
<span class="c1">#DR1_B_df</span>
<span class="c1">#DR1_C_df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#All_RAW_df</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="u-background-function-definition-u">
<h2><u>Background function definition </u><a class="headerlink" href="#u-background-function-definition-u" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="minimum-single-point-within-a-range">
<h3>Minimum (single point) within a range<a class="headerlink" href="#minimum-single-point-within-a-range" title="Permalink to this headline">¬∂</a></h3>
<p>Here we select a minimum within a predefined range (stored in data_annex).</p>
<p>Idea for latter: Try to not select an individual point as minimum but a local minimum with a rolling average</p>
<p><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.rolling.html">https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.rolling.html</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#DR1_A_df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We supress the first column (Wavenumber)</span>

<span class="n">DR1_A_df</span> <span class="o">=</span> <span class="n">DR1_A_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
<span class="n">DR1_B_df</span> <span class="o">=</span> <span class="n">DR1_B_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
<span class="n">DR1_C_df</span> <span class="o">=</span> <span class="n">DR1_C_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>

<span class="c1"># Now compute a new DataFrame indexed by the file names with rows that contain the</span>
<span class="c1"># minimum value and the index of that minimum value within specific row ranges</span>
<span class="c1"># of the column in data corresponding to the filename.</span>
<span class="n">dataStats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
  <span class="nb">dict</span><span class="p">(</span><span class="n">min1</span><span class="o">=</span><span class="n">All_RAW_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">6223</span><span class="p">:</span><span class="mi">6639</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="c1"># min within rows 6000 - end</span>
       <span class="n">mini1</span><span class="o">=</span><span class="n">All_RAW_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">6223</span><span class="p">:</span><span class="mi">6639</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="c1"># index of that min</span>
       <span class="n">min2</span><span class="o">=</span><span class="n">All_RAW_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4149</span><span class="p">:</span><span class="mi">4564</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="c1"># min within rows 4000 - 5000</span>
       <span class="n">mini2</span><span class="o">=</span><span class="n">All_RAW_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4149</span><span class="p">:</span><span class="mi">4564</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="c1"># index of that min</span>
       <span class="n">min3</span><span class="o">=</span><span class="n">All_RAW_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3941</span><span class="p">:</span><span class="mi">4149</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="c1"># min within rows 2282 - 2697</span>
       <span class="n">mini3</span><span class="o">=</span><span class="n">All_RAW_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3941</span><span class="p">:</span><span class="mi">4149</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="c1"># index of that min</span>
       <span class="n">min4</span><span class="o">=</span><span class="n">All_RAW_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2282</span><span class="p">:</span><span class="mi">2490</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="c1"># min within rows 415 - 830</span>
       <span class="n">mini4</span><span class="o">=</span><span class="n">All_RAW_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2282</span><span class="p">:</span><span class="mi">2490</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="c1"># index of that min   </span>
       <span class="n">min5</span><span class="o">=</span><span class="n">All_RAW_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2075</span><span class="p">:</span><span class="mi">2282</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="c1"># min within rows 2282 - 2697</span>
       <span class="n">mini5</span><span class="o">=</span><span class="n">All_RAW_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2075</span><span class="p">:</span><span class="mi">2282</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="c1"># index of that min</span>
       <span class="n">min6</span><span class="o">=</span><span class="n">All_RAW_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1038</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="c1"># min within rows 415 - 830</span>
       <span class="n">mini6</span><span class="o">=</span><span class="n">All_RAW_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1038</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="c1"># index of that min   </span>
        <span class="p">)</span>
    
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">dataStats</span><span class="p">)</span>

<span class="c1"># select average around minimum value </span>

<span class="c1">#.rolling(4).mean()</span>



<span class="c1"># Breaking down what&#39;s happening in:</span>
<span class="c1"># `data.T.iloc[1:].T.iloc[6000:6800].min(axis=0)`</span>
<span class="c1"># 1) `data.T.iloc[1:].T` - This is a cheeky way of stripping away the first column, &quot;Wavenumber&quot;,</span>
<span class="c1"># 1a) `data.T`, transposes the frame i.e. switches rows and columns</span>
<span class="c1"># 1b) `.iloc[1:]` selects all but the first row (previously all but the first column).</span>
<span class="c1"># 1c) The final `.T` switches rows and columns back again.</span>
<span class="c1"># 2) `.iloc[6000:6800]` selects rows at *positions* between 6000 and 6800. We now have a </span>
<span class="c1"># 2D block of data.</span>
<span class="c1"># 3) `.min(axis=0)` computes the column-wise minima of the 2D block we just selected, to </span>
<span class="c1"># give us a 1D Series of numbers.</span>
<span class="c1"># 3.1) On the next line, `.idxmin(axis=0)` computes the column-wise index of the minimum for </span>
<span class="c1"># the 2D block we just selected, to give us a 1D Series of index locations.</span>

<span class="c1"># We want to subtract a linear function from each column in data, that will</span>
<span class="c1"># connect the minimum values in the two ranges. </span>
<span class="c1"># We&#39;ll use the `apply` method of pd.DataFrame to do that.</span>
<span class="c1"># Apply operates on rows (or columns if the argument axis is set to 0) of a Dataframe to </span>
<span class="c1"># compute a function on the elements of that whole row or column.</span>
<span class="c1">#</span>
<span class="c1"># We&#39;ll define the function that we want to compute.</span>
<span class="c1"># The first argument is the column or row data themselves and we are free to </span>
<span class="c1"># provide other data that we need to compute out function.</span>
<span class="k">def</span> <span class="nf">computeLinearBackground1</span><span class="p">(</span><span class="n">values</span><span class="p">,</span>     <span class="c1"># The column values (e.g. Y)</span>
                            <span class="n">waveNumber</span><span class="p">,</span> <span class="c1"># The corresponding wavenumbers (e.g. X)</span>
                            <span class="n">valueStats</span>  <span class="c1"># The dataframe containing the minima and their </span>
                                        <span class="c1"># indices for each file</span>
                 <span class="p">):</span>
    <span class="c1"># extract the correct set of minima using the `name` attribute of the `values` series</span>
    <span class="c1"># to index the `valueStats` frame.</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="n">valueStats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">values</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">:]</span>
    <span class="c1"># compute a linear background function</span>
    <span class="n">gradient</span> <span class="o">=</span> <span class="p">((</span><span class="n">stats</span><span class="o">.</span><span class="n">min1</span> <span class="o">-</span> <span class="n">stats</span><span class="o">.</span><span class="n">min2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">mini1</span> <span class="o">-</span> <span class="n">stats</span><span class="o">.</span><span class="n">mini2</span><span class="p">))</span>
    <span class="n">intercept</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">min1</span> <span class="o">-</span> <span class="n">stats</span><span class="o">.</span><span class="n">mini1</span><span class="o">*</span><span class="n">gradient</span>
    <span class="n">linearBackground1</span> <span class="o">=</span> <span class="p">(</span><span class="n">gradient</span> <span class="o">*</span> <span class="n">waveNumber</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="n">intercept</span>
    <span class="c1"># subtract that function from the column values</span>
    <span class="k">return</span> <span class="n">linearBackground1</span>

<span class="k">def</span> <span class="nf">computeLinearBackground2</span><span class="p">(</span><span class="n">values</span><span class="p">,</span>    
                            <span class="n">waveNumber</span><span class="p">,</span> 
                            <span class="n">valueStats</span>  
                                        
                 <span class="p">):</span>

    <span class="n">stats</span> <span class="o">=</span> <span class="n">valueStats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">values</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">gradient</span> <span class="o">=</span> <span class="p">((</span><span class="n">stats</span><span class="o">.</span><span class="n">min3</span> <span class="o">-</span> <span class="n">stats</span><span class="o">.</span><span class="n">min4</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">mini3</span> <span class="o">-</span> <span class="n">stats</span><span class="o">.</span><span class="n">mini4</span><span class="p">))</span>
    <span class="n">intercept</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">min3</span> <span class="o">-</span> <span class="n">stats</span><span class="o">.</span><span class="n">mini3</span><span class="o">*</span><span class="n">gradient</span>
    <span class="n">linearBackground2</span> <span class="o">=</span> <span class="p">(</span><span class="n">gradient</span> <span class="o">*</span> <span class="n">waveNumber</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="n">intercept</span>
    <span class="k">return</span> <span class="n">linearBackground2</span>



<span class="k">def</span> <span class="nf">computeLinearBackground3</span><span class="p">(</span><span class="n">values</span><span class="p">,</span>   
                            <span class="n">waveNumber</span><span class="p">,</span> 
                            <span class="n">valueStats</span>  
                 <span class="p">):</span>
    
    <span class="n">stats</span> <span class="o">=</span> <span class="n">valueStats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">values</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">gradient</span> <span class="o">=</span> <span class="p">((</span><span class="n">stats</span><span class="o">.</span><span class="n">min5</span> <span class="o">-</span> <span class="n">stats</span><span class="o">.</span><span class="n">min6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">mini5</span> <span class="o">-</span> <span class="n">stats</span><span class="o">.</span><span class="n">mini6</span><span class="p">))</span>
    <span class="n">intercept</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">min5</span> <span class="o">-</span> <span class="n">stats</span><span class="o">.</span><span class="n">mini5</span><span class="o">*</span><span class="n">gradient</span>
    <span class="n">linearBackground3</span> <span class="o">=</span> <span class="p">(</span><span class="n">gradient</span> <span class="o">*</span> <span class="n">waveNumber</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="n">intercept</span>
    <span class="k">return</span> <span class="n">linearBackground3</span>

<span class="c1"># Finally apply our function to the columns of the dataframe (except the wavenumber column)</span>
<span class="c1"># We specify axis=0 to operate on the columns (confusingly this is referred to as *along*</span>
<span class="c1"># the index direction in the docs), and pass the first (wavenumber) column and the summary </span>
<span class="c1"># statistics dataframe, wrapped in a tuple, as the `args` argument.</span>
<span class="n">backgroundsA</span> <span class="o">=</span> <span class="n">DR1_A_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">computeLinearBackground1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">DR1_A_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dataStats</span><span class="p">))</span>
<span class="n">backgroundsB</span> <span class="o">=</span> <span class="n">DR1_B_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">computeLinearBackground2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">DR1_B_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dataStats</span><span class="p">))</span>
<span class="n">backgroundsC</span> <span class="o">=</span> <span class="n">DR1_C_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">computeLinearBackground3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">DR1_C_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dataStats</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                      min1  mini1      min2  mini2      min3  mini3      min4  \
ASW_2020_09_15_1 -0.017293   6630 -0.009476   4293 -0.009151   4147  0.001203   
ASW_2020_09_15_2 -0.017489   6636 -0.008995   4161 -0.009001   4132  0.002430   
ASW_2020_09_15_3 -0.017849   6636 -0.009715   4151 -0.009664   4132  0.001595   
ASW_2020_09_15_4 -0.006971   6630 -0.004298   4149 -0.004222   4120  0.002220   

                  mini4      min5  mini5      min6  mini6  
ASW_2020_09_15_1   2482  0.001967   2281  0.008001    490  
ASW_2020_09_15_2   2480  0.003482   2281  0.009177    474  
ASW_2020_09_15_3   2463  0.003063   2269  0.007827    476  
ASW_2020_09_15_4   2473  0.002968   2279  0.006000    829  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DR1_A_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ASW_2020_09_15_1</th>
      <th>ASW_2020_09_15_2</th>
      <th>ASW_2020_09_15_3</th>
      <th>ASW_2020_09_15_4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4150</th>
      <td>-0.009130</td>
      <td>-0.008821</td>
      <td>-0.009361</td>
      <td>-0.003996</td>
    </tr>
    <tr>
      <th>4151</th>
      <td>-0.009195</td>
      <td>-0.008979</td>
      <td>-0.009715</td>
      <td>-0.004211</td>
    </tr>
    <tr>
      <th>4152</th>
      <td>-0.009130</td>
      <td>-0.008795</td>
      <td>-0.009248</td>
      <td>-0.003892</td>
    </tr>
    <tr>
      <th>4153</th>
      <td>-0.009187</td>
      <td>-0.008920</td>
      <td>-0.009556</td>
      <td>-0.004054</td>
    </tr>
    <tr>
      <th>4154</th>
      <td>-0.009117</td>
      <td>-0.008657</td>
      <td>-0.009055</td>
      <td>-0.003850</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6634</th>
      <td>-0.017155</td>
      <td>-0.016794</td>
      <td>-0.016967</td>
      <td>-0.006420</td>
    </tr>
    <tr>
      <th>6635</th>
      <td>-0.017126</td>
      <td>-0.017087</td>
      <td>-0.017292</td>
      <td>-0.006350</td>
    </tr>
    <tr>
      <th>6636</th>
      <td>-0.017211</td>
      <td>-0.017489</td>
      <td>-0.017849</td>
      <td>-0.006541</td>
    </tr>
    <tr>
      <th>6637</th>
      <td>-0.017211</td>
      <td>-0.016742</td>
      <td>-0.017107</td>
      <td>-0.006789</td>
    </tr>
    <tr>
      <th>6638</th>
      <td>-0.017199</td>
      <td>-0.016014</td>
      <td>-0.016281</td>
      <td>-0.006947</td>
    </tr>
  </tbody>
</table>
<p>2489 rows √ó 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#min1</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="minimum-within-a-range-smoothing">
<h3>Minimum within a range + Smoothing<a class="headerlink" href="#minimum-within-a-range-smoothing" title="Permalink to this headline">¬∂</a></h3>
<p><span class="math notranslate nohighlight">\(\color{red}{\text{In the making - not ready}}\)</span></p>
<p><a class="reference external" href="https://scipy-cookbook.readthedocs.io/items/SignalSmooth.html">https://scipy-cookbook.readthedocs.io/items/SignalSmooth.html</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">smooth</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">window_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">window</span><span class="o">=</span><span class="s1">&#39;flat&#39;</span><span class="p">):</span>
    <span class="n">s</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">window_len</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="n">window_len</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">w</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">window_len</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
    <span class="n">y</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">w</span><span class="o">/</span><span class="n">w</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span><span class="n">s</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;valid&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">min1B</span> <span class="o">=</span> <span class="n">All_RAW_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">6223</span><span class="p">:</span><span class="mi">6639</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#min1B</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#for x in min1B:</span>
<span class="c1">#    print(x)</span>
<span class="c1">#    z = smooth(x,window_len=5,window=&#39;flat&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#print(z)</span>
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(\color{red}{\text{To perform with a single value and not a range}}\)</span></p>
</div>
<div class="section" id="minimum-using-single-value-same-for-all-scans">
<h3>Minimum Using single value (same for all scans)<a class="headerlink" href="#minimum-using-single-value-same-for-all-scans" title="Permalink to this headline">¬∂</a></h3>
<p>Check the difference between those different baseline correction method</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">All_RAW_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Wavenumber</th>
      <th>ASW_2020_09_15_1</th>
      <th>ASW_2020_09_15_2</th>
      <th>ASW_2020_09_15_3</th>
      <th>ASW_2020_09_15_4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>799.8442</td>
      <td>0.070200</td>
      <td>0.086859</td>
      <td>0.080537</td>
      <td>0.055492</td>
    </tr>
    <tr>
      <th>1</th>
      <td>800.3264</td>
      <td>0.069613</td>
      <td>0.085440</td>
      <td>0.084133</td>
      <td>0.045511</td>
    </tr>
    <tr>
      <th>2</th>
      <td>800.8085</td>
      <td>0.069002</td>
      <td>0.081987</td>
      <td>0.086396</td>
      <td>0.034734</td>
    </tr>
    <tr>
      <th>3</th>
      <td>801.2906</td>
      <td>0.069099</td>
      <td>0.078084</td>
      <td>0.083552</td>
      <td>0.036551</td>
    </tr>
    <tr>
      <th>4</th>
      <td>801.7727</td>
      <td>0.068733</td>
      <td>0.076453</td>
      <td>0.081117</td>
      <td>0.039316</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6634</th>
      <td>3998.2570</td>
      <td>-0.017155</td>
      <td>-0.016794</td>
      <td>-0.016967</td>
      <td>-0.006420</td>
    </tr>
    <tr>
      <th>6635</th>
      <td>3998.7390</td>
      <td>-0.017126</td>
      <td>-0.017087</td>
      <td>-0.017292</td>
      <td>-0.006350</td>
    </tr>
    <tr>
      <th>6636</th>
      <td>3999.2210</td>
      <td>-0.017211</td>
      <td>-0.017489</td>
      <td>-0.017849</td>
      <td>-0.006541</td>
    </tr>
    <tr>
      <th>6637</th>
      <td>3999.7030</td>
      <td>-0.017211</td>
      <td>-0.016742</td>
      <td>-0.017107</td>
      <td>-0.006789</td>
    </tr>
    <tr>
      <th>6638</th>
      <td>4000.1850</td>
      <td>-0.017199</td>
      <td>-0.016014</td>
      <td>-0.016281</td>
      <td>-0.006947</td>
    </tr>
  </tbody>
</table>
<p>6639 rows √ó 5 columns</p>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="u-baseline-correction-u">
<h2><u>Baseline correction</u><a class="headerlink" href="#u-baseline-correction-u" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="data-background-subtraction">
<h3>data - background subtraction<a class="headerlink" href="#data-background-subtraction" title="Permalink to this headline">¬∂</a></h3>
<div class="section" id="asw">
<h4>ASW<a class="headerlink" href="#asw" title="Permalink to this headline">¬∂</a></h4>
<p>Previous step produced a background for each data range (A,B,C). We will now substract this background to the data and create new BC Data frame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataA_BC</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">DR1_A_df</span> <span class="o">-</span> <span class="n">backgroundsA</span><span class="p">)</span>
<span class="n">dataB_BC</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">DR1_B_df</span> <span class="o">-</span> <span class="n">backgroundsB</span><span class="p">)</span>
<span class="n">dataC_BC</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">DR1_C_df</span> <span class="o">-</span> <span class="n">backgroundsC</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataA_BC</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ASW_2020_09_15_1</th>
      <th>ASW_2020_09_15_2</th>
      <th>ASW_2020_09_15_3</th>
      <th>ASW_2020_09_15_4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4150</th>
      <td>-0.000132</td>
      <td>0.000136</td>
      <td>0.000351</td>
      <td>0.000303</td>
    </tr>
    <tr>
      <th>4151</th>
      <td>-0.000193</td>
      <td>-0.000019</td>
      <td>0.000000</td>
      <td>0.000090</td>
    </tr>
    <tr>
      <th>4152</th>
      <td>-0.000125</td>
      <td>0.000169</td>
      <td>0.000470</td>
      <td>0.000409</td>
    </tr>
    <tr>
      <th>4153</th>
      <td>-0.000179</td>
      <td>0.000047</td>
      <td>0.000165</td>
      <td>0.000248</td>
    </tr>
    <tr>
      <th>4154</th>
      <td>-0.000105</td>
      <td>0.000314</td>
      <td>0.000669</td>
      <td>0.000454</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6634</th>
      <td>0.000151</td>
      <td>0.000688</td>
      <td>0.000876</td>
      <td>0.000556</td>
    </tr>
    <tr>
      <th>6635</th>
      <td>0.000183</td>
      <td>0.000399</td>
      <td>0.000554</td>
      <td>0.000626</td>
    </tr>
    <tr>
      <th>6636</th>
      <td>0.000101</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000436</td>
    </tr>
    <tr>
      <th>6637</th>
      <td>0.000105</td>
      <td>0.000750</td>
      <td>0.000746</td>
      <td>0.000190</td>
    </tr>
    <tr>
      <th>6638</th>
      <td>0.000120</td>
      <td>0.001481</td>
      <td>0.001575</td>
      <td>0.000033</td>
    </tr>
  </tbody>
</table>
<p>2489 rows √ó 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataA_BC_U</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Wavenumber</th>
      <th>ASW_2020_09_15_1</th>
      <th>ASW_2020_09_15_2</th>
      <th>ASW_2020_09_15_3</th>
      <th>ASW_2020_09_15_4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4150</th>
      <td>2800.660</td>
      <td>-0.000013</td>
      <td>-0.000642</td>
      <td>-0.000835</td>
      <td>-0.000644</td>
    </tr>
    <tr>
      <th>4151</th>
      <td>2801.142</td>
      <td>-0.000075</td>
      <td>-0.000798</td>
      <td>-0.001186</td>
      <td>-0.000858</td>
    </tr>
    <tr>
      <th>4152</th>
      <td>2801.624</td>
      <td>-0.000008</td>
      <td>-0.000611</td>
      <td>-0.000716</td>
      <td>-0.000538</td>
    </tr>
    <tr>
      <th>4153</th>
      <td>2802.106</td>
      <td>-0.000062</td>
      <td>-0.000733</td>
      <td>-0.001022</td>
      <td>-0.000699</td>
    </tr>
    <tr>
      <th>4154</th>
      <td>2802.589</td>
      <td>0.000011</td>
      <td>-0.000467</td>
      <td>-0.000518</td>
      <td>-0.000494</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6634</th>
      <td>3998.257</td>
      <td>-0.001267</td>
      <td>-0.001682</td>
      <td>-0.001590</td>
      <td>-0.000650</td>
    </tr>
    <tr>
      <th>6635</th>
      <td>3998.739</td>
      <td>-0.001235</td>
      <td>-0.001972</td>
      <td>-0.001912</td>
      <td>-0.000579</td>
    </tr>
    <tr>
      <th>6636</th>
      <td>3999.221</td>
      <td>-0.001318</td>
      <td>-0.002371</td>
      <td>-0.002467</td>
      <td>-0.000769</td>
    </tr>
    <tr>
      <th>6637</th>
      <td>3999.703</td>
      <td>-0.001315</td>
      <td>-0.001622</td>
      <td>-0.001722</td>
      <td>-0.001016</td>
    </tr>
    <tr>
      <th>6638</th>
      <td>4000.185</td>
      <td>-0.001300</td>
      <td>-0.000891</td>
      <td>-0.000893</td>
      <td>-0.001173</td>
    </tr>
  </tbody>
</table>
<p>2489 rows √ó 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataB_BC_U</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Wavenumber</th>
      <th>ASW_2020_09_15_1</th>
      <th>ASW_2020_09_15_2</th>
      <th>ASW_2020_09_15_3</th>
      <th>ASW_2020_09_15_4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2282</th>
      <td>1900.052</td>
      <td>0.000006</td>
      <td>0.000044</td>
      <td>0.000778</td>
      <td>0.000728</td>
    </tr>
    <tr>
      <th>2283</th>
      <td>1900.534</td>
      <td>-0.000008</td>
      <td>-0.000093</td>
      <td>0.000784</td>
      <td>0.000506</td>
    </tr>
    <tr>
      <th>2284</th>
      <td>1901.016</td>
      <td>0.000045</td>
      <td>0.000390</td>
      <td>0.001095</td>
      <td>0.001341</td>
    </tr>
    <tr>
      <th>2285</th>
      <td>1901.498</td>
      <td>0.000024</td>
      <td>0.000294</td>
      <td>0.000839</td>
      <td>0.000854</td>
    </tr>
    <tr>
      <th>2286</th>
      <td>1901.980</td>
      <td>0.000037</td>
      <td>0.000666</td>
      <td>0.000365</td>
      <td>0.000785</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4145</th>
      <td>2798.250</td>
      <td>0.000043</td>
      <td>0.000258</td>
      <td>0.000305</td>
      <td>0.000137</td>
    </tr>
    <tr>
      <th>4146</th>
      <td>2798.732</td>
      <td>0.000079</td>
      <td>0.000276</td>
      <td>0.000493</td>
      <td>0.000408</td>
    </tr>
    <tr>
      <th>4147</th>
      <td>2799.214</td>
      <td>0.000035</td>
      <td>0.000251</td>
      <td>0.000200</td>
      <td>0.000027</td>
    </tr>
    <tr>
      <th>4148</th>
      <td>2799.696</td>
      <td>0.000077</td>
      <td>0.000269</td>
      <td>0.000392</td>
      <td>0.000284</td>
    </tr>
    <tr>
      <th>4149</th>
      <td>2800.178</td>
      <td>0.000022</td>
      <td>0.000137</td>
      <td>0.000002</td>
      <td>-0.000045</td>
    </tr>
  </tbody>
</table>
<p>1868 rows √ó 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataC_BC_U</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Wavenumber</th>
      <th>ASW_2020_09_15_1</th>
      <th>ASW_2020_09_15_2</th>
      <th>ASW_2020_09_15_3</th>
      <th>ASW_2020_09_15_4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>799.8442</td>
      <td>0.060315</td>
      <td>0.074960</td>
      <td>0.069092</td>
      <td>0.047724</td>
    </tr>
    <tr>
      <th>1</th>
      <td>800.3264</td>
      <td>0.059731</td>
      <td>0.073545</td>
      <td>0.072690</td>
      <td>0.037745</td>
    </tr>
    <tr>
      <th>2</th>
      <td>800.8085</td>
      <td>0.059123</td>
      <td>0.070095</td>
      <td>0.074955</td>
      <td>0.026969</td>
    </tr>
    <tr>
      <th>3</th>
      <td>801.2906</td>
      <td>0.059223</td>
      <td>0.066195</td>
      <td>0.072115</td>
      <td>0.028787</td>
    </tr>
    <tr>
      <th>4</th>
      <td>801.7727</td>
      <td>0.058860</td>
      <td>0.064567</td>
      <td>0.069682</td>
      <td>0.031553</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2277</th>
      <td>1897.6410</td>
      <td>-0.000748</td>
      <td>-0.000963</td>
      <td>-0.002061</td>
      <td>-0.001357</td>
    </tr>
    <tr>
      <th>2278</th>
      <td>1898.1230</td>
      <td>-0.000715</td>
      <td>-0.000872</td>
      <td>-0.001477</td>
      <td>-0.000688</td>
    </tr>
    <tr>
      <th>2279</th>
      <td>1898.6050</td>
      <td>-0.000801</td>
      <td>-0.001338</td>
      <td>-0.002466</td>
      <td>-0.002058</td>
    </tr>
    <tr>
      <th>2280</th>
      <td>1899.0880</td>
      <td>-0.000787</td>
      <td>-0.001343</td>
      <td>-0.001668</td>
      <td>-0.001105</td>
    </tr>
    <tr>
      <th>2281</th>
      <td>1899.5700</td>
      <td>-0.000847</td>
      <td>-0.001731</td>
      <td>-0.001928</td>
      <td>-0.001739</td>
    </tr>
  </tbody>
</table>
<p>2282 rows √ó 5 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="ethane-samples">
<h4>Ethane samples<a class="headerlink" href="#ethane-samples" title="Permalink to this headline">¬∂</a></h4>
<p><span class="math notranslate nohighlight">\(\color{red}{\text{If Ethane Different baseline nedd to be fitted - polynomial}}\)</span> <br></p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/tutorial/interpolate.html#using-radial-basis-functions-for-smoothing-interpolation">https://docs.scipy.org/doc/scipy/tutorial/interpolate.html#using-radial-basis-functions-for-smoothing-interpolation</a></p>
<p>New range nedd to be created</p>
<p><span class="math notranslate nohighlight">\(\color{red}{\text{If Ethane implement sub range to extract max A for each peak}}\)</span></p>
<p>if statement for sample = C2H6</p>
<p><em><strong>Run specific notebook</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#if spl == &quot;C2H6&quot;:</span>

    <span class="o">%</span><span class="k">run</span> -i &quot;test1.py&quot;

<span class="c1">#elif spl == &quot;C2H6_ASW&quot;:</span>
    
<span class="c1">#    %run -i &quot;test1.py&quot;</span>
    
<span class="c1">#elif spl == &quot;ASW&quot;:</span>
    
<span class="c1">#    print(&#39;its OK bro, carry on&#39;)</span>
    
<span class="c1">#    %run -i &quot;test1.py&quot;</span>
 
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="cleaning-and-sanity-check">
<h3>Cleaning and Sanity Check<a class="headerlink" href="#cleaning-and-sanity-check" title="Permalink to this headline">¬∂</a></h3>
<p>We reinsert the Wavenumber that was removed prior to the baseline function aplied</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataA_BC</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Wavenumber&#39;</span><span class="p">,</span> <span class="n">All_RAW_df</span><span class="p">[</span><span class="s1">&#39;Wavenumber&#39;</span><span class="p">])</span>
<span class="n">dataB_BC</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Wavenumber&#39;</span><span class="p">,</span> <span class="n">All_RAW_df</span><span class="p">[</span><span class="s1">&#39;Wavenumber&#39;</span><span class="p">])</span>
<span class="n">dataC_BC</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Wavenumber&#39;</span><span class="p">,</span> <span class="n">All_RAW_df</span><span class="p">[</span><span class="s1">&#39;Wavenumber&#39;</span><span class="p">])</span>

<span class="n">backgroundsA</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Wavenumber&#39;</span><span class="p">,</span> <span class="n">All_RAW_df</span><span class="p">[</span><span class="s1">&#39;Wavenumber&#39;</span><span class="p">])</span>
<span class="n">backgroundsB</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Wavenumber&#39;</span><span class="p">,</span> <span class="n">All_RAW_df</span><span class="p">[</span><span class="s1">&#39;Wavenumber&#39;</span><span class="p">])</span>
<span class="n">backgroundsC</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Wavenumber&#39;</span><span class="p">,</span> <span class="n">All_RAW_df</span><span class="p">[</span><span class="s1">&#39;Wavenumber&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">81</span><span class="o">-</span><span class="mf">18327e46</span><span class="n">bac9</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">dataA_BC</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Wavenumber&#39;</span><span class="p">,</span> <span class="n">All_RAW_df</span><span class="p">[</span><span class="s1">&#39;Wavenumber&#39;</span><span class="p">])</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">dataB_BC</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Wavenumber&#39;</span><span class="p">,</span> <span class="n">All_RAW_df</span><span class="p">[</span><span class="s1">&#39;Wavenumber&#39;</span><span class="p">])</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">dataC_BC</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Wavenumber&#39;</span><span class="p">,</span> <span class="n">All_RAW_df</span><span class="p">[</span><span class="s1">&#39;Wavenumber&#39;</span><span class="p">])</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> 
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">backgroundsA</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Wavenumber&#39;</span><span class="p">,</span> <span class="n">All_RAW_df</span><span class="p">[</span><span class="s1">&#39;Wavenumber&#39;</span><span class="p">])</span>

<span class="nn">~\Anaconda3\lib\site-packages\pandas\core\frame.py</span> in <span class="ni">insert</span><span class="nt">(self, loc, column, value, allow_duplicates)</span>
<span class="g g-Whitespace">   </span><span class="mi">3494</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_valid_index</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3495</span>         <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sanitize_column</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">broadcast</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3496</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">allow_duplicates</span><span class="o">=</span><span class="n">allow_duplicates</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3497</span> 
<span class="g g-Whitespace">   </span><span class="mi">3498</span>     <span class="k">def</span> <span class="nf">assign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataFrame&quot;</span><span class="p">:</span>

<span class="nn">~\Anaconda3\lib\site-packages\pandas\core\internals\managers.py</span> in <span class="ni">insert</span><span class="nt">(self, loc, item, value, allow_duplicates)</span>
<span class="g g-Whitespace">   </span><span class="mi">1171</span>         <span class="k">if</span> <span class="ow">not</span> <span class="n">allow_duplicates</span> <span class="ow">and</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1172</span>             <span class="c1"># Should this be a different kind of error??</span>
<span class="ne">-&gt; </span><span class="mi">1173</span>             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cannot insert </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">, already exists&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1174</span> 
<span class="g g-Whitespace">   </span><span class="mi">1175</span>         <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>

<span class="ne">ValueError</span>: cannot insert Wavenumber, already exists
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#dataA_BC</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#backgroundsA</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="concatenation">
<h4>Concatenation<a class="headerlink" href="#concatenation" title="Permalink to this headline">¬∂</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">All_data_A</span> <span class="o">=</span> <span class="n">dataC_BC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataB_BC</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">All_data_BC</span> <span class="o">=</span> <span class="n">All_data_A</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataA_BC</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">All_data_BC</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="export-as-csv">
<h4>Export as csv<a class="headerlink" href="#export-as-csv" title="Permalink to this headline">¬∂</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">All_data_BC</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s1">/Samples/</span><span class="si">{}</span><span class="s1">/Data/DR/DR2_</span><span class="si">{}</span><span class="s1">_All-scans.csv&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">date</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="u-max-absorbance-u">
<h2><u>Max Absorbance</u><a class="headerlink" href="#u-max-absorbance-u" title="Permalink to this headline">¬∂</a></h2>
<p>A first step in our analysis is to extract and use the maximum absorbance in order to make a first comparison of the frequency shifts with respect to temperature for each sample.</p>
<div class="section" id="preliminary-steps">
<h3>Preliminary steps<a class="headerlink" href="#preliminary-steps" title="Permalink to this headline">¬∂</a></h3>
<div class="section" id="range-b">
<h4>Range B<a class="headerlink" href="#range-b" title="Permalink to this headline">¬∂</a></h4>
<p>For range B (combination modes), we need to supress the CO2 signature (that would otherwise contribute to the max A value for this range). As a first guess we aim to supress data from 2390 to 2290 wavenumber</p>
<p><em><strong>Find index based on column value</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#dataB_BC[(dataB_BC[&#39;Wavenumber&#39;] &gt; 2388) &amp; (dataB_BC[&#39;Wavenumber&#39;] &lt; 2392)].index.tolist()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#dataB_BC.loc[3299, &#39;Wavenumber&#39;]</span>
</pre></div>
</div>
</div>
</div>
<p><em><strong>Supress data within a specified range</strong></em></p>
<p>Create a new dataframe where the datapoints corresponding to the absorbtion of CO2 is suppressed. (value are different than the one above because the index was reinitialised (simple substraction do the trick))</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataB_BC_U</span> <span class="o">=</span> <span class="n">dataB_BC</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">dataB_BC</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">808</span><span class="p">:</span><span class="mi">1016</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#dataB_BC_U</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="range-c">
<h4>Range C<a class="headerlink" href="#range-c" title="Permalink to this headline">¬∂</a></h4>
<p>Concerning range C, we are only aiming for the maximum absorbance of the bending modes but the libration modes have a contribution more important. However the peak is incomplete and we need to supress it. <br>
Same approach as previously will be used and we aim to cut the data at wavenumber = 1040 cm-1</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#dataC_BC[(dataC_BC[&#39;Wavenumber&#39;] &gt; 1038) &amp; (dataC_BC[&#39;Wavenumber&#39;] &lt; 1042)].index.tolist()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataC_BC_U</span> <span class="o">=</span> <span class="n">dataC_BC</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">dataC_BC</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">498</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#dataC_BC_U</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="extract-max-a">
<h3>Extract max A<a class="headerlink" href="#extract-max-a" title="Permalink to this headline">¬∂</a></h3>
<p>Here we look for 4 maximum:</p>
<ul class="simple">
<li><p>two for the range A (1 with the baseline corrected scan and one from the unreduced data, to check that they concord and that the reduction routine does not affect the spectral signature)</p></li>
<li><p>one for range B (using dataB_BC_U that excude the CO2 signature)</p></li>
<li><p>one for range C (using dataC_BC_U that excude the libration modes)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Data max from unreduced data in range A </span>

<span class="n">dataA_Max</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
  <span class="nb">dict</span><span class="p">(</span><span class="n">maxA0</span><span class="o">=</span><span class="n">DR1_A_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="c1"># min within rows 6000 - end</span>
       <span class="n">maxA0i</span><span class="o">=</span><span class="n">DR1_A_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>  

        <span class="p">)</span>
<span class="p">)</span>

<span class="c1">#Data max from Baseline Corrected Data in range A </span>

<span class="n">dataA_BC_Max</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
  <span class="nb">dict</span><span class="p">(</span><span class="n">maxA</span><span class="o">=</span><span class="n">dataA_BC</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="c1"># min within rows 6000 - end</span>
       <span class="n">maxAi</span><span class="o">=</span><span class="n">dataA_BC</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>  

        <span class="p">)</span>
<span class="p">)</span>

<span class="c1">#Data max from Baseline Corrected Data in range B</span>

<span class="n">dataB_BC_Max</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
  <span class="nb">dict</span><span class="p">(</span><span class="n">maxB</span><span class="o">=</span><span class="n">dataB_BC_U</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="c1"># min within rows 6000 - end</span>
       <span class="n">maxBi</span><span class="o">=</span><span class="n">dataB_BC_U</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>  

        <span class="p">)</span>
<span class="p">)</span>

<span class="c1">#Data max from Baseline Corrected Data in range C</span>

<span class="n">dataC_BC_Max</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
  <span class="nb">dict</span><span class="p">(</span><span class="n">maxC</span><span class="o">=</span><span class="n">dataC_BC_U</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="c1"># min within rows 6000 - end</span>
       <span class="n">maxCi</span><span class="o">=</span><span class="n">dataC_BC_U</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>  

        <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataA_BC_Max</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#dataA_Max</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="clean">
<h3>Clean<a class="headerlink" href="#clean" title="Permalink to this headline">¬∂</a></h3>
<p>Describe</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavelength</span> <span class="o">=</span> <span class="n">All_RAW_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># A DR2</span>

<span class="n">dataA_BC_Max</span> <span class="o">=</span> <span class="n">dataA_BC_Max</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">dataA_BC_Max</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataA_BC_Max</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span>
<span class="n">dataA_BC_Max</span> <span class="o">=</span> <span class="n">dataA_BC_Max</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>

<span class="n">dataA_BC_Max1</span> <span class="o">=</span> <span class="n">dataA_BC_Max</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;maxAi&#39;</span><span class="p">,</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dataA_BC_Max2</span> <span class="o">=</span> <span class="n">dataA_BC_Max1</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;maxAi&#39;</span><span class="p">)</span>
<span class="n">dataA_BC_Max2</span> <span class="o">=</span> <span class="n">dataA_BC_Max2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">dataA_BC_Max_F</span> <span class="o">=</span> <span class="n">dataA_BC_Max2</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">dataA_BC_Max</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">dataA_BC_Max_F</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Wavenumber&#39;</span><span class="p">:</span> <span class="s1">&#39;maxAw&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># A DR1</span>

<span class="n">dataA_Max</span> <span class="o">=</span> <span class="n">dataA_Max</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">dataA_Max</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataA_Max</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span>
<span class="n">dataA_Max</span> <span class="o">=</span> <span class="n">dataA_Max</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>

<span class="n">dataA_Max1</span> <span class="o">=</span> <span class="n">dataA_Max</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;maxA0i&#39;</span><span class="p">,</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dataA_Max2</span> <span class="o">=</span> <span class="n">dataA_Max1</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;maxA0i&#39;</span><span class="p">)</span>
<span class="n">dataA_Max2</span> <span class="o">=</span> <span class="n">dataA_Max2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">dataA_Max_F</span> <span class="o">=</span> <span class="n">dataA_Max2</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">dataA_Max</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">dataA_Max_F</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Wavenumber&#39;</span><span class="p">:</span> <span class="s1">&#39;maxA0w&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># B DR2</span>



<span class="n">dataB_BC_Max</span> <span class="o">=</span> <span class="n">dataB_BC_Max</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">dataB_BC_Max</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataB_BC_Max</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span>
<span class="n">dataB_BC_Max</span> <span class="o">=</span> <span class="n">dataB_BC_Max</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>

<span class="n">dataB_BC_Max1</span> <span class="o">=</span> <span class="n">dataB_BC_Max</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;maxBi&#39;</span><span class="p">,</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dataB_BC_Max2</span> <span class="o">=</span> <span class="n">dataB_BC_Max1</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;maxBi&#39;</span><span class="p">)</span>
<span class="n">dataB_BC_Max2</span> <span class="o">=</span> <span class="n">dataB_BC_Max2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">dataB_BC_Max_F</span> <span class="o">=</span> <span class="n">dataB_BC_Max2</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">dataB_BC_Max</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">dataB_BC_Max_F</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Wavenumber&#39;</span><span class="p">:</span> <span class="s1">&#39;maxBw&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># C DR2</span>

<span class="n">dataC_BC_Max</span> <span class="o">=</span> <span class="n">dataC_BC_Max</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">dataC_BC_Max</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataC_BC_Max</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span>
<span class="n">dataC_BC_Max</span> <span class="o">=</span> <span class="n">dataC_BC_Max</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>

<span class="n">dataC_BC_Max1</span> <span class="o">=</span> <span class="n">dataC_BC_Max</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;maxCi&#39;</span><span class="p">,</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dataC_BC_Max2</span> <span class="o">=</span> <span class="n">dataC_BC_Max1</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;maxCi&#39;</span><span class="p">)</span>
<span class="n">dataC_BC_Max2</span> <span class="o">=</span> <span class="n">dataC_BC_Max2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">dataC_BC_Max_F</span> <span class="o">=</span> <span class="n">dataC_BC_Max2</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">dataC_BC_Max</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">dataC_BC_Max_F</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Wavenumber&#39;</span><span class="p">:</span> <span class="s1">&#39;maxCw&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#dataA_Max_F</span>
</pre></div>
</div>
</div>
</div>
<p><em><strong>Insert column scan number</strong></em></p>
<p>to be able to link data_annex with XP_Ramp_df</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dataA_BC_Max_F</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
<span class="n">scan_number</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nscan</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">scan_number</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataA_BC_Max_F</span><span class="p">[</span><span class="s1">&#39;scan_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scan_number</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#dataA_BC_Max_F</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#dataB_BC_Max_F</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#dataC_BC_Max_F</span>
</pre></div>
</div>
</div>
</div>
<p><em><strong>Insert column Time stamp ?</strong></em></p>
<p>add time stamp for scan where interuption of T ramp</p>
<p>2 time stamp:</p>
<ul class="simple">
<li><p>real time</p></li>
<li><p>relative time</p></li>
</ul>
<p>Check the possibility for input type implementation</p>
<p><a class="reference external" href="https://stackoverflow.com/questions/36932759/pandas-adding-new-column-to-dataframe-which-is-a-copy-of-the-index-column">Slack Overflow time stamp insertion</a></p>
<p>create two empty column type datetime</p>
<p>May be best to implement in excell when need be</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#data[&quot;Date&quot;] = pd.to_datetime(data[&quot;Date&quot;], format=&quot;%Y-%m-%d&quot;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#data_anex_df</span>
</pre></div>
</div>
</div>
</div>
<p>Find a way to display entirely and scroll within</p>
<p><span class="math notranslate nohighlight">\(\color{red}{\text{Implement Observation on lab-book}}\)</span></p>
<ul class="simple">
<li><p>Max A</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#data_anex_df[&#39;Real_T&#39;] = scan_number</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#dt_string = &quot;{}_&quot;+str(input(&#39;Enter date(hh-mm): &#39;)).format(date)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#dt_string</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#dt_object1 = datetime.strptime(dt_string, &quot;%Y_%m_%d_%H%M&quot;)</span>
<span class="c1">#print(&quot;dt_object1 =&quot;, dt_object1)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="append-to-data-annex">
<h3>Append to data Annex<a class="headerlink" href="#append-to-data-annex" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#data_anex_df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_anex_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data_anex_df</span><span class="p">,</span> <span class="n">dataA_BC_Max_F</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_anex_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data_anex_df</span><span class="p">,</span> <span class="n">dataA_Max_F</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_anex_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data_anex_df</span><span class="p">,</span> <span class="n">dataB_BC_Max_F</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_anex_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data_anex_df</span><span class="p">,</span> <span class="n">dataC_BC_Max_F</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#data_anex_df </span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="id1">
<h2><u>Plotting</u><a class="headerlink" href="#id1" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="full-range">
<h3>Full range<a class="headerlink" href="#full-range" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dataA_BC</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="n">ymax</span> <span class="o">=</span>   <span class="n">data_anex_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">16</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">ymin</span> <span class="o">=</span>   <span class="n">data_anex_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">16</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">ymax2</span> <span class="o">=</span> <span class="n">ymax</span> <span class="o">+</span> <span class="mf">0.01</span>
<span class="n">ymin2</span> <span class="o">=</span> <span class="n">ymin</span> <span class="o">-</span> <span class="mf">0.01</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">All_RAW_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>


<span class="n">fig</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>


<span class="n">normalize</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">nscan</span><span class="p">)</span>
<span class="n">colormap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">jet</span>
<span class="n">i</span><span class="o">=</span><span class="mi">1</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nscan</span><span class="p">):</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">All_data_BC</span><span class="o">.</span><span class="n">Wavenumber</span><span class="p">,</span> <span class="n">All_data_BC</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spl</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">i</span><span class="p">)],</span> <span class="n">color</span><span class="o">=</span><span class="n">colormap</span><span class="p">(</span><span class="n">normalize</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
    
    <span class="n">i</span><span class="o">=+</span><span class="mi">1</span>
    

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;DR2 Baseline Corrected </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">4000</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.45</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wavenumber (cm-1)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Absorbance&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="c1">#ax = fig.gca()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="c1">#plt.legend()</span>

<span class="n">scalarmappaple</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">normalize</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">colormap</span><span class="p">)</span>
<span class="n">scalarmappaple</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scalarmappaple</span><span class="p">)</span>

<span class="c1">#plt.savefig(&#39;D:\DATA-Processing\PAC\{}/Samples/{}/Plots/DR/DR2_{}_Full-range.png&#39;.format(XP, date, date))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id2">
<h3>Oh stretch<a class="headerlink" href="#id2" title="Permalink to this headline">¬∂</a></h3>
<div class="section" id="baseline-correction">
<h4>Baseline correction<a class="headerlink" href="#baseline-correction" title="Permalink to this headline">¬∂</a></h4>
<p>Insert in legend parameters of BC from data_annex</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dataA_BC</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="n">nscan2</span> <span class="o">=</span> <span class="n">nscan</span><span class="o">//</span><span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">nscan1</span> <span class="o">=</span> <span class="n">nscan2</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="n">figure</span><span class="p">,</span> <span class="n">panels</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">nscan1</span><span class="p">),</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="n">nscan2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">panel</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">panels</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">dataA_BC</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">panel</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dataA_BC</span><span class="o">.</span><span class="n">Wavenumber</span><span class="p">,</span> <span class="n">dataA_BC</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
    <span class="n">panel</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dataA_BC</span><span class="o">.</span><span class="n">Wavenumber</span><span class="p">,</span> <span class="n">backgroundsA</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span>  <span class="n">label</span><span class="o">=</span><span class="s2">&quot;bg&quot;</span><span class="p">)</span>

    <span class="n">panel</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dataA_BC</span><span class="o">.</span><span class="n">Wavenumber</span><span class="p">,</span> <span class="n">dataA_BC</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">+</span> <span class="n">backgroundsA</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;dotted&quot;</span><span class="p">,</span>  <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data+bg (RAW)&quot;</span><span class="p">)</span>

    
    
    <span class="c1">#panel.legend()</span>
    <span class="n">panel</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;wavenumber&quot;</span><span class="p">)</span>
    <span class="n">panel</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
    <span class="n">panel</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
    <span class="n">panel</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s1">/Samples/</span><span class="si">{}</span><span class="s1">/Plots/DR/DR2_</span><span class="si">{}</span><span class="s1">_BCA.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">date</span><span class="p">))</span>

    
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    
<span class="c1">#plt.tight_layout()</span>
    
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="all-scans">
<h4>All scans<a class="headerlink" href="#all-scans" title="Permalink to this headline">¬∂</a></h4>
<p>(using scan number - All data)
<br>
Idea for later : plot OH and maxA together</p>
<p><a class="reference external" href="https://matplotlib.org/stable/api/markers_api.html">Marker modification</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">All_RAW_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>


<span class="n">fig</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>


<span class="n">normalize</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">nscan</span><span class="p">)</span>
<span class="n">colormap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">jet</span>
<span class="n">i</span><span class="o">=</span><span class="mi">1</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nscan</span><span class="p">):</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dataA_BC</span><span class="o">.</span><span class="n">Wavenumber</span><span class="p">,</span> <span class="n">dataA_BC</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spl</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">i</span><span class="p">)],</span> <span class="n">color</span><span class="o">=</span><span class="n">colormap</span><span class="p">(</span><span class="n">normalize</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
    
    <span class="n">i</span><span class="o">=+</span><span class="mi">1</span>
    

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;DR2-A Baseline Corrected </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">3800</span><span class="p">,</span><span class="mi">2800</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wavenumber (cm-1)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Absorbance&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="c1">#ax = fig.gca()</span>
<span class="c1">#plt.grid()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">scalarmappaple</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">normalize</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">colormap</span><span class="p">)</span>
<span class="n">scalarmappaple</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scalarmappaple</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s1">/Samples/</span><span class="si">{}</span><span class="s1">/Plots/DR/DR2_</span><span class="si">{}</span><span class="s1">_A.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">date</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="a-4b-all-scans-using-dictionnary-vale-discrete-t">
<h4>2.4.A.4b All scans (using dictionnary vale - discrete T)<a class="headerlink" href="#a-4b-all-scans-using-dictionnary-vale-discrete-t" title="Permalink to this headline">¬∂</a></h4>
<p>later</p>
</div>
<div class="section" id="a-4-max-absorbance-peak-frequency-shift-clean">
<h4>2.4.A.4 Max Absorbance (peak frequency shift) - Clean<a class="headerlink" href="#a-4-max-absorbance-peak-frequency-shift-clean" title="Permalink to this headline">¬∂</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="k">for</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">Tdictionary</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">data_anex_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">values</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">values</span><span class="o">/</span><span class="n">nscan</span><span class="p">),</span><span class="n">label</span><span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; - &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">values</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; - &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data_anex_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">values</span><span class="p">,</span><span class="mi">17</span><span class="p">])))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">data_anex_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">values</span><span class="p">,</span><span class="mi">21</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">values</span><span class="o">/</span><span class="n">nscan</span><span class="p">),</span><span class="n">label</span><span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; - &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">values</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; - &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data_anex_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">values</span><span class="p">,</span><span class="mi">21</span><span class="p">])))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> DR2 OH stretch Peak frequency (DR1-DR2 comparison)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="p">))</span>
<span class="c1">#plt.axis([3210,3270])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Peak frequency (cm-1)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="c1">#ax = fig.gca()</span>
<span class="c1">#plt.grid()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>


<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s1">/Samples/</span><span class="si">{}</span><span class="s1">/Plots/DR/DR2_</span><span class="si">{}</span><span class="s1">_PeakA-frequency_wA0.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">date</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="a-5-max-absorbance-peak-frequency-shift-isotherm-1">
<h4>2.4.A.5 Max Absorbance (peak frequency shift) - Isotherm 1<a class="headerlink" href="#a-5-max-absorbance-peak-frequency-shift-isotherm-1" title="Permalink to this headline">¬∂</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">Iso</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">Isodic1</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">data_anex_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">values</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">values</span><span class="o">/</span><span class="n">nscan</span><span class="p">),</span><span class="n">label</span><span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; - &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">values</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; - &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data_anex_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">values</span><span class="p">,</span><span class="mi">17</span><span class="p">])))</span>
        
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> DR2 OH stretch Peak frequency Isotherm at </span><span class="si">{1}</span><span class="s1"> K&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="p">,</span><span class="n">Tiso1</span><span class="p">))</span>
    <span class="c1">#plt.axis([3210,3270])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (h)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Peak frequency (cm-1)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>    
    <span class="c1">#plt.grid()</span>
    <span class="c1">#plt.legend()</span>


    <span class="c1">#plt.savefig(&#39;D:\DATA-Processing\PAC\{}/Samples/{}/Plots/DR/DR2_{}_PeakA-frequency_Iso_{}.png&#39;.format(XP, date, date, Tiso1))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">Iso</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">Isodic1</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">data_anex_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">values</span><span class="p">,</span><span class="mi">16</span><span class="p">],</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">values</span><span class="o">/</span><span class="n">nscan</span><span class="p">),</span><span class="n">label</span><span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; - &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">values</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; - &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data_anex_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">values</span><span class="p">,</span><span class="mi">17</span><span class="p">])))</span>
        
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> DR2 Max A Isotherm at </span><span class="si">{1}</span><span class="s1"> K&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="p">,</span><span class="n">Tiso1</span><span class="p">))</span>
    <span class="c1">#plt.axis([3210,3270])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (h)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Peak frequency (cm-1)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>    
    <span class="c1">#plt.grid()</span>
    <span class="c1">#plt.legend()</span>


    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s1">/Samples/</span><span class="si">{}</span><span class="s1">/Plots/DR/DR2_</span><span class="si">{}</span><span class="s1">_max_A_Iso_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">Tiso1</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="b-comb-bands">
<h3>2.4.B Comb Bands<a class="headerlink" href="#b-comb-bands" title="Permalink to this headline">¬∂</a></h3>
<div class="section" id="b-1-baseline-correction">
<h4>2.4.B.1 Baseline correction<a class="headerlink" href="#b-1-baseline-correction" title="Permalink to this headline">¬∂</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dataB_BC</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="n">nscan2</span> <span class="o">=</span> <span class="n">nscan</span><span class="o">//</span><span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">nscan1</span> <span class="o">=</span> <span class="n">nscan2</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="n">figure</span><span class="p">,</span> <span class="n">panels</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">nscan1</span><span class="p">),</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="n">nscan2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">panel</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">panels</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">dataB_BC</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">panel</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dataB_BC</span><span class="o">.</span><span class="n">Wavenumber</span><span class="p">,</span> <span class="n">dataB_BC</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
    <span class="n">panel</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dataB_BC</span><span class="o">.</span><span class="n">Wavenumber</span><span class="p">,</span> <span class="n">backgroundsB</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span>  <span class="n">label</span><span class="o">=</span><span class="s2">&quot;bg&quot;</span><span class="p">)</span>

    <span class="n">panel</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dataB_BC</span><span class="o">.</span><span class="n">Wavenumber</span><span class="p">,</span> <span class="n">dataB_BC</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">+</span> <span class="n">backgroundsB</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;dotted&quot;</span><span class="p">,</span>  <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data+bg (RAW)&quot;</span><span class="p">)</span>

    
    
    <span class="c1">#panel.legend()</span>
    <span class="n">panel</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;wavenumber&quot;</span><span class="p">)</span>
    <span class="n">panel</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
    <span class="n">panel</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
    <span class="n">panel</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s1">/Samples/</span><span class="si">{}</span><span class="s1">/Plots/DR/DR2_</span><span class="si">{}</span><span class="s1">_BCB.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">date</span><span class="p">))</span>

    
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    
<span class="c1">#plt.tight_layout()</span>
    
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="b-2-backgrounds">
<h4>2.4.B.2 Backgrounds<a class="headerlink" href="#b-2-backgrounds" title="Permalink to this headline">¬∂</a></h4>
</div>
<div class="section" id="b-3-all-scans">
<h4>2.4.B.3 All scans<a class="headerlink" href="#b-3-all-scans" title="Permalink to this headline">¬∂</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">All_RAW_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>


<span class="n">f</span><span class="p">,(</span><span class="n">ax</span><span class="p">,</span><span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>



<span class="n">normalize</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">nscan</span><span class="p">)</span>
<span class="n">colormap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">jet</span>

<span class="n">i</span><span class="o">=</span><span class="mi">1</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nscan</span><span class="p">):</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dataB_BC_U</span><span class="o">.</span><span class="n">Wavenumber</span><span class="p">,</span> <span class="n">dataB_BC_U</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spl</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">i</span><span class="p">)],</span> <span class="n">color</span><span class="o">=</span><span class="n">colormap</span><span class="p">(</span><span class="n">normalize</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dataB_BC_U</span><span class="o">.</span><span class="n">Wavenumber</span><span class="p">,</span> <span class="n">dataB_BC_U</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spl</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">i</span><span class="p">)],</span> <span class="n">color</span><span class="o">=</span><span class="n">colormap</span><span class="p">(</span><span class="n">normalize</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
    
    <span class="n">i</span><span class="o">=+</span><span class="mi">1</span>
    

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">2800</span><span class="p">,</span><span class="mi">2390</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">2290</span><span class="p">,</span><span class="mi">1900</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_left</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="n">d</span> <span class="o">=</span> <span class="o">.</span><span class="mi">022</span> <span class="c1"># how big to make the diagonal lines in axes coordinates</span>
<span class="c1"># arguments to pass plot, just so we don&#39;t keep repeating them</span>
<span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">d</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="o">+</span><span class="n">d</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">d</span><span class="p">),(</span><span class="mi">1</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">d</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">transform</span><span class="o">=</span><span class="n">ax2</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>  <span class="c1"># switch to the bottom axes</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="o">+</span><span class="n">d</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">d</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="o">+</span><span class="n">d</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="o">+</span><span class="n">d</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=.</span><span class="mi">070</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;DR2-B Baseline Corrected </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="p">))</span>
<span class="c1">#plt.axis([2800,1900,0,0.015])</span>
<span class="c1">#plt.xlabel(&#39;Wavenumber (cm-1)&#39;).set_fontsize(13)</span>
<span class="c1">#plt.ylabel(&#39;Absorbance&#39;).set_fontsize(13)</span>
<span class="c1">#ax = fig.gca()</span>
<span class="c1">#plt.grid()</span>
<span class="c1">#plt.legend()</span>

<span class="n">scalarmappaple</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">normalize</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">colormap</span><span class="p">)</span>
<span class="n">scalarmappaple</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scalarmappaple</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s1">/Samples/</span><span class="si">{}</span><span class="s1">/Plots/DR/DR2_</span><span class="si">{}</span><span class="s1">_B.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">date</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="b-4-max-a-redshift">
<h4>2.4.B.4 Max A + Redshift<a class="headerlink" href="#b-4-max-a-redshift" title="Permalink to this headline">¬∂</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="k">for</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">Tdictionary</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">data_anex_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">values</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">values</span><span class="o">/</span><span class="n">nscan</span><span class="p">),</span><span class="n">label</span><span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; - &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">values</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; - &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data_anex_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">values</span><span class="p">,</span><span class="mi">24</span><span class="p">])))</span>
    <span class="c1">#plt.plot(keys, data_anex_df.iloc[values,21], &#39;.&#39;, mew=3, ms=12, c=cm.jet(values/nscan),label= str(keys)+&quot; - &quot;+str(values+1)+&quot; - &quot;+str(int(data_anex_df.iloc[values,21])))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> DR2_B Peak frequency&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="p">))</span>
<span class="c1">#plt.axis([3210,3270])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Peak frequency (cm-1)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="c1">#ax = fig.gca()</span>
<span class="c1">#plt.grid()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>


<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s1">/Samples/</span><span class="si">{}</span><span class="s1">/Plots/DR/DR2_</span><span class="si">{}</span><span class="s1">_PeakB-frequency.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">date</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="c-bending">
<h3>2.4.C Bending<a class="headerlink" href="#c-bending" title="Permalink to this headline">¬∂</a></h3>
<div class="section" id="id3">
<h4>2.4.B.1 Baseline correction<a class="headerlink" href="#id3" title="Permalink to this headline">¬∂</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dataC_BC</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="n">nscan2</span> <span class="o">=</span> <span class="n">nscan</span><span class="o">//</span><span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">nscan1</span> <span class="o">=</span> <span class="n">nscan2</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="n">figure</span><span class="p">,</span> <span class="n">panels</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">nscan1</span><span class="p">),</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="n">nscan2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">panel</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">panels</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">dataC_BC</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">panel</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dataC_BC</span><span class="o">.</span><span class="n">Wavenumber</span><span class="p">,</span> <span class="n">dataC_BC</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
    <span class="n">panel</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dataC_BC</span><span class="o">.</span><span class="n">Wavenumber</span><span class="p">,</span> <span class="n">backgroundsC</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span>  <span class="n">label</span><span class="o">=</span><span class="s2">&quot;bg&quot;</span><span class="p">)</span>

    <span class="n">panel</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dataC_BC</span><span class="o">.</span><span class="n">Wavenumber</span><span class="p">,</span> <span class="n">dataC_BC</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">+</span> <span class="n">backgroundsC</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;dotted&quot;</span><span class="p">,</span>  <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data+bg&quot;</span><span class="p">)</span>

    
    
    <span class="c1">#panel.legend()</span>
    <span class="n">panel</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;wavenumber&quot;</span><span class="p">)</span>
    <span class="n">panel</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
    <span class="n">panel</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
    <span class="n">panel</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s1">/Samples/</span><span class="si">{}</span><span class="s1">/Plots/DR/DR2_</span><span class="si">{}</span><span class="s1">_BCC.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">date</span><span class="p">))</span>

    
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    
<span class="c1">#plt.tight_layout()</span>
    
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id4">
<h4>2.4.B.2 Backgrounds<a class="headerlink" href="#id4" title="Permalink to this headline">¬∂</a></h4>
</div>
<div class="section" id="id5">
<h4>2.4.B.3 All scans<a class="headerlink" href="#id5" title="Permalink to this headline">¬∂</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dataC_BC</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="n">ymax</span> <span class="o">=</span>   <span class="n">data_anex_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">23</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">ymin</span> <span class="o">=</span>   <span class="n">data_anex_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">23</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">ymax2</span> <span class="o">=</span> <span class="n">ymax</span> <span class="o">+</span> <span class="mf">0.005</span>
<span class="n">ymin2</span> <span class="o">=</span> <span class="n">ymin</span> <span class="o">-</span> <span class="mf">0.01</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">All_RAW_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>


<span class="n">fig</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>


<span class="n">normalize</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">nscan</span><span class="p">)</span>
<span class="n">colormap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">jet</span>
<span class="n">i</span><span class="o">=</span><span class="mi">1</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nscan</span><span class="p">):</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dataC_BC</span><span class="o">.</span><span class="n">Wavenumber</span><span class="p">,</span> <span class="n">dataC_BC</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spl</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">i</span><span class="p">)],</span> <span class="n">color</span><span class="o">=</span><span class="n">colormap</span><span class="p">(</span><span class="n">normalize</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
    
    <span class="n">i</span><span class="o">=+</span><span class="mi">1</span>
    

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;DR2-C Baseline Corrected </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">1900</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.06</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wavenumber (cm-1)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Absorbance&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="c1">#ax = fig.gca()</span>
<span class="c1">#plt.grid()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">scalarmappaple</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">normalize</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">colormap</span><span class="p">)</span>
<span class="n">scalarmappaple</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scalarmappaple</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s1">/Samples/</span><span class="si">{}</span><span class="s1">/Plots/DR/DR2_</span><span class="si">{}</span><span class="s1">_C.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">date</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Plot the unreduced (BC) scans to see if a polynomial would be better</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">All_RAW_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>


<span class="n">fig</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>


<span class="n">normalize</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">nscan</span><span class="p">)</span>
<span class="n">colormap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">jet</span>
<span class="n">i</span><span class="o">=</span><span class="mi">1</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nscan</span><span class="p">):</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dataC_BC_U</span><span class="o">.</span><span class="n">Wavenumber</span><span class="p">,</span> <span class="n">dataC_BC_U</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spl</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">i</span><span class="p">)],</span> <span class="n">color</span><span class="o">=</span><span class="n">colormap</span><span class="p">(</span><span class="n">normalize</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
    
    <span class="n">i</span><span class="o">=+</span><span class="mi">1</span>
    

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;DR2-A Baseline Corrected </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">1900</span><span class="p">,</span><span class="mi">1030</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.06</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wavenumber (cm-1)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Absorbance&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="c1">#ax = fig.gca()</span>
<span class="c1">#plt.grid()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">scalarmappaple</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">normalize</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">colormap</span><span class="p">)</span>
<span class="n">scalarmappaple</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scalarmappaple</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s1">/Samples/</span><span class="si">{}</span><span class="s1">/Plots/DR/DR2_</span><span class="si">{}</span><span class="s1">_C_U.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">date</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id6">
<h4>2.4.B.4 Max A + Redshift<a class="headerlink" href="#id6" title="Permalink to this headline">¬∂</a></h4>
</div>
<div class="section" id="b-4-max-a-per-temperature">
<h4>2.4.B.4 Max A, per temperature<a class="headerlink" href="#b-4-max-a-per-temperature" title="Permalink to this headline">¬∂</a></h4>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="span-style-background-yellow-color-green-text-dr3-normalisation-span">
<h1><span style='background :yellow' > <span class="math notranslate nohighlight">\(\color{green}{\text{DR3 : Normalisation}}\)</span> </span><a class="headerlink" href="#span-style-background-yellow-color-green-text-dr3-normalisation-span" title="Permalink to this headline">¬∂</a></h1>
<div class="section" id="u-integration-u">
<h2>3.1 <u>Integration</u><a class="headerlink" href="#u-integration-u" title="Permalink to this headline">¬∂</a></h2>
<p>In the following we are going to integrate the spectra between two borns with the trapezoidal integration technique</p>
<div class="section" id="function-definition">
<h3>Function definition<a class="headerlink" href="#function-definition" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this function computes the inegral of the scan of index index, between borns 1 and 2 (in cm-1)</span>

<span class="k">def</span> <span class="nf">integration</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">,</span> <span class="n">born_1</span><span class="p">,</span> <span class="n">born_2</span><span class="p">):</span>

    <span class="n">nwl</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span> <span class="c1">#number of wavelenght - spectra resolution</span>

    <span class="n">list_names</span> <span class="o">=</span>  <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    
    <span class="n">scan_place</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_names</span><span class="p">)):</span>
        
        <span class="n">name_corr</span> <span class="o">=</span> <span class="n">list_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">name_corr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="n">index</span><span class="p">:</span>
    
            <span class="n">scan_place</span> <span class="o">=</span> <span class="n">i</span>
    
    <span class="n">scan</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">scan_place</span><span class="p">]</span>
        
    <span class="n">index_born_1</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">index_born_2</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">iwl</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nwl</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">wavelength</span><span class="p">[</span><span class="n">iwl</span><span class="p">]</span> <span class="o">-</span> <span class="n">born_1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
            
            <span class="n">index_born_1</span> <span class="o">=</span> <span class="n">iwl</span>
    
        <span class="k">elif</span> <span class="nb">abs</span><span class="p">(</span><span class="n">wavelength</span><span class="p">[</span><span class="n">iwl</span><span class="p">]</span> <span class="o">-</span> <span class="n">born_2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
            
            <span class="n">index_born_2</span> <span class="o">=</span> <span class="n">iwl</span>
    
    <span class="n">area</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">iint</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">index_born_1</span><span class="p">,</span> <span class="n">index_born_2</span><span class="p">):</span>
        
        <span class="n">d_area</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">scan</span><span class="p">[</span><span class="n">iint</span><span class="p">]</span><span class="o">+</span><span class="n">scan</span><span class="p">[</span><span class="n">iint</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">wavelength</span><span class="p">[</span><span class="n">iint</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">wavelength</span><span class="p">[</span><span class="n">iint</span><span class="p">])</span>
    
        <span class="n">area</span> <span class="o">=</span> <span class="n">area</span> <span class="o">+</span> <span class="n">d_area</span>
        
    <span class="k">return</span> <span class="n">area</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="a-oh-stretch">
<h3>3.1.A Oh stretch<a class="headerlink" href="#a-oh-stretch" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#range A</span>
<span class="n">wavelengthA</span> <span class="o">=</span> <span class="n">dataA_BC</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">wavelengthA</span> <span class="o">=</span> <span class="n">wavelengthA</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#wavelengthA</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#range A</span>
<span class="n">dataA_BC_I</span> <span class="o">=</span> <span class="n">dataA_BC</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
<span class="n">dataA_BC_I</span> <span class="o">=</span> <span class="n">dataA_BC_I</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataA_BC_I</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dataA_BC_I</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="n">areas</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>
<span class="n">areasBCA</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>

<span class="n">times</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>

<span class="k">for</span> <span class="n">iint</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nscan</span><span class="p">):</span>
    
    <span class="c1">#areas[iint] = integration(iint+1, data, wavelength, 2900, 3900)</span>
    <span class="n">areasBCA</span><span class="p">[</span><span class="n">iint</span><span class="p">]</span> <span class="o">=</span> <span class="n">integration</span><span class="p">(</span><span class="n">iint</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">dataA_BC_I</span><span class="p">,</span> <span class="n">wavelengthA</span><span class="p">,</span> <span class="mi">2800</span><span class="p">,</span> <span class="mi">4000</span><span class="p">)</span>
    <span class="c1">#times[iint] = 15*iint</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">areasBCA</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="b-bending-modes">
<h3>3.1.B Bending Modes<a class="headerlink" href="#b-bending-modes" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#range C (think to supress libration mode contribution!)</span>
<span class="n">wavelengthC</span> <span class="o">=</span> <span class="n">dataC_BC_U</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">wavelengthC</span> <span class="o">=</span> <span class="n">wavelengthC</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavelengthC</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#range C</span>
<span class="n">dataC_BC_I</span> <span class="o">=</span> <span class="n">dataC_BC_U</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
<span class="n">dataC_BC_I</span> <span class="o">=</span> <span class="n">dataC_BC_I</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataC_BC_I</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dataC_BC_I</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="n">areas</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>
<span class="n">areasBCC</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>

<span class="n">times</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>

<span class="k">for</span> <span class="n">iint</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nscan</span><span class="p">):</span>
    
    <span class="c1">#areas[iint] = integration(iint+1, data, wavelength, 2900, 3900)</span>
    <span class="n">areasBCC</span><span class="p">[</span><span class="n">iint</span><span class="p">]</span> <span class="o">=</span> <span class="n">integration</span><span class="p">(</span><span class="n">iint</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">dataC_BC_I</span><span class="p">,</span> <span class="n">wavelengthC</span><span class="p">,</span> <span class="mi">1040</span><span class="p">,</span> <span class="mi">1900</span><span class="p">)</span>
    <span class="c1">#times[iint] = 15*iint</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">areasBCC</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id7">
<h3>3.1.4 Clean<a class="headerlink" href="#id7" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#range A</span>

<span class="n">areasBCA_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span> <span class="s1">&#39;File number&#39;</span><span class="p">:</span> <span class="n">dataA_BC_I</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span> <span class="s1">&#39;Int_A&#39;</span><span class="p">:</span> <span class="n">areasBCA</span><span class="p">[:]})</span>
<span class="n">areasBCA_df</span> <span class="o">=</span> <span class="n">areasBCA_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>

<span class="n">areasBCA_df</span> <span class="o">=</span> <span class="n">areasBCA_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">areasBCA_df</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">areasBCA_df</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span>
<span class="n">areasBCA_df</span><span class="o">=</span> <span class="n">areasBCA_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>

<span class="c1">#range C</span>

<span class="n">areasBCC_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span> <span class="s1">&#39;File number&#39;</span><span class="p">:</span> <span class="n">dataC_BC_I</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span> <span class="s1">&#39;Int_C&#39;</span><span class="p">:</span> <span class="n">areasBCC</span><span class="p">[:]})</span>
<span class="n">areasBCC_df</span> <span class="o">=</span> <span class="n">areasBCC_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>

<span class="n">areasBCC_df</span> <span class="o">=</span> <span class="n">areasBCC_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">areasBCC_df</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">areasBCC_df</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span>
<span class="n">areasBCC_df</span><span class="o">=</span> <span class="n">areasBCC_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#areasBCA_df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#areasBCC_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="a-2-ethane-peaks-integration">
<h3>3.1.A.2 Ethane peaks integration<a class="headerlink" href="#a-2-ethane-peaks-integration" title="Permalink to this headline">¬∂</a></h3>
<p>Integration of ethane peaks:</p>
<p>create if statement spl = C2H6, C2H6_ASW ‚Ä¶</p>
<p>Integrate over specified range (?)</p>
<p>Do I need another baseline correction to make the ethane peak region flat ? To check</p>
</div>
<div class="section" id="id8">
<h3>3.1.5 Append to data Annex<a class="headerlink" href="#id8" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_anex_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data_anex_df</span><span class="p">,</span> <span class="n">areasBCA_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_anex_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data_anex_df</span><span class="p">,</span> <span class="n">areasBCC_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_anex_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plotting">
<h3>3.1.6 Plotting<a class="headerlink" href="#plotting" title="Permalink to this headline">¬∂</a></h3>
<div class="section" id="dict-values">
<h4>Dict values<a class="headerlink" href="#dict-values" title="Permalink to this headline">¬∂</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="k">for</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">Tdictionary</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">data_anex_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">values</span><span class="p">,</span><span class="mi">28</span><span class="p">],</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">values</span><span class="o">/</span><span class="n">nscan</span><span class="p">),</span><span class="n">label</span><span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; - &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">values</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; - &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data_anex_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">values</span><span class="p">,</span><span class="mi">28</span><span class="p">])))</span>    

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> DR3 Integration &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="p">))</span>
<span class="c1">#plt.axis([3210,3270])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;OH stretch Integration (AU)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="c1">#ax = fig.gca()</span>
<span class="c1">#plt.grid()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>


<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s1">/Samples/</span><span class="si">{}</span><span class="s1">/Plots/DR/DR2_</span><span class="si">{}</span><span class="s1">_PeakA-Integration.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">date</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id9">
<h4>Dict values<a class="headerlink" href="#id9" title="Permalink to this headline">¬∂</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">Iso</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>   
    
    <span class="n">fig</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">Isodic1</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">data_anex_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">values</span><span class="p">,</span><span class="mi">28</span><span class="p">],</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">values</span><span class="o">/</span><span class="n">nscan</span><span class="p">),</span><span class="n">label</span><span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; - &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">values</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; - &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data_anex_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">values</span><span class="p">,</span><span class="mi">28</span><span class="p">])))</span>    

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> DR3 Integration Iso </span><span class="si">{1}</span><span class="s1">  &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">Tiso1</span><span class="p">))</span>
    <span class="c1">#plt.axis([3210,3270])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (h)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;OH stretch Integration (AU)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>  
    <span class="c1">#plt.grid()</span>
    <span class="c1">#plt.legend()</span>


    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s1">/Samples/</span><span class="si">{}</span><span class="s1">/Plots/DR/DR2_</span><span class="si">{}</span><span class="s1">_PeakA-Integration_Iso_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">Tiso1</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="u-column-density-calculation-u">
<h2>3.2 <u>Column Density Calculation </u><a class="headerlink" href="#u-column-density-calculation-u" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="theory">
<h3>3.2.1 Theory<a class="headerlink" href="#theory" title="Permalink to this headline">¬∂</a></h3>
<p>To do</p>
<p><img alt="Thick-calc-form-3.svg'" src="Notes/Script_Copie/Thick-calc-form-3.svg" /></p>
<p>Blabla</p>
<p><img alt="Thick-calc-form-4.svg'" src="Notes/Script_Copie/Thick-calc-form-4.svg" /></p>
</div>
<div class="section" id="normalisation-factor">
<h3>3.2.2 Normalisation factor<a class="headerlink" href="#normalisation-factor" title="Permalink to this headline">¬∂</a></h3>
<p>Dep_val_A correspond to the first value found in the column Int_A or C. This corrspond to the integration for from the deposition for all the samples</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Dep_val_A</span> <span class="o">=</span> <span class="n">data_anex_df</span><span class="p">[</span><span class="s1">&#39;Int_A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">Dep_val_C</span> <span class="o">=</span> <span class="n">data_anex_df</span><span class="p">[</span><span class="s1">&#39;Int_C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Dep_val_A</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Dep_val_C</span> 
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="optical-depth-calcul">
<h3>3.3 Optical depth Calcul<a class="headerlink" href="#optical-depth-calcul" title="Permalink to this headline">¬∂</a></h3>
</div>
<div class="section" id="id10">
<h3>3.3.A Oh stretch<a class="headerlink" href="#id10" title="Permalink to this headline">¬∂</a></h3>
<p>Aa taken from ref ‚Ä¶ Hagen 1981</p>
<p>Find more recent value</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Aa</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">NA</span> <span class="o">=</span> <span class="n">Dep_val_A</span> <span class="o">/</span> <span class="n">Aa</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">NA</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="b-oh-bend">
<h3>3.3.B Oh bend<a class="headerlink" href="#b-oh-bend" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ac</span> <span class="o">=</span> <span class="mf">1.2</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">17</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">NC</span> <span class="o">=</span> <span class="n">Dep_val_C</span> <span class="o">/</span> <span class="n">Ac</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">NC</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="c-comparison-and-analysis">
<h3>3.3.C Comparison and analysis<a class="headerlink" href="#c-comparison-and-analysis" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp</span> <span class="o">=</span> <span class="n">NA</span><span class="o">/</span><span class="n">NC</span> <span class="o">*</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="e-append-to-ice-thickness-df">
<h3>3.3.E Append to Ice_thickness_df<a class="headerlink" href="#e-append-to-ice-thickness-df" title="Permalink to this headline">¬∂</a></h3>
<p>Prior to the Reduction analysis, the laser-diode thickness notebook should have been performed and a csv being producing with he inputs. We will append the previously obtained data into this csv</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ice_thickness_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;D:\DATA-Processing\PAC\Ice_thickness.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ice_thickness_df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ice_thickness_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Ice_thickness_df</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">date</span><span class="p">,</span> <span class="s1">&#39;Na&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NA</span> 
<span class="n">Ice_thickness_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Ice_thickness_df</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">date</span><span class="p">,</span> <span class="s1">&#39;Nc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NC</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ice_thickness_df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ice_thickness_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;D:\DATA-Processing\PAC\Ice_thickness.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="u-normalisation-u">
<h2>3.3 <u> Normalisation </u><a class="headerlink" href="#u-normalisation-u" title="Permalink to this headline">¬∂</a></h2>
<p>2 different normalisations</p>
<ul class="simple">
<li><p>The 20K sample can be normalised with the first scan (ie the deposition)</p></li>
<li><p>The sample deposited at the higher T needs to be with normalised with respect to the Integration from the normalized scan (3.3?)</p></li>
</ul>
<div class="section" id="k-depositions">
<h3>20K depositions<a class="headerlink" href="#k-depositions" title="Permalink to this headline">¬∂</a></h3>
<p>For 20K deposition no problem, we take the Integration value of the deposition and normalised through it</p>
<p>Insert if statement: if TRamp[:3] not Nan continue otherwise don`t perform normalisation</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Dep_val_A</span>
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(\color{red}{\text{Here we need to have a if statement that say that if the sample is deposited at 20K - norm factor = 100 / Dep_val_A, else, another notebook is run to get the Norm factor at the temperature of interest!}}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">Tdep</span> <span class="o">==</span> <span class="s2">&quot;20&quot;</span><span class="p">:</span>

    
    <span class="n">NormFactor</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">/</span> <span class="n">Dep_val_A</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">NormFactor</span><span class="p">)</span>
    
<span class="k">else</span><span class="p">:</span>

    <span class="o">%</span><span class="k">run</span> -i &quot;HighTreduction.py&quot;
    <span class="nb">print</span><span class="p">(</span><span class="n">mean_X</span><span class="p">)</span>
    <span class="n">NormFactor</span> <span class="o">=</span> <span class="n">mean_X</span> <span class="o">/</span> <span class="n">Dep_val_A</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">NormFactor</span>
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(\color{red}{\text{Append Norm factor into sample thick csv}}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataA_N</span> <span class="o">=</span> <span class="n">dataA_BC_I</span> <span class="o">*</span> <span class="n">NormFactor</span>
</pre></div>
</div>
</div>
</div>
<p>Saanity Check:</p>
<ul class="simple">
<li><p>Insert wavenumber (before export)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataA_N</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
          <span class="n">column</span> <span class="o">=</span> <span class="s1">&#39;Wavenumber&#39;</span><span class="p">,</span>
          <span class="n">value</span> <span class="o">=</span>  <span class="n">wavelengthA</span><span class="p">)</span>

<span class="n">dataA_N</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="id11">
<h2>Export as csv<a class="headerlink" href="#id11" title="Permalink to this headline">¬∂</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataA_N</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s2">/Samples/</span><span class="si">{}</span><span class="s2">/Data/DR/DR3_</span><span class="si">{}</span><span class="s2">_A.csv&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">date</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="u-integration-ii-u">
<h2>3.4 <u>Integration II</u><a class="headerlink" href="#u-integration-ii-u" title="Permalink to this headline">¬∂</a></h2>
<p>Purpose here is to integrate the normalised scan so we can have integration value for scans at higher temperature to use as normalisation value for scans deposited at higherrt temperature</p>
<p>Supress wavenumber</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataA_N</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataA_N</span> <span class="o">=</span> <span class="n">dataA_N</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataA_N</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nscan</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dataA_N</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="n">areas</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>
<span class="n">areasBCA2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>

<span class="n">times</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nscan</span><span class="p">)</span>

<span class="k">for</span> <span class="n">iint</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nscan</span><span class="p">):</span>
    
    <span class="c1">#areas[iint] = integration(iint+1, data, wavelength, 2900, 3900)</span>
    <span class="n">areasBCA2</span><span class="p">[</span><span class="n">iint</span><span class="p">]</span> <span class="o">=</span> <span class="n">integration</span><span class="p">(</span><span class="n">iint</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">dataA_N</span><span class="p">,</span> <span class="n">wavelengthA</span><span class="p">,</span> <span class="mi">2800</span><span class="p">,</span> <span class="mi">4000</span><span class="p">)</span>
    <span class="c1">#times[iint] = 15*iint</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">areasBCA2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">areasBCA2_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span> <span class="s1">&#39;File number&#39;</span><span class="p">:</span> <span class="n">dataA_BC_I</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span> <span class="s1">&#39;Int_N_A&#39;</span><span class="p">:</span> <span class="n">areasBCA2</span><span class="p">[:]})</span>
<span class="n">areasBCA2_df</span> <span class="o">=</span> <span class="n">areasBCA2_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
<span class="n">areasBCA2_df</span> <span class="o">=</span> <span class="n">areasBCA2_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">areasBCA2_df</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">areasBCA2_df</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span>
<span class="n">areasBCA2_df</span><span class="o">=</span> <span class="n">areasBCA2_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#areasBCA2_df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_anex_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data_anex_df</span><span class="p">,</span> <span class="n">areasBCA2_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="high-temperature-deposition">
<h3>High Temperature deposition<a class="headerlink" href="#high-temperature-deposition" title="Permalink to this headline">¬∂</a></h3>
<p>For the higher temperature deposited, normalising through the deposition would not allowed a good comparison with the sample deposited at 20K. Hence, we will make an average of the normalised value (from Integration II) at the temperature of interest and use this value as a normalisation factor.<br></p>
<p>We will use a separate notebook to to that that will run separately if need be</p>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="span-style-background-yellow-color-green-text-dr4-cleaning-and-error-analysis-span">
<h1><span style='background :yellow' > <span class="math notranslate nohighlight">\(\color{green}{\text{DR4 : Cleaning and error analysis}}\)</span> </span><a class="headerlink" href="#span-style-background-yellow-color-green-text-dr4-cleaning-and-error-analysis-span" title="Permalink to this headline">¬∂</a></h1>
<div class="section" id="export-data-anex-as-csv">
<h2>4.1 Export data_Anex as csv<a class="headerlink" href="#export-data-anex-as-csv" title="Permalink to this headline">¬∂</a></h2>
</div>
<div class="section" id="insert-time-column">
<h2>Insert time column<a class="headerlink" href="#insert-time-column" title="Permalink to this headline">¬∂</a></h2>
<table><tr>
<td>
<p>Id | Input | Why</p>
<ul class="simple">
<li><p>| - | -
0 | id | N/A
1 | Name | N/A
2 | min1 | N/A
3 | index1 | N/A
4 | min2 | N/A
5 | index2 | N/A
6 | min3 | N/A
7 | index3 | N/A
6 | min4 | N/A
7 | index4 | N/A</p></li>
</ul>
</td>
<td>
<p align="center" style="padding: 10px">
Even if all sample don`t require a time stamp, for future concatenation it is import that all the data has same shape
For loop iterate through scan number if scan number = input manually time in column, else = ''
Insert manually for now   
</p> 
</td>
</tr></table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#data_anex_df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_anex_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s2">/Samples/</span><span class="si">{}</span><span class="s2">/Data/DR/</span><span class="si">{}</span><span class="s2">_data_annex.csv&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">date</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="sample-specific-reduction">
<h1>5. Sample specific reduction<a class="headerlink" href="#sample-specific-reduction" title="Permalink to this headline">¬∂</a></h1>
<p>Link toward peculiar cases</p>
<ul class="simple">
<li><p>02_09</p></li>
</ul>
<div class="section" id="id12">
<h2>02_09<a class="headerlink" href="#id12" title="Permalink to this headline">¬∂</a></h2>
</div>
<div class="section" id="export-result-in-web-page">
<h2>4.2 Export result in web-page<a class="headerlink" href="#export-result-in-web-page" title="Permalink to this headline">¬∂</a></h2>
<p>All the output are inserted onto a blank ? web page</p>
<div class="section" id="common-feature">
<h3>Common feature<a class="headerlink" href="#common-feature" title="Permalink to this headline">¬∂</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s2">/Samples/</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">_DP.html&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">date</span><span class="p">),</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>



<span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;&lt;html&gt;</span>
<span class="s2">&lt;head&gt;&lt;/head&gt;</span>
<span class="s2">&lt;body&gt;</span>

<span class="s2">&lt;h1&gt;Data Reduction results&lt;/h1&gt;</span>

<span class="s2">&lt;p&gt;Reduction performed:&quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date_jour</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;&lt;/p&gt;</span>

<span class="s2">&lt;h2&gt;Full scan unreduced&lt;/h2&gt;</span>

<span class="s2">&lt;figure&gt;</span>
<span class="s2">&lt;a href=&quot;Plots\DR\DR1_&quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;_Full-range.png&quot; target=&quot;_blank&quot;&gt;&lt;image src=&quot;Plots\DR\DR1_&quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;_Full-range.png&quot; width=&quot;&quot;  Id=&quot;&quot;  alt=&quot;&quot;/&gt;&lt;/a&gt;      </span>
<span class="s2">&lt;figcaption&gt;&lt;/figcaption&gt;</span>
<span class="s2">&lt;/figure&gt;</span>

<span class="s2">&lt;p&gt;Output&lt;/p&gt;</span>

<span class="s2">&lt;h2&gt;Baseline corrected scan A&lt;/h2&gt;</span>

<span class="s2">&lt;figure&gt;</span>
<span class="s2">&lt;a href=&quot;Plots\DR\DR2_&quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;_A.png&quot; target=&quot;_blank&quot;&gt;&lt;image src=&quot;Plots\DR\DR2_&quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;_A.png&quot; width=&quot;&quot;  Id=&quot;&quot;  alt=&quot;&quot;/&gt;&lt;/a&gt;      </span>
<span class="s2">&lt;figcaption&gt;&lt;/figcaption&gt;</span>
<span class="s2">&lt;/figure&gt;</span>

<span class="s2">&lt;p&gt;Output&lt;/p&gt;</span>

<span class="s2">&lt;h2&gt;Baseline corrected scan B&lt;/h2&gt;</span>

<span class="s2">&lt;figure&gt;</span>
<span class="s2">&lt;a href=&quot;Plots\DR\DR2_&quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;_B.png&quot; target=&quot;_blank&quot;&gt;&lt;image src=&quot;Plots\DR\DR2_&quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;_B.png&quot; width=&quot;&quot;  Id=&quot;&quot;  alt=&quot;&quot;/&gt;&lt;/a&gt;      </span>
<span class="s2">&lt;figcaption&gt;&lt;/figcaption&gt;</span>
<span class="s2">&lt;/figure&gt;</span>

<span class="s2">&lt;p&gt;Output&lt;/p&gt;</span>


<span class="s2">&lt;h2&gt;Baseline corrected scan C&lt;/h2&gt;</span>

<span class="s2">&lt;figure&gt;</span>
<span class="s2">&lt;a href=&quot;Plots\DR\DR2_&quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;_C.png&quot; target=&quot;_blank&quot;&gt;&lt;image src=&quot;Plots\DR\DR2_&quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;_C.png&quot; width=&quot;&quot;  Id=&quot;&quot;  alt=&quot;&quot;/&gt;&lt;/a&gt;      </span>
<span class="s2">&lt;figcaption&gt;&lt;/figcaption&gt;</span>
<span class="s2">&lt;/figure&gt;</span>

<span class="s2">&lt;p&gt;Output&lt;/p&gt;</span>


<span class="s2">&lt;h2&gt;Range A frequency shift&lt;/h2&gt;</span>

<span class="s2">&lt;figure&gt;</span>
<span class="s2">&lt;a href=&quot;Plots\DR\DR2_&quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;_PeakA-frequency_wA0.png&quot; target=&quot;_blank&quot;&gt;&lt;image src=&quot;Plots\DR\DR2_&quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;_PeakA-frequency_wA0.png&quot; width=&quot;&quot;  Id=&quot;&quot;  alt=&quot;&quot;/&gt;&lt;/a&gt;      </span>
<span class="s2">&lt;figcaption&gt;&lt;/figcaption&gt;</span>
<span class="s2">&lt;/figure&gt;</span>

<span class="s2">&lt;p&gt;Output&lt;/p&gt;</span>

<span class="s2">&lt;h2&gt;Range A Integration&lt;/h2&gt;</span>

<span class="s2">&lt;figure&gt;</span>
<span class="s2">&lt;a href=&quot;Plots\DR\DR2_&quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;_PeakA-Integration.png&quot; target=&quot;_blank&quot;&gt;&lt;image src=&quot;Plots\DR\DR2_&quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;_PeakA-Integration.png&quot; width=&quot;&quot;  Id=&quot;&quot;  alt=&quot;&quot;/&gt;&lt;/a&gt;      </span>
<span class="s2">&lt;figcaption&gt;&lt;/figcaption&gt;</span>
<span class="s2">&lt;/figure&gt;</span>

<span class="s2">&lt;p&gt;Output&lt;/p&gt;</span>

<span class="s2">&lt;h2&gt;Range B frequency shift&lt;/h2&gt;</span>

<span class="s2">&lt;figure&gt;</span>
<span class="s2">&lt;a href=&quot;Plots\DR\DR2_&quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;_PeakB-frequency.png&quot; target=&quot;_blank&quot;&gt;&lt;image src=&quot;Plots\DR\DR2_&quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;_PeakB-frequency.png&quot; width=&quot;&quot;  Id=&quot;&quot;  alt=&quot;&quot;/&gt;&lt;/a&gt;      </span>
<span class="s2">&lt;figcaption&gt;&lt;/figcaption&gt;</span>
<span class="s2">&lt;/figure&gt;</span>

<span class="s2">&lt;p&gt;Output&lt;/p&gt;</span>



<span class="s2">&lt;/body&gt;</span>
<span class="s2">&lt;/html&gt;&quot;&quot;&quot;</span>




<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="specific-feature">
<h3>Specific feature<a class="headerlink" href="#specific-feature" title="Permalink to this headline">¬∂</a></h3>
<div class="section" id="isotherms">
<h4>Isotherms<a class="headerlink" href="#isotherms" title="Permalink to this headline">¬∂</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">Iso</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>   
    
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;D:\DATA-Processing\PAC\</span><span class="si">{}</span><span class="s2">/Samples/</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">_DP.html&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">XP</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">date</span><span class="p">),</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>



    <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;&lt;html&gt;</span>
<span class="s2">    &lt;head&gt;&lt;/head&gt;</span>
<span class="s2">    &lt;body&gt;</span>

<span class="s2">    &lt;h1&gt;Isotherms&lt;/h1&gt;</span>

<span class="s2">    &lt;h2&gt; &quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Tiso1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot; &lt;/h2&gt;</span>
<span class="s2">    </span>
<span class="s2">    &lt;article id=&quot;P1&quot;&gt;</span>
<span class="s2">    </span>
<span class="s2">    &lt;div&gt;</span>
<span class="s2">    </span>
<span class="s2">    &lt;h3&gt;Peak frequency shift &lt;/h3&gt;</span>

<span class="s2">    &lt;figure&gt;</span>
<span class="s2">    &lt;a href=&quot;Plots/DR/DR2_&quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;_PeakA-frequency_Iso_&quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Tiso1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;.png&quot; target=&quot;_blank&quot;&gt;&lt;image src=&quot;Plots/DR/DR2_&quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;_PeakA-frequency_Iso_&quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Tiso1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;.png&quot; width=&quot;&quot;  Id=&quot;&quot;  alt=&quot;&quot;/&gt;&lt;/a&gt;      </span>
<span class="s2">    &lt;figcaption&gt;&lt;/figcaption&gt;</span>
<span class="s2">    &lt;/figure&gt;</span>

<span class="s2">    &lt;p&gt;Output&lt;/p&gt;</span>

<span class="s2">    &lt;/div&gt;</span>
<span class="s2">    </span>
<span class="s2">    &lt;div&gt;</span>
<span class="s2">    </span>
<span class="s2">    &lt;h3&gt;Integration &lt;/h3&gt;</span>

<span class="s2">    &lt;figure&gt;</span>
<span class="s2">    &lt;a href=&quot;Plots/DR/DR2_&quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;_PeakA-Integration_Iso_&quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Tiso1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;.png&quot; target=&quot;_blank&quot;&gt;&lt;image src=&quot;Plots/DR/DR2_&quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;_PeakA-Integration_Iso_&quot;&quot;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Tiso1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;.png&quot; width=&quot;&quot;  Id=&quot;&quot;  alt=&quot;&quot;/&gt;&lt;/a&gt;      </span>
<span class="s2">    &lt;figcaption&gt;&lt;/figcaption&gt;</span>
<span class="s2">    &lt;/figure&gt;</span>

<span class="s2">    &lt;p&gt;Output&lt;/p&gt;</span>

<span class="s2">    &lt;/div&gt;</span>



<span class="s2">    &lt;/article&gt;</span>




<span class="s2">    &lt;/body&gt;</span>
<span class="s2">    &lt;/html&gt;&quot;&quot;&quot;</span>




    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Notes\Script_Copie"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Vincent Deguin<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>